<!DOCTYPE HTML>
<html lang="zh-CN">
    <!-- shw2018 洪卫  modify 2019.08.15-->



<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Spring Boot, Spring Cloud, 微服务, Java技术, 好好学java, Java面试, 分布式, 最新干货分享">
    <meta name="baidu-site-verification" content="fmlEuI34ir" />
    <meta name="google-site-verification" content="ZWVq5UvPg33BCEA3LRTUkYe5J854o9lF1_WRTer9l8A" />
    <meta name="description" content="本站是 好好学java 的技术分享博客。内容涵盖Java后端技术、Spring Boot、Spring Cloud、微服务架构、分布式、Java面试、测试开发等相关的研究与知识分享。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>基于SpringBoot搭建应用开发框架教程 | 好好学java | Spring Boot | Spring Cloud | 微服务 | Java技术 | Java面试 | 分布式 | 最新干货分享</title>
    <link rel="icon" type="image/png" href="http://image.ouyangsihai.cn/FjihsEiBMONnJIRtPwgGkjE4HAP7">

    <!-- <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"> -->
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <!-- 自定义fontawesome样式：欧阳思海 -->
    <link rel="stylesheet" type="text/css" href="/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/css/brands.min.css">
    <link rel="stylesheet" type="text/css" href="/css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="/css/regular.min.css">
    <link rel="stylesheet" type="text/css" href="/css/solid.min.css">


    <style type="text/css">
        code[class*="language-"],
            pre[class*="language-"] {
                white-space: pre !important;
            }

            

        /* 将matery.css中的背景颜色修改放到这里：欧阳思海 */
        .bg-color {
            background-image: linear-gradient(to right, #ec8585 0%, #419488 100%);
            opacity: 0.9;
            // 透明度
        }
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>

    
    
    <script>
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>
    

    <script>
        var _hmt = _hmt || [];
        (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?6fe466069710c03a563713b507fbaca7";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
        })();
    </script>


    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-XXXXX-Y', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->

    <script>(function (i, s, o, g, r, a, m) { i["DaoVoiceObject"] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; a.charset = "utf-8"; m.parentNode.insertBefore(a, m) })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0a804bac.js", "daovoice")</script>

    <script>
        if (true) {
            daovoice('init', {
                app_id: "0a804bac",
                user_id: "NO_89757", // 必填: 该用户在您系统上的唯一ID
                email: "daovoice@example.com", // 选填:  该用户在您系统上的主邮箱
                name: "道客船长", // 选填: 用户名
                signed_up: 1449821660 // 选填: 用户的注册时间，用Unix时间戳表示
            });
            daovoice('update');

            daovoice('init', {
                app_id: "0a804bac"
            });
            daovoice('update');
        }
    </script>
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/rss2.xml" title="好好学java" type="application/rss+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

    <body>

        <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="http://image.ouyangsihai.cn/FjihsEiBMONnJIRtPwgGkjE4HAP7" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span" style="font-size: 1.4rem;">好好学java</span>
                </a>
            </div>
            


<!-- <a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="" class="waves-effect waves-light">
            
            <i class="fa "></i>
            
            <span></span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title=""></i>
        </a>
    </li>
</ul> -->

<!-- 支持二级菜单特性 洪卫 shw2018 modify 2019.09.17  -->
<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-align-justify"></i></a>
<ul class="right nav-menu">
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories/" class="waves-effect waves-light">
                
                  <i style="font-size: 1.1rem;" class="fa fa-folder-minus"></i>
                
                <span style="font-size: 1.1rem;">Java学习</span>
                <i style="font-size: 1.1rem;" class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/categories/Java%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86/" >
                    
                    <span>Java入门</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/Javaweb/" >
                    
                    <span>Java Web</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/spring%E6%95%99%E7%A8%8B/" >
                    
                    <span>Spring教程</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/springboot%E6%95%99%E7%A8%8B/" >
                    
                    <span>SpringBoot教程</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/springcloud%E6%95%99%E7%A8%8B/" >
                    
                    <span>SpringCloud教程</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/Java%E9%9D%A2%E8%AF%95%E9%A2%98/" >
                    
                    <span>Java面试</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E5%89%91%E6%8C%87offer/" >
                    
                    <span>剑指offer</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories/" class="waves-effect waves-light">
                
                  <i style="font-size: 1.1rem;" class="fa fa-code-branch"></i>
                
                <span style="font-size: 1.1rem;">Java进阶</span>
                <i style="font-size: 1.1rem;" class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97/" >
                    
                    <span>设计模式</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" >
                    
                    <span>Java并发编程</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3/" >
                    
                    <span>数据库</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/redis/" >
                    
                    <span>Redis</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/linux/" >
                    
                    <span>Linux</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/" >
                    
                    <span>Java实战项目</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories/" class="waves-effect waves-light">
                
                  <i style="font-size: 1.1rem;" class="fa fa-code"></i>
                
                <span style="font-size: 1.1rem;">python学习</span>
                <i style="font-size: 1.1rem;" class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/categories/python%E5%9F%BA%E7%A1%80/" >
                    
                    <span>python基础</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/python%E6%A1%86%E6%9E%B6/" >
                    
                    <span>python框架</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/python%E5%85%B6%E4%BB%96/" >
                    
                    <span>python其他</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories/" class="waves-effect waves-light">
                
                  <i style="font-size: 1.1rem;" class="fa fa-coffee"></i>
                
                <span style="font-size: 1.1rem;">Java扩展</span>
                <i style="font-size: 1.1rem;" class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/categories/dubbo/" >
                    
                    <span>dubbo</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/netty/" >
                    
                    <span>netty</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/rpc/" >
                    
                    <span>rpc</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/eureka/" >
                    
                    <span>eureka</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/" >
                    
                    <span>中间件</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" >
                    
                    <span>分布式</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories/" class="waves-effect waves-light">
                
                  <i style="font-size: 1.1rem;" class="fa fa-desktop"></i>
                
                <span style="font-size: 1.1rem;">计算机核心</span>
                <i style="font-size: 1.1rem;" class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" >
                    
                    <span>数据结构</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/leetcode%E5%88%B7%E9%A2%98/" >
                    
                    <span>leetcode刷题</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" >
                    
                    <span>计算机网络</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/categories/%E7%AE%97%E6%B3%95/" >
                    
                    <span>算法</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/categories/" class="waves-effect waves-light">
              
                <i style="font-size: 1.1rem;" class="fa fa-adjust"></i>
              
              <span style="font-size: 1.1rem;">学习资源</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/contact" class="waves-effect waves-light">
              
                <i style="font-size: 1.1rem;" class="fa fa-envelope"></i>
              
              <span style="font-size: 1.1rem;">留言</span>
            </a>

            
      </li>
    

    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="http://image.ouyangsihai.cn/FjihsEiBMONnJIRtPwgGkjE4HAP7" class="logo-img circle responsive-img">
        
        <div class="logo-name">好好学java</div>
        <div class="logo-desc">
            
            
            本站是 好好学java 的技术分享博客，涵盖Java后端技术、SpringBoot、微服务架构、分布式、Java面试等知 ...
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa fa-fw fa-folder-minus"></i>
			
			Java学习
			<span class="m-icon"><i class="fa fa-chevron-right"></i></span>
		</a>
            <ul  >
              
                <li>   
				
                  <a href="/categories/Java%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86/ " style="margin-left:75px";>
				  
		          <span>Java入门</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Javaweb/ " style="margin-left:75px";>
				  
		          <span>Java Web</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/spring%E6%95%99%E7%A8%8B/ " style="margin-left:75px";>
				  
		          <span>Spring教程</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/springboot%E6%95%99%E7%A8%8B/ " style="margin-left:75px";>
				  
		          <span>SpringBoot教程</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/springcloud%E6%95%99%E7%A8%8B/ " style="margin-left:75px";>
				  
		          <span>SpringCloud教程</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Java%E9%9D%A2%E8%AF%95%E9%A2%98/ " style="margin-left:75px";>
				  
		          <span>Java面试</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E5%89%91%E6%8C%87offer/ " style="margin-left:75px";>
				  
		          <span>剑指offer</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa fa-fw fa-code-branch"></i>
			
			Java进阶
			<span class="m-icon"><i class="fa fa-chevron-right"></i></span>
		</a>
            <ul  >
              
                <li>   
				
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97/ " style="margin-left:75px";>
				  
		          <span>设计模式</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/ " style="margin-left:75px";>
				  
		          <span>Java并发编程</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3/ " style="margin-left:75px";>
				  
		          <span>数据库</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/redis/ " style="margin-left:75px";>
				  
		          <span>Redis</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/linux/ " style="margin-left:75px";>
				  
		          <span>Linux</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/ " style="margin-left:75px";>
				  
		          <span>Java实战项目</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa fa-fw fa-code"></i>
			
			python学习
			<span class="m-icon"><i class="fa fa-chevron-right"></i></span>
		</a>
            <ul  >
              
                <li>   
				
                  <a href="/categories/python%E5%9F%BA%E7%A1%80/ " style="margin-left:75px";>
				  
		          <span>python基础</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/python%E6%A1%86%E6%9E%B6/ " style="margin-left:75px";>
				  
		          <span>python框架</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/python%E5%85%B6%E4%BB%96/ " style="margin-left:75px";>
				  
		          <span>python其他</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa fa-fw fa-coffee"></i>
			
			Java扩展
			<span class="m-icon"><i class="fa fa-chevron-right"></i></span>
		</a>
            <ul  >
              
                <li>   
				
                  <a href="/categories/dubbo/ " style="margin-left:75px";>
				  
		          <span>dubbo</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/netty/ " style="margin-left:75px";>
				  
		          <span>netty</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/rpc/ " style="margin-left:75px";>
				  
		          <span>rpc</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/eureka/ " style="margin-left:75px";>
				  
		          <span>eureka</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/ " style="margin-left:75px";>
				  
		          <span>中间件</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/ " style="margin-left:75px";>
				  
		          <span>分布式</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa fa-fw fa-desktop"></i>
			
			计算机核心
			<span class="m-icon"><i class="fa fa-chevron-right"></i></span>
		</a>
            <ul  >
              
                <li>   
				
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/ " style="margin-left:75px";>
				  
		          <span>数据结构</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/leetcode%E5%88%B7%E9%A2%98/ " style="margin-left:75px";>
				  
		          <span>leetcode刷题</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/ " style="margin-left:75px";>
				  
		          <span>计算机网络</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E7%AE%97%E6%B3%95/ " style="margin-left:75px";>
				  
		          <span>算法</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories/" class="waves-effect waves-light">
			
			    <i class="fa fa-fw fa-adjust"></i>
			
			学习资源
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa fa-fw fa-envelope"></i>
			
			留言
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

        



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        基于SpringBoot搭建应用开发框架教程
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }

    /* 自定义mycard：欧阳思海 */

    #my-card {
        /* position: relative; */
        width: 310px;
        height: 300px;
        /* max-height: 330px; */
        margin-bottom: 15px;
        margin-top: 15px;
        /* text-align: center; */
        border: 0;
        border-radius: 3px;
        color: rgba(0, 0, 0, .87);
        background: #fff 50%;
        background-image: none;
        background-size: auto;
        background-size: cover;
        box-shadow: 0 15px 35px rgba(50, 50, 93, .1), 0 5px 15px rgba(0, 0, 0, .07);
    }

    /* .widget {
        line-height: 1.6em;
        word-wrap: break-word;
        font-size: 0.9em;
        padding-top: 15px;
        padding-left: -45px;
    } */
</style>




<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- shw2018 洪卫  modify 2019.08.15-->

<!-- 代码块修改的代码开始 -->
<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFunction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

<!-- 代码块修改代码结束 -->


<!-- 文章内容详情 -->
<div id="container">
    <div id="artDetail">
        <div class="card">
            <div class="card-content article-info">
                <div class="row tag-cate">
                    <div class="col s7">
                        
                        <div class="article-tag">
                            <!--我修改的地方：欧阳思海-->
                            
                            <a href="/tags/springboot-springboot%E6%95%99%E7%A8%8B-springboot%E6%BA%90%E7%A0%81/" target="_blank">
                                <span class="chip bg-color">springboot,springboot教程,springboot源码</span>
                            </a>
                            
                        </div>
                        
                    </div>
                    <div class="col s5 right-align">
                        
                        <div class="post-cate">
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/springboot%E6%95%99%E7%A8%8B/" class="post-category" target="_blank">
                                springboot教程
                            </a>
                            
                        </div>
                        
                    </div>
                </div>

                <div class="post-info">
                    <div class="post-date info-break-policy">
                        <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                        2021-04-05
                    </div>

                    <div class="post-author info-break-policy">
                        <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                        
                        欧阳思海
                        
                    </div>

                    
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        27.1k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        132 分
                    </div>
                    
                    

                    
                    <span id="busuanzi_container_site_pv" style='display:none'></span>
                    <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv"></span>

                    

                </div>
            </div>
            <hr class="clearfix">
            <div class="card-content article-card-content">
                <!-- 欧阳思海，modify，2020.05.01-->
<!-- 文章详情详情页面的头部广告位置信息 -->
<div id="post-head-panel">
    
    <a href="https://github.com/OUYANGSIHAI/JavaInterview" style="font-size: 18px;" target="_blank">
        <img src="/icons/hot.gif">
        本人花费半年的时间总结的《Java面试指南》已拿腾讯等大厂offer，已开源在github ，欢迎star！
    </a>
    
    
</div>
<br />



<blockquote>
    
            <p>本文GitHub <a href="https://github.com/OUYANGSIHAI/JavaInterview" target="_blank">https://github.com/OUYANGSIHAI/JavaInterview</a> 已收录，这是我花了6个月总结的<b>一线大厂Java面试</b>总结，本人已拿大厂offer，欢迎star</p>
    
    <p>原文链接：blog.ouyangsihai.cn &gt;&gt; <a href="/ji-yu-springboot-da-jian-ying-yong-kai-fa-kuang-jia-jiao-cheng.html" target="_blank">基于SpringBoot搭建应用开发框架教程</a></p>
</blockquote>
                <div id="articleContent">
                    <h2 id="Spring的简史"><a href="#Spring的简史" class="headerlink" title="Spring的简史"></a>Spring的简史</h2><p>第一阶段：XML配置，在Spring1.x时代，使用Spring开发满眼都是xml配置的Bean，随着项目的扩大，我们需要把xml配置文件分放到不同的配置文件里，那时候需要频繁的在开发的类和配置文件之间切换。</p>
<p>第二阶段：注解配置，在Spring2.x时代，Spring提供声明Bean的注解，大大减少了配置量。应用的基本配置用xml，业务配置用注解。</p>
<p>第三阶段：Java配置，从Spring3.x到现在，Spring提供了Java配置，使用Java配置可以让你更理解你所配置的Bean。</p>
<p>Spring Boot：使用“习惯优于配置”的理念让你的项目快速运行起来。使用Spring Boot很容易创建一个独立运行、准生产级别的基于Spring框架的项目，使用Spring Boot你可以不用或者只需要很少的Spring配置。</p>
<p>下面就来使用Spring Boot一步步搭建一个前后端分离的应用开发框架，并且以后不断的去完善这个框架，往里面添加功能。后面以实战为主，不会介绍太多概念，取而代之的是详细的操作。</p>
<h2 id="零、开发技术简介"><a href="#零、开发技术简介" class="headerlink" title="零、开发技术简介"></a>零、开发技术简介</h2><p>开发平台：windows</p>
<p>开发工具：Intellij IDEA 2017.1</p>
<p>JDK：Java 8</p>
<p>Maven：maven-3.3.9</p>
<p>服务器：tomcat 8.0</p>
<p>数据库：MySQL 5.7</p>
<p>数据源：Druid1.1.6</p>
<p>缓存：Redis 3.2</p>
<p>日志框架：SLF4J+Logback</p>
<p>Spring Boot：1.5.9.RELEASE</p>
<p>ORM框架：MyBatis+通用Mapper</p>
<p>Spring Boot官方文档：</p>
<h2 id="一、创建项目"><a href="#一、创建项目" class="headerlink" title="一、创建项目"></a>一、创建项目</h2><p>这一节创建项目的基础结构，按照spring boot的思想，将各个不同的功能按照starter的形式拆分开来，做到灵活组合，并简单介绍下Spring Boot相关的东西。</p>
<h3 id="1、创建工程"><a href="#1、创建工程" class="headerlink" title="1、创建工程"></a>1、创建工程</h3><p>① 通过File  New  Project，新建工程，选择Spring Initializr，然后Next。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934481.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="867" height="586">

<p>② 尽量为自己的框架想个好点的名字，可以去申请个自己的域名。我这里项目名称为Sunny，项目路径为com.lyyzoo.sunny。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934483.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="876" height="590">

<p>③ 这里先什么都不选，后面再去集成。注意我的Spring Boot版本为1.5.9。Next</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934485.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="865" height="584">

<p>④ 定义好工程的目录，用一个专用目录吧，不要在一个目录下和其它东西杂在一起。之后点击Finish。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/3-1532934487.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>上面说的这么详细，只有一个目的，从一个开始就做好规范。</p>
<p>⑤ 生成的项目结构如下，可以自己去看下pom.xml里的内容。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934487.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="2、创建Starter"><a href="#2、创建Starter" class="headerlink" title="2、创建Starter"></a>2、创建Starter</h3><p>先创建一个core核心、cache缓存、security授权认证，其它的后面再集成进去。</p>
<p>跟上面一样的方式，在Sunny下创建sunny-starter-core、sunny-starter-cache、sunny-starter-security子模块。</p>
<p>这样分模块后，我们以后需要哪个模块就引入哪个模块即可，如果哪个模块不满足需求，还可以重写该模块。</p>
<p>最终的项目结构如下：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/1-1532934487.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="3、启动项目"><a href="#3、启动项目" class="headerlink" title="3、启动项目"></a>3、启动项目</h3><p>首先在core模块下来启动并了解SpringBoot项目。</p>
<p>① 在com.lyyzoo.core根目录下，有一个SunnyStarterCoreApplication，这是SpringBoot的入口类，通常是*Application的命名。</p>
<p>入口类里有一个main方法，其实就是一个标准的Java应用的入口方法。在main方法中使用SpringApplication.run启动Spring Boot项目。</p>
<p>然后看看@SpringBootApplication注解，@SpringBootApplication是Spring Boot的核心注解，是一个组合注解。</p>
<p>@EnableAutoConfiguration让Spring Boot根据类路径中的jar包依赖为当前项目进行自动配置。</p>
<p>Spring Boot会自动扫描@SpringBootApplication所在类的同级包以及下级包里的Bean。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/9-1532934488.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934490.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>② 先启动项目，这里可以看到有一个Spring Boot的启动程序，点击右边的按钮启动项目。看到控制台Spring的标志，就算是启动成功了。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934491.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/9-1532934492.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>③ 替换默认的banner</p>
<p>可以到<a target="_blank" rel="noopener" href="http://patorjk.com/software/taag/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E9%A1%B9%E7%9B%AE%E7%9A%84banner%E3%80%82%E5%88%9B%E5%BB%BAbanner.txt%E5%B9%B6%E6%94%BE%E5%88%B0resources%E6%A0%B9%E7%9B%AE%E5%BD%95%E4%B8%8B%E3%80%82">http://patorjk.com/software/taag/这个网站生成一个自己项目的banner。创建banner.txt并放到resources根目录下。</a></p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/3-1532934492.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="4、Spring-Boot-配置"><a href="#4、Spring-Boot-配置" class="headerlink" title="4、Spring Boot 配置"></a>4、Spring Boot 配置</h3><p>① 配置文件</p>
<p>Spring Boot使用一个全局的配置文件application.properties或application.yaml，放置在src&#x2F;main&#x2F;resources目录下。我们可以在这个全局配置文件中对一些默认的配置值进行修改。</p>
<p>具体有哪些配置可到官网查找，有非常多的配置，不过大部分使用默认即可。</p>
<p>然后，需要为不同的环境配置不同的配置文件，全局使用application-{profile}.properties指定不同环境配置文件。</p>
<p>我这里增加了开发环境(dev)和生产环境(prod)的配置文件，并通过在application.properties中设置spring.profiles.active&#x3D;dev来指定当前环境。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934493.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>② starter pom</p>
<p>Spring Boot为我们提供了简化开发绝大多数场景的starter pom，只要使用了应用场景所需的starter pom，无需繁杂的配置，就可以得到Spring Boot为我们提供的自动配置的Bean。</p>
<p>后面我们将会通过加入这些starter来一步步集成我们想要的功能。具体有哪些starter，可以到官网查看：</p>
<p>③ 自动配置</p>
<p>Spring Boot关于自动配置的源码在spring-boot-autoconfigure中如下：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934493.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>我们可以在application.properties中加入debug&#x3D;true，查看当前项目中已启用和未启用的自动配置。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934494.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>我们在application.properties中的配置其实就是覆盖spring-boot-autoconfigure里的默认配置，比如web相关配置在web包下。</p>
<p>常见的如HttpEncodingProperties配置http编码，里面自动配置的编码为UTF-8。</p>
<p>MultipartProperties，上传文件的属性，设置了上传最大文件1M。</p>
<p>ServerProperties，配置内嵌Servlet容器，配置端口、contextPath等等。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934494.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>之前说@SpringBootApplication是Spring Boot的核心注解，但他的核心功能是由@EnableAutoConfiguration注解提供的。</p>
<p>@EnableAutoConfiguration注解通过@Import导入配置功能，在AutoConfigurationImportSelector中，通过SpringFactoriesLoader.loadFactoryNames扫描META-INF&#x2F;spring.factories文件。</p>
<p>在spring.factories中，配置了需要自动配置的类，我们也可以通过这种方式添加自己的自动配置。</p>
<p>在spring-boot-autoconfigure下就有一个spring.factories，如下：</p>
<img class=" aligncenter" style="max-width: 1500px;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/1-1532934494.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="1500" height="385">

<p>说了这么多，只为说明一点，Spring Boot为我们做了很多自动化的配置，搭建快速方便。</p>
<p>但是，正因为它为我们做了很多事情，就有很多坑，有时候，出了问题，我们可能很难找出问题所在，这时候，我们可能就要考虑下是否是自动配置导致的，有可能配置冲突了，或者没有使用上自定义的配置等等。</p>
<h3 id="5、项目结构划分"><a href="#5、项目结构划分" class="headerlink" title="5、项目结构划分"></a>5、项目结构划分</h3><p>core是项目的核心模块，结构初步规划如下：</p>
<p>　base是项目的基础核心，定义一些基础类，如BaseController、BaseService等；</p>
<p>    cache是缓存相关；</p>
<p>config是配置中心，模块所有的配置放到config里统一管理；</p>
<p>constants里定义系统的常量。</p>
<p>exception里封装一些基础的异常类；</p>
<p>　system是系统模块；</p>
<p>    util里则是一些通用工具类；</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934495.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p> </p>
<h2 id="二、基础结构功能"><a href="#二、基础结构功能" class="headerlink" title="二、基础结构功能"></a>二、基础结构功能</h2><h3 id="1、web支持"><a href="#1、web支持" class="headerlink" title="1、web支持"></a>1、web支持</h3><p>只需在pom.xml中加入spring-boot-starter-web的依赖即可。</p>
<p>之后，查看POM的依赖树(插件：Maven Helper)，可以看到引入了starter、tomcat、web支持等。可以看出，Sping Boot内嵌了servlet容器，默认tomcat。</p>
<p>自动配置在WebMvcAutoConfiguration和WebMvcProperties里，可自行查看源码，一般我们不需添加其他配置就可以启动这个web项目了。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934495.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934496.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="2、基础功能"><a href="#2、基础功能" class="headerlink" title="2、基础功能"></a>2、基础功能</h3><p>在core中添加一些基础的功能支持。</p>
<p>① 首先引入一些常用的依赖库，主要是一些常用工具类，方便以后的开发。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">!-- ******************************* 常用依赖库 ********************************** --!-- 针对开发IO流功能的工具类库 --dependency    groupIdcommons-io/groupId    artifactIdcommons-io/artifactId    version${commons.io.version}/version/dependency!-- 文件上传 --dependency    groupIdcommons-fileupload/groupId    artifactIdcommons-fileupload/artifactId    version${commons.fileupload.version}/version    exclusions        exclusion            groupIdcommons-io/groupId            artifactIdcommons-io/artifactId        /exclusion    /exclusions/dependency!-- 常用的集合操作，丰富的工具类 --dependency    groupIdcommons-collections/groupId    artifactIdcommons-collections/artifactId    version${commons.collections.version}/version/dependency!-- 操作javabean的工具包 --dependency    groupIdcommons-beanutils/groupId    artifactIdcommons-beanutils/artifactId    version${commons.beanutils.version}/version    exclusions        exclusion            groupIdcommons-collections/groupId            artifactIdcommons-collections/artifactId        /exclusion    /exclusions/dependency!-- 包含一些通用的编码解码算法. 如：MD5、SHA1、Base64等 --dependency    groupIdcommons-codec/groupId    artifactIdcommons-codec/artifactId    version${commons.codec.version}/version/dependency!-- 包含丰富的工具类如 StringUtils --dependency    groupIdorg.apache.commons/groupId    artifactIdcommons-lang3/artifactId    version${commons.lang3.version}/version/dependency!--    Guava工程包含了若干被Google的Java项目广泛依赖的核心库. 集合[collections] 、缓存[caching] 、原生类型支持[primitives support] 、    并发库[concurrency libraries] 、通用注解[common annotations] 、字符串处理[string processing] 、I/O 等等。--dependency    groupIdcom.google.guava/groupId    artifactIdguava/artifactId    version${guava.version}/version/dependency</pre></td>

<p>!– ******************************* 常用依赖库 ********************************** –<br>!– 针对开发IO流功能的工具类库 –<br>dependency<br>    groupIdcommons-io&#x2F;groupId<br>    artifactIdcommons-io&#x2F;artifactId<br>    version${commons.io.version}&#x2F;version<br>&#x2F;dependency<br>!– 文件上传 –<br>dependency<br>    groupIdcommons-fileupload&#x2F;groupId<br>    artifactIdcommons-fileupload&#x2F;artifactId<br>    version${commons.fileupload.version}&#x2F;version<br>    exclusions<br>        exclusion<br>            groupIdcommons-io&#x2F;groupId<br>            artifactIdcommons-io&#x2F;artifactId<br>        &#x2F;exclusion<br>    &#x2F;exclusions<br>&#x2F;dependency<br>!– 常用的集合操作，丰富的工具类 –<br>dependency<br>    groupIdcommons-collections&#x2F;groupId<br>    artifactIdcommons-collections&#x2F;artifactId<br>    version${commons.collections.version}&#x2F;version<br>&#x2F;dependency<br>!– 操作javabean的工具包 –<br>dependency<br>    groupIdcommons-beanutils&#x2F;groupId<br>    artifactIdcommons-beanutils&#x2F;artifactId<br>    version${commons.beanutils.version}&#x2F;version<br>    exclusions<br>        exclusion<br>            groupIdcommons-collections&#x2F;groupId<br>            artifactIdcommons-collections&#x2F;artifactId<br>        &#x2F;exclusion<br>    &#x2F;exclusions<br>&#x2F;dependency<br>!– 包含一些通用的编码解码算法. 如：MD5、SHA1、Base64等 –<br>dependency<br>    groupIdcommons-codec&#x2F;groupId<br>    artifactIdcommons-codec&#x2F;artifactId<br>    version${commons.codec.version}&#x2F;version<br>&#x2F;dependency<br>!– 包含丰富的工具类如 StringUtils –<br>dependency<br>    groupIdorg.apache.commons&#x2F;groupId<br>    artifactIdcommons-lang3&#x2F;artifactId<br>    version${commons.lang3.version}&#x2F;version<br>&#x2F;dependency<br>!–<br>    Guava工程包含了若干被Google的Java项目广泛依赖的核心库. 集合[collections] 、缓存[caching] 、原生类型支持[primitives support] 、<br>    并发库[concurrency libraries] 、通用注解[common annotations] 、字符串处理[string processing] 、I&#x2F;O 等等。<br>–<br>dependency<br>    groupIdcom.google.guava&#x2F;groupId<br>    artifactIdguava&#x2F;artifactId<br>    version${guava.version}&#x2F;version<br>&#x2F;dependency</p>
<p>版本号如下：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934496.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>② 在base添加一个Result类，作为前端的返回对象，Controller的直接返回对象都是Result。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import com.fasterxml.jackson.annotation.JsonInclude; import java.io.Serializable; /** * 前端返回对象 * * @version 1.0 * @author bojiangzhou 2017-12-28 */public class Result implements Serializable {    private static final long serialVersionUID = 1430633339880116031L;     /**     * 成功与否标志     */    private boolean success = true;    /**     * 返回状态码，为空则默认200.前端需要拦截一些常见的状态码如403、404、500等     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private Integer status;    /**     * 编码，可用于前端处理多语言，不需要则不用返回编码     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private String code;    /**     * 相关消息     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private String msg;    /**     * 相关数据     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private Object data;      public Result() {}     public Result(boolean success) {        this.success = success;    }     public Result(boolean success, Integer status) {        this.success = success;        this.status = status;    }     public Result(boolean success, String code, String msg){        this(success);        this.code = code;        this.msg = msg;    }     public Result(boolean success, Integer status, String code, String msg) {        this.success = success;        this.status = status;        this.code = code;        this.msg = msg;    }     public Result(boolean success, String code, String msg, Object data){        this(success);        this.code = code;        this.msg = msg;        this.data = data;    }     public boolean isSuccess() {        return success;    }     public void setSuccess(boolean success) {        this.success = success;    }     public Integer getStatus() {        return status;    }     public void setStatus(Integer status) {        this.status = status;    }     public String getCode() {        return code;    }     public void setCode(String code) {        this.code = code;    }     public String getMsg() {        return msg;    }     public void setMsg(String msg) {        this.msg = msg;    }     public Object getData() {        return data;    }     public void setData(Object data) {        this.data = data;    }}</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import com.fasterxml.jackson.annotation.JsonInclude;</p>
<p>import java.io.Serializable;</p>
<p>&#x2F;**</p>
<ul>
<li>前端返回对象</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-28</li>
</ul>
<p> *&#x2F;<br>public class Result implements Serializable {<br>    private static final long serialVersionUID &#x3D; 1430633339880116031L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 成功与否标志
 */</span>
<span class="token keyword">private</span> <span class="token keyword">boolean</span> success <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 返回状态码，为空则默认200.前端需要拦截一些常见的状态码如403、404、500等
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> Integer status<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 编码，可用于前端处理多语言，不需要则不用返回编码
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String code<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 相关消息
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String msg<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 相关数据
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> Object data<span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>success <span class="token operator">=</span> success<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">,</span> Integer status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>success <span class="token operator">=</span> success<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">,</span> String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">,</span> Integer status<span class="token punctuation">,</span> String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>success <span class="token operator">=</span> success<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">,</span> String code<span class="token punctuation">,</span> String msg<span class="token punctuation">,</span> Object data<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> success<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSuccess</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>success <span class="token operator">=</span> success<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Integer <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStatus</span><span class="token punctuation">(</span>Integer status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCode</span><span class="token punctuation">(</span>String code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMsg</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Object <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>之后在util添加生成Result的工具类Results，用于快速方便的创建Result对象。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.util; import com.lyyzoo.core.base.Result; /** * Result生成工具类 * * @version 1.0 * @author bojiangzhou 2017-12-28 */public class Results {     protected Results() {}     public static Result newResult() {        return new Result();     }     public static Result newResult(boolean success) {        return new Result(success);    }     //    // 业务调用成功    // ----------------------------------------------------------------------------------------------------    public static Result success() {        return new Result();    }     public static Result success(String msg) {        return new Result(true, null, msg);    }     public static Result success(String code, String msg) {        return new Result(true, code, msg);    }     public static Result successWithStatus(Integer status) {        return new Result(true, status);    }     public static Result successWithStatus(Integer status, String msg) {        return new Result(true, status, null, msg);    }     public static Result successWithData(Object data) {        return new Result(true, null, null, data);    }     public static Result successWithData(Object data, String msg) {        return new Result(true, null, msg, data);    }     public static Result successWithData(Object data, String code, String msg) {        return new Result(true, code, msg, data);    }     //    // 业务调用失败    // ----------------------------------------------------------------------------------------------------    public static Result failure() {        return new Result(false);    }     public static Result failure(String msg) {        return new Result(false, null, msg);    }     public static Result failure(String code, String msg) {        return new Result(false, code, msg);    }     public static Result failureWithStatus(Integer status) {        return new Result(false, status);    }     public static Result failureWithStatus(Integer status, String msg) {        return new Result(false, status, null, msg);    }     public static Result failureWithData(Object data) {        return new Result(false, null, null, data);    }     public static Result failureWithData(Object data, String msg) {        return new Result(false, null, msg, data);    }     public static Result failureWithData(Object data, String code, String msg) {        return new Result(false, code, msg, data);    } }</pre></td>

<p>package com.lyyzoo.core.util;</p>
<p>import com.lyyzoo.core.base.Result;</p>
<p>&#x2F;**</p>
<ul>
<li>Result生成工具类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-28</li>
</ul>
<p> *&#x2F;<br>public class Results {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">protected</span> <span class="token function">Results</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">newResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">newResult</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// 业务调用成功</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">success</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">success</span><span class="token punctuation">(</span>String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">successWithStatus</span><span class="token punctuation">(</span>Integer status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">successWithStatus</span><span class="token punctuation">(</span>Integer status<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">successWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">successWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">successWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">,</span> String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// 业务调用失败</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failure</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failure</span><span class="token punctuation">(</span>String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failureWithStatus</span><span class="token punctuation">(</span>Integer status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failureWithStatus</span><span class="token punctuation">(</span>Integer status<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failureWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failureWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> Result <span class="token function">failureWithData</span><span class="token punctuation">(</span>Object data<span class="token punctuation">,</span> String code<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>③ 在base添加BaseEnumK, V枚举接口，定义了获取值和描述的接口。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; /** * 基础枚举接口 * * @version 1.0 * @author bojiangzhou 2017-12-31 */public interface BaseEnumK, V {     /**     * 获取编码     *     * @return 编码     */    K code();     /**     * 获取描述     *      * @return 描述     */    V desc(); }</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>&#x2F;**</p>
<ul>
<li>基础枚举接口</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>public interface BaseEnumK, V {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 获取编码
 *
 * @return 编码
 */</span>
K <span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 获取描述
 * 
 * @return 描述
 */</span>
V <span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>然后在constants下定义一个基础枚举常量类，我们把一些描述信息维护到枚举里面，尽量不要在代码中直接出现魔法值(如一些编码、中文等)，以后的枚举常量类也可以按照这种模式来写。</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.constants; import com.lyyzoo.core.base.BaseEnum; import java.util.HashMap;import java.util.Map; /** * 基础枚举值 * * @version 1.0 * @author bojiangzhou 2018-01-01 */public enum BaseEnums implements BaseEnumString, String {     SUCCESS("request.success", "请求成功"),     FAILURE("request.failure", "请求失败"),     OPERATION_SUCCESS("operation.success", "操作成功"),     OPERATION_FAILURE("operation.failure", "操作失败"),     ERROR("system.error", "系统异常"),     NOT_FOUND("not_found", "请求资源不存在"),     FORBIDDEN("forbidden", "无权限访问"),     VERSION_NOT_MATCH("record_not_exists_or_version_not_match", "记录版本不存在或不匹配"),     PARAMETER_NOT_NULL("parameter_not_be_null", "参数不能为空");     private String code;     private String desc;     private static MapString, String allMap = new HashMap();     BaseEnums(String code, String desc) {        this.code = code;        this.desc = desc;    }     static {        for(BaseEnums enums : BaseEnums.values()){            allMap.put(enums.code, enums.desc);        }    }     @Override    public String code() {        return code;    }     @Override    public String desc() {        return desc;    }     public String desc(String code) {        return allMap.get(code);    } }</pre></td>

<p>package com.lyyzoo.core.constants;</p>
<p>import com.lyyzoo.core.base.BaseEnum;</p>
<p>import java.util.HashMap;<br>import java.util.Map;</p>
<p>&#x2F;**</p>
<ul>
<li>基础枚举值</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-01</li>
</ul>
<p> *&#x2F;<br>public enum BaseEnums implements BaseEnumString, String {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token function">SUCCESS</span><span class="token punctuation">(</span><span class="token string">"request.success"</span><span class="token punctuation">,</span> <span class="token string">"请求成功"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">FAILURE</span><span class="token punctuation">(</span><span class="token string">"request.failure"</span><span class="token punctuation">,</span> <span class="token string">"请求失败"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">OPERATION_SUCCESS</span><span class="token punctuation">(</span><span class="token string">"operation.success"</span><span class="token punctuation">,</span> <span class="token string">"操作成功"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">OPERATION_FAILURE</span><span class="token punctuation">(</span><span class="token string">"operation.failure"</span><span class="token punctuation">,</span> <span class="token string">"操作失败"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">"system.error"</span><span class="token punctuation">,</span> <span class="token string">"系统异常"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">NOT_FOUND</span><span class="token punctuation">(</span><span class="token string">"not_found"</span><span class="token punctuation">,</span> <span class="token string">"请求资源不存在"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">FORBIDDEN</span><span class="token punctuation">(</span><span class="token string">"forbidden"</span><span class="token punctuation">,</span> <span class="token string">"无权限访问"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">VERSION_NOT_MATCH</span><span class="token punctuation">(</span><span class="token string">"record_not_exists_or_version_not_match"</span><span class="token punctuation">,</span> <span class="token string">"记录版本不存在或不匹配"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token function">PARAMETER_NOT_NULL</span><span class="token punctuation">(</span><span class="token string">"parameter_not_be_null"</span><span class="token punctuation">,</span> <span class="token string">"参数不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> String code<span class="token punctuation">;</span>

<span class="token keyword">private</span> String desc<span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> MapString<span class="token punctuation">,</span> String allMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">BaseEnums</span><span class="token punctuation">(</span>String code<span class="token punctuation">,</span> String desc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>BaseEnums enums <span class="token operator">:</span> BaseEnums<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        allMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>enums<span class="token punctuation">.</span>code<span class="token punctuation">,</span> enums<span class="token punctuation">.</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> String <span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> String <span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> desc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">desc</span><span class="token punctuation">(</span>String code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> allMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>④ 再添加一个常用的日期工具类对象，主要包含一些常用的日期时间格式化，后续可再继续往里面添加一些公共方法。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.util;  import org.apache.commons.lang3.StringUtils;import org.apache.commons.lang3.time.DateUtils; import java.text.ParseException;import java.text.SimpleDateFormat;import java.util.Date; /** * 日期时间工具类 * * @version 1.0 * @author bojiangzhou 2017-12-28 */public class Dates {     /**     * 日期时间匹配格式     */    public interface Pattern {        //        // 常规模式        // ----------------------------------------------------------------------------------------------------        /**         * yyyy-MM-dd         */        String DATE = "yyyy-MM-dd";        /**         * yyyy-MM-dd HH:mm:ss         */        String DATETIME = "yyyy-MM-dd HH:mm:ss";        /**         * yyyy-MM-dd HH:mm         */        String DATETIME_MM = "yyyy-MM-dd HH:mm";        /**         * yyyy-MM-dd HH:mm:ss.SSS         */        String DATETIME_SSS = "yyyy-MM-dd HH:mm:ss.SSS";        /**         * HH:mm         */        String TIME = "HH:mm";        /**         * HH:mm:ss         */        String TIME_SS = "HH:mm:ss";         //        // 系统时间格式        // ----------------------------------------------------------------------------------------------------        /**         * yyyy/MM/dd         */        String SYS_DATE = "yyyy/MM/dd";        /**         * yyyy/MM/dd HH:mm:ss         */        String SYS_DATETIME = "yyyy/MM/dd HH:mm:ss";        /**         * yyyy/MM/dd HH:mm         */        String SYS_DATETIME_MM = "yyyy/MM/dd HH:mm";        /**         * yyyy/MM/dd HH:mm:ss.SSS         */        String SYS_DATETIME_SSS = "yyyy/MM/dd HH:mm:ss.SSS";         //        // 无连接符模式        // ----------------------------------------------------------------------------------------------------        /**         * yyyyMMdd         */        String NONE_DATE = "yyyyMMdd";        /**         * yyyyMMddHHmmss         */        String NONE_DATETIME = "yyyyMMddHHmmss";        /**         * yyyyMMddHHmm         */        String NONE_DATETIME_MM = "yyyyMMddHHmm";        /**         * yyyyMMddHHmmssSSS         */        String NONE_DATETIME_SSS = "yyyyMMddHHmmssSSS";    }     public static final String DEFAULT_PATTERN = Pattern.DATETIME;     public static final String[] PARSE_PATTERNS = new String[]{            Pattern.DATE,            Pattern.DATETIME,            Pattern.DATETIME_MM,            Pattern.DATETIME_SSS,            Pattern.SYS_DATE,            Pattern.SYS_DATETIME,            Pattern.SYS_DATETIME_MM,            Pattern.SYS_DATETIME_SSS    };     /**     * 格式化日期时间     *      * @param date 日期时间     *     * @return yyyy-MM-dd HH:mm:ss     */    public static String format(Date date) {        return format(date, DEFAULT_PATTERN);    }     /**     * 格式化日期     *      * @param date 日期(时间)     *     * @param pattern 匹配模式 参考：{@link Dates.Pattern}     *     * @return 格式化后的字符串     */    public static String format(Date date, String pattern) {        if (date == null) {            return null;        }        pattern = StringUtils.isNotBlank(pattern) ? pattern : DEFAULT_PATTERN;        SimpleDateFormat sdf = new SimpleDateFormat(pattern);        return sdf.format(date);    }     /**     * 解析日期     *     * @param date 日期字符串     *     * @return 解析后的日期 默认格式：yyyy-MM-dd HH:mm:ss     */    public static Date parseDate(String date) {        if (StringUtils.isBlank(date)) {            return null;        }        try {            return DateUtils.parseDate(date, PARSE_PATTERNS);        } catch (ParseException e) {            e.printStackTrace();        }        return null;    }     /**     * 解析日期     *     * @param date 日期     *     * @param pattern 格式 参考：{@link Dates.Pattern}     *     * @return 解析后的日期，默认格式：yyyy-MM-dd HH:mm:ss     */    public static Date parseDate(String date, String pattern) {        if (StringUtils.isBlank(date)) {            return null;        }        String[] parsePatterns;        parsePatterns = StringUtils.isNotBlank(pattern) ? new String[]{pattern} : PARSE_PATTERNS;        try {            return DateUtils.parseDate(date, parsePatterns);        } catch (ParseException e) {            e.printStackTrace();        }        return null;    }   }</pre></td>

<p>package com.lyyzoo.core.util;</p>
<p>import org.apache.commons.lang3.StringUtils;<br>import org.apache.commons.lang3.time.DateUtils;</p>
<p>import java.text.ParseException;<br>import java.text.SimpleDateFormat;<br>import java.util.Date;</p>
<p>&#x2F;**</p>
<ul>
<li>日期时间工具类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-28</li>
</ul>
<p> *&#x2F;<br>public class Dates {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 日期时间匹配格式
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Pattern</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//</span>
    <span class="token comment" spellcheck="true">// 常规模式</span>
    <span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy-MM-dd
     */</span>
    String DATE <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy-MM-dd HH:mm:ss
     */</span>
    String DATETIME <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy-MM-dd HH:mm
     */</span>
    String DATETIME_MM <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd HH:mm"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy-MM-dd HH:mm:ss.SSS
     */</span>
    String DATETIME_SSS <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd HH:mm:ss.SSS"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * HH:mm
     */</span>
    String TIME <span class="token operator">=</span> <span class="token string">"HH:mm"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * HH:mm:ss
     */</span>
    String TIME_SS <span class="token operator">=</span> <span class="token string">"HH:mm:ss"</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//</span>
    <span class="token comment" spellcheck="true">// 系统时间格式</span>
    <span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy/MM/dd
     */</span>
    String SYS_DATE <span class="token operator">=</span> <span class="token string">"yyyy/MM/dd"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy/MM/dd HH:mm:ss
     */</span>
    String SYS_DATETIME <span class="token operator">=</span> <span class="token string">"yyyy/MM/dd HH:mm:ss"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy/MM/dd HH:mm
     */</span>
    String SYS_DATETIME_MM <span class="token operator">=</span> <span class="token string">"yyyy/MM/dd HH:mm"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyy/MM/dd HH:mm:ss.SSS
     */</span>
    String SYS_DATETIME_SSS <span class="token operator">=</span> <span class="token string">"yyyy/MM/dd HH:mm:ss.SSS"</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//</span>
    <span class="token comment" spellcheck="true">// 无连接符模式</span>
    <span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
    <span class="token comment" spellcheck="true">/**
     * yyyyMMdd
     */</span>
    String NONE_DATE <span class="token operator">=</span> <span class="token string">"yyyyMMdd"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyyMMddHHmmss
     */</span>
    String NONE_DATETIME <span class="token operator">=</span> <span class="token string">"yyyyMMddHHmmss"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyyMMddHHmm
     */</span>
    String NONE_DATETIME_MM <span class="token operator">=</span> <span class="token string">"yyyyMMddHHmm"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * yyyyMMddHHmmssSSS
     */</span>
    String NONE_DATETIME_SSS <span class="token operator">=</span> <span class="token string">"yyyyMMddHHmmssSSS"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String DEFAULT_PATTERN <span class="token operator">=</span> Pattern<span class="token punctuation">.</span>DATETIME<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> PARSE_PATTERNS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>
        Pattern<span class="token punctuation">.</span>DATE<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>DATETIME<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>DATETIME_MM<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>DATETIME_SSS<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>SYS_DATE<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>SYS_DATETIME<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>SYS_DATETIME_MM<span class="token punctuation">,</span>
        Pattern<span class="token punctuation">.</span>SYS_DATETIME_SSS
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 格式化日期时间
 * 
 * @param date 日期时间
 *
 * @return yyyy-MM-dd HH:mm:ss
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">format</span><span class="token punctuation">(</span>Date date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> DEFAULT_PATTERN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 格式化日期
 * 
 * @param date 日期(时间)
 *
 * @param pattern 匹配模式 参考：{@link Dates.Pattern}
 *
 * @return 格式化后的字符串
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">format</span><span class="token punctuation">(</span>Date date<span class="token punctuation">,</span> String pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>date <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    pattern <span class="token operator">=</span> StringUtils<span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span> <span class="token operator">?</span> pattern <span class="token operator">:</span> DEFAULT_PATTERN<span class="token punctuation">;</span>
    SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 解析日期
 *
 * @param date 日期字符串
 *
 * @return 解析后的日期 默认格式：yyyy-MM-dd HH:mm:ss
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Date <span class="token function">parseDate</span><span class="token punctuation">(</span>String date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> DateUtils<span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> PARSE_PATTERNS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 解析日期
 *
 * @param date 日期
 *
 * @param pattern 格式 参考：{@link Dates.Pattern}
 *
 * @return 解析后的日期，默认格式：yyyy-MM-dd HH:mm:ss
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Date <span class="token function">parseDate</span><span class="token punctuation">(</span>String date<span class="token punctuation">,</span> String pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    String<span class="token punctuation">[</span><span class="token punctuation">]</span> parsePatterns<span class="token punctuation">;</span>
    parsePatterns <span class="token operator">=</span> StringUtils<span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>pattern<span class="token punctuation">}</span> <span class="token operator">:</span> PARSE_PATTERNS<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> DateUtils<span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> parsePatterns<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>⑤ Constants定义系统级的通用常量。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.constants; import com.google.common.base.Charsets; import java.nio.charset.Charset; /** * 系统级常量类 * * @version 1.0 * @author bojiangzhou 2017-12-28 */public class Constants {     public static final String APP_NAME = "sunny";     /**     * 系统编码     */    public static final Charset CHARSET = Charsets.UTF_8;     /**     * 标识：是/否、启用/禁用等     */    public interface Flag {         Integer YES = 1;         Integer NO = 0;    }     /**     * 操作类型     */    public interface Operation {        /**         * 添加         */        String ADD = "add";        /**         * 更新         */        String UPDATE = "update";        /**         * 删除         */        String DELETE = "delete";    }     /**     * 性别     */    public interface Sex {        /**         * 男         */        Integer MALE = 1;        /**         * 女         */        Integer FEMALE = 0;    } }</pre></td>

<p>package com.lyyzoo.core.constants;</p>
<p>import com.google.common.base.Charsets;</p>
<p>import java.nio.charset.Charset;</p>
<p>&#x2F;**</p>
<ul>
<li>系统级常量类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-28</li>
</ul>
<p> *&#x2F;<br>public class Constants {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String APP_NAME <span class="token operator">=</span> <span class="token string">"sunny"</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 系统编码
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Charset CHARSET <span class="token operator">=</span> Charsets<span class="token punctuation">.</span>UTF_8<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 标识：是/否、启用/禁用等
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Flag</span> <span class="token punctuation">{</span>

    Integer YES <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    Integer NO <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 操作类型
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Operation</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/**
     * 添加
     */</span>
    String ADD <span class="token operator">=</span> <span class="token string">"add"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * 更新
     */</span>
    String UPDATE <span class="token operator">=</span> <span class="token string">"update"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * 删除
     */</span>
    String DELETE <span class="token operator">=</span> <span class="token string">"delete"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 性别
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Sex</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/**
     * 男
     */</span>
    Integer MALE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/**
     * 女
     */</span>
    Integer FEMALE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>⑥ 在base添加空的BaseController、BaseDTO、Service、Mapper，先定义好基础结构，后面再添加功能。</p>
<p>BaseDTO：标准的who字段、版本号、及10个扩展字段。</p>
<p>因为这里用到了@Transient注解，先引入java持久化包：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934498.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img id="code_img_opened_63a41268-6626-4fb4-a32e-8187c8081513" class="code_img_opened aligncenter" style="display: none;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934498-1.gif" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import com.fasterxml.jackson.annotation.*;import com.lyyzoo.core.Constants;import com.lyyzoo.core.util.Dates;import org.apache.commons.lang3.builder.ToStringBuilder;import org.apache.commons.lang3.builder.ToStringStyle; import javax.persistence.Transient;import java.io.Serializable;import java.util.Date;import java.util.HashMap;import java.util.Map; /** * 基础实体类 * * @version 1.0 * @author bojiangzhou 2017-12-29 */public class BaseDTO implements Serializable {    private static final long serialVersionUID = -4287607489867805101L;     public static final String FIELD_OPERATE = "operate";    public static final String FIELD_OBJECT_VERSION_NUMBER = "versionNumber";    public static final String FIELD_CREATE_BY = "createBy";    public static final String FIELD_CREATOR = "creator";    public static final String FIELD_CREATE_DATE = "createDate";    public static final String FIELD_UPDATE_BY = "updateBy";    public static final String FIELD_UPDATER = "updater";    public static final String FIELD_UPDATE_DATE = "updateDate";      /**     * 操作类型，add/update/delete 参考：{@link Constants.Operation}     */    @Transient    private String _operate;     /**     * 数据版本号,每发生update则自增,用于实现乐观锁.     */    private Long versionNumber;     //    // 下面是标准 WHO 字段    // ----------------------------------------------------------------------------------------------------    /**     * 创建人用户名     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private Long createBy;    /**     * 创建人名称     */    @JsonInclude(JsonInclude.Include.NON_NULL)    @Transient    private String creator;    /**     * 创建时间     */    @JsonInclude(JsonInclude.Include.NON_NULL)    @JsonFormat(pattern = Dates.DEFAULT_PATTERN)    private Date createDate;     /**     * 更新人用户名     */    @JsonInclude(JsonInclude.Include.NON_NULL)    private Long updateBy;    /**     * 更新人名称     */    @JsonInclude(JsonInclude.Include.NON_NULL)    @Transient    private String updater;    /**     * 更新时间     */    @JsonInclude(JsonInclude.Include.NON_NULL)    @JsonFormat(pattern = Dates.DEFAULT_PATTERN)    private Date updateDate;     /**     * 其它属性     */    @JsonIgnore    @Transient    protected MapString, Object innerMap = new HashMap();     //    // 下面是扩展属性字段    // ----------------------------------------------------------------------------------------------------     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute1;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute2;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute3;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute4;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute5;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute6;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute7;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute8;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute9;     @JsonInclude(JsonInclude.Include.NON_NULL)    private String attribute10;     public String get_operate() {        return _operate;    }     public void set_operate(String _operate) {        this._operate = _operate;    }     @Override    public String toString() {        return ToStringBuilder.reflectionToString(this, ToStringStyle.MULTI_LINE_STYLE);    }     public String toJSONString() {        return ToStringBuilder.reflectionToString(this, ToStringStyle.JSON_STYLE);    }     public Long getVersionNumber() {        return versionNumber;    }     public void setVersionNumber(Long versionNumber) {        this.versionNumber = versionNumber;    }     public Long getCreateBy() {        return createBy;    }     public void setCreateBy(Long createBy) {        this.createBy = createBy;    }     public String getCreator() {        return creator;    }     public void setCreator(String creator) {        this.creator = creator;    }     public Date getCreateDate() {        return createDate;    }     public void setCreateDate(Date createDate) {        this.createDate = createDate;    }     public Long getUpdateBy() {        return updateBy;    }     public void setUpdateBy(Long updateBy) {        this.updateBy = updateBy;    }     public String getUpdater() {        return updater;    }     public void setUpdater(String updater) {        this.updater = updater;    }     public Date getUpdateDate() {        return updateDate;    }     public void setUpdateDate(Date updateDate) {        this.updateDate = updateDate;    }     @JsonAnyGetter    public Object getAttribute(String key) {        return innerMap.get(key);    }     @JsonAnySetter    public void setAttribute(String key, Object obj) {        innerMap.put(key, obj);    }     public String getAttribute1() {        return attribute1;    }     public void setAttribute1(String attribute1) {        this.attribute1 = attribute1;    }     public String getAttribute2() {        return attribute2;    }     public void setAttribute2(String attribute2) {        this.attribute2 = attribute2;    }     public String getAttribute3() {        return attribute3;    }     public void setAttribute3(String attribute3) {        this.attribute3 = attribute3;    }     public String getAttribute4() {        return attribute4;    }     public void setAttribute4(String attribute4) {        this.attribute4 = attribute4;    }     public String getAttribute5() {        return attribute5;    }     public void setAttribute5(String attribute5) {        this.attribute5 = attribute5;    }     public String getAttribute6() {        return attribute6;    }     public void setAttribute6(String attribute6) {        this.attribute6 = attribute6;    }     public String getAttribute7() {        return attribute7;    }     public void setAttribute7(String attribute7) {        this.attribute7 = attribute7;    }     public String getAttribute8() {        return attribute8;    }     public void setAttribute8(String attribute8) {        this.attribute8 = attribute8;    }     public String getAttribute9() {        return attribute9;    }     public void setAttribute9(String attribute9) {        this.attribute9 = attribute9;    }     public String getAttribute10() {        return attribute10;    }     public void setAttribute10(String attribute10) {        this.attribute10 = attribute10;    } }</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import com.fasterxml.jackson.annotation.*;<br>import com.lyyzoo.core.Constants;<br>import com.lyyzoo.core.util.Dates;<br>import org.apache.commons.lang3.builder.ToStringBuilder;<br>import org.apache.commons.lang3.builder.ToStringStyle;</p>
<p>import javax.persistence.Transient;<br>import java.io.Serializable;<br>import java.util.Date;<br>import java.util.HashMap;<br>import java.util.Map;</p>
<p>&#x2F;**</p>
<ul>
<li>基础实体类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-29</li>
</ul>
<p> *&#x2F;<br>public class BaseDTO implements Serializable {<br>    private static final long serialVersionUID &#x3D; -4287607489867805101L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_OPERATE <span class="token operator">=</span> <span class="token string">"operate"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_OBJECT_VERSION_NUMBER <span class="token operator">=</span> <span class="token string">"versionNumber"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_CREATE_BY <span class="token operator">=</span> <span class="token string">"createBy"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_CREATOR <span class="token operator">=</span> <span class="token string">"creator"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_CREATE_DATE <span class="token operator">=</span> <span class="token string">"createDate"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_UPDATE_BY <span class="token operator">=</span> <span class="token string">"updateBy"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_UPDATER <span class="token operator">=</span> <span class="token string">"updater"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FIELD_UPDATE_DATE <span class="token operator">=</span> <span class="token string">"updateDate"</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/**
 * 操作类型，add/update/delete 参考：{@link Constants.Operation}
 */</span>
<span class="token annotation punctuation">@Transient</span>
<span class="token keyword">private</span> String _operate<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 数据版本号,每发生update则自增,用于实现乐观锁.
 */</span>
<span class="token keyword">private</span> Long versionNumber<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// 下面是标准 WHO 字段</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 创建人用户名
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> Long createBy<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 创建人名称
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Transient</span>
<span class="token keyword">private</span> String creator<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 创建时间
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> Dates<span class="token punctuation">.</span>DEFAULT_PATTERN<span class="token punctuation">)</span>
<span class="token keyword">private</span> Date createDate<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 更新人用户名
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> Long updateBy<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 更新人名称
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Transient</span>
<span class="token keyword">private</span> String updater<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 更新时间
 */</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> Dates<span class="token punctuation">.</span>DEFAULT_PATTERN<span class="token punctuation">)</span>
<span class="token keyword">private</span> Date updateDate<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 其它属性
 */</span>
<span class="token annotation punctuation">@JsonIgnore</span>
<span class="token annotation punctuation">@Transient</span>
<span class="token keyword">protected</span> MapString<span class="token punctuation">,</span> Object innerMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// 下面是扩展属性字段</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute1<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute2<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute3<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute4<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute5<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute6<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute7<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute8<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute9<span class="token punctuation">;</span>

<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>JsonInclude<span class="token punctuation">.</span>Include<span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">private</span> String attribute10<span class="token punctuation">;</span>

<span class="token keyword">public</span> String <span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> _operate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set_operate</span><span class="token punctuation">(</span>String _operate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_operate <span class="token operator">=</span> _operate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ToStringBuilder<span class="token punctuation">.</span><span class="token function">reflectionToString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> ToStringStyle<span class="token punctuation">.</span>MULTI_LINE_STYLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ToStringBuilder<span class="token punctuation">.</span><span class="token function">reflectionToString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> ToStringStyle<span class="token punctuation">.</span>JSON_STYLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Long <span class="token function">getVersionNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> versionNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setVersionNumber</span><span class="token punctuation">(</span>Long versionNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>versionNumber <span class="token operator">=</span> versionNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Long <span class="token function">getCreateBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> createBy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCreateBy</span><span class="token punctuation">(</span>Long createBy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>createBy <span class="token operator">=</span> createBy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> creator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCreator</span><span class="token punctuation">(</span>String creator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator <span class="token operator">=</span> creator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Date <span class="token function">getCreateDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> createDate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCreateDate</span><span class="token punctuation">(</span>Date createDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>createDate <span class="token operator">=</span> createDate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Long <span class="token function">getUpdateBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updateBy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUpdateBy</span><span class="token punctuation">(</span>Long updateBy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updateBy <span class="token operator">=</span> updateBy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getUpdater</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updater<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUpdater</span><span class="token punctuation">(</span>String updater<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updater <span class="token operator">=</span> updater<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Date <span class="token function">getUpdateDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updateDate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUpdateDate</span><span class="token punctuation">(</span>Date updateDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updateDate <span class="token operator">=</span> updateDate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@JsonAnyGetter</span>
<span class="token keyword">public</span> Object <span class="token function">getAttribute</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> innerMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@JsonAnySetter</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    innerMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute1</span><span class="token punctuation">(</span>String attribute1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute1 <span class="token operator">=</span> attribute1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute2</span><span class="token punctuation">(</span>String attribute2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute2 <span class="token operator">=</span> attribute2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute3</span><span class="token punctuation">(</span>String attribute3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute3 <span class="token operator">=</span> attribute3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute4</span><span class="token punctuation">(</span>String attribute4<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute4 <span class="token operator">=</span> attribute4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute5</span><span class="token punctuation">(</span>String attribute5<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute5 <span class="token operator">=</span> attribute5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute6</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute6<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute6</span><span class="token punctuation">(</span>String attribute6<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute6 <span class="token operator">=</span> attribute6<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute7</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute7<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute7</span><span class="token punctuation">(</span>String attribute7<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute7 <span class="token operator">=</span> attribute7<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute8<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute8</span><span class="token punctuation">(</span>String attribute8<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute8 <span class="token operator">=</span> attribute8<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute9</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute9<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute9</span><span class="token punctuation">(</span>String attribute9<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute9 <span class="token operator">=</span> attribute9<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getAttribute10</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> attribute10<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute10</span><span class="token punctuation">(</span>String attribute10<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>attribute10 <span class="token operator">=</span> attribute10<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>同时，重写了toString方法，增加了toJsonString方法，使得可以格式化输出DTO的数据：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934498.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>直接打印DTO，输出的格式大概就是这个样子：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934499.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>⑦ 在exception添加BaseException，定义一些基础异常类</p>
<p>基础异常类都继承自运行时异常类(RunntimeException)，尽可能把受检异常转化为非受检异常，更好的面向接口编程，提高代码的扩展性、稳定性。</p>
<p>BaseException：添加了一个错误编码，其它自定义的异常应当继承该类。</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829303132333435</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.exception; /** * 基础异常类 * * @version 1.0 * @author bojiangzhou 2017-12-31 */public class BaseException extends RuntimeException {    private static final long serialVersionUID = -997101946070796354L;     /**     * 错误编码     */    protected String code;     public BaseException() {}     public BaseException(String message) {        super(message);    }     public BaseException(String code, String message) {        super(message);        this.code = code;    }     public String getCode() {        return code;    }     public void setCode(String code) {        this.code = code;    }}</pre></td>

<p>package com.lyyzoo.core.exception;</p>
<p>&#x2F;**</p>
<ul>
<li>基础异常类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>public class BaseException extends RuntimeException {<br>    private static final long serialVersionUID &#x3D; -997101946070796354L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 错误编码
 */</span>
<span class="token keyword">protected</span> String code<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token function">BaseException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">BaseException</span><span class="token punctuation">(</span>String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">BaseException</span><span class="token punctuation">(</span>String code<span class="token punctuation">,</span> String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCode</span><span class="token punctuation">(</span>String code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>ServiceException：继承BaseException，Service层往Controller抛出的异常。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.exception; /** * Service层异常 * * @version 1.0 * @author bojiangzhou 2017-12-31 */public class ServiceException extends BaseException {    private static final long serialVersionUID = 6058294324031642376L;     public ServiceException() {}     public ServiceException(String message) {        super(message);    }     public ServiceException(String code, String message) {        super(code, message);    } }</pre></td>

<p>package com.lyyzoo.core.exception;</p>
<p>&#x2F;**</p>
<ul>
<li>Service层异常</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>public class ServiceException extends BaseException {<br>    private static final long serialVersionUID &#x3D; 6058294324031642376L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">public</span> <span class="token function">ServiceException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">ServiceException</span><span class="token punctuation">(</span>String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">ServiceException</span><span class="token punctuation">(</span>String code<span class="token punctuation">,</span> String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<h3 id="3、添加系统用户功能，使用Postman测试接口"><a href="#3、添加系统用户功能，使用Postman测试接口" class="headerlink" title="3、添加系统用户功能，使用Postman测试接口"></a>3、添加系统用户功能，使用Postman测试接口</h3><p>① 在system模块下，再分成dto、controller、service、mapper、constants子包，以后一个模块功能开发就是这样一个基础结构。</p>
<p>User：系统用户</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.dto; import com.fasterxml.jackson.annotation.JsonFormat;import com.fasterxml.jackson.annotation.JsonInclude;import com.lyyzoo.core.base.BaseDTO;import com.lyyzoo.core.util.Dates; import java.util.Date; /** * 系统用户 * * @version 1.0 * @author bojiangzhou 2017-12-31 */@JsonInclude(JsonInclude.Include.NON_NULL)public class User extends BaseDTO {    private static final long serialVersionUID = -7395431342743009038L;     /**     * 用户ID     */    private Long userId;    /**     * 用户名     */    private String username;    /**     * 密码     */    private String password;    /**     * 昵称     */    private String nickname;    /**     * 生日     */    @JsonFormat(pattern = Dates.Pattern.DATE)    private Date birthday;    /**     * 性别：1-男/0-女     */    private Integer sex;    /**     * 是否启用：1/0     */    private Integer enabled;     public Long getUserId() {        return userId;    }     public void setUserId(Long userId) {        this.userId = userId;    }     public String getUsername() {        return username;    }     public void setUsername(String username) {        this.username = username;    }     public String getPassword() {        return password;    }     public void setPassword(String password) {        this.password = password;    }     public String getNickname() {        return nickname;    }     public void setNickname(String nickname) {        this.nickname = nickname;    }     public Date getBirthday() {        return birthday;    }     public void setBirthday(Date birthday) {        this.birthday = birthday;    }     public Integer getSex() {        return sex;    }     public void setSex(Integer sex) {        this.sex = sex;    }     public Integer getEnabled() {        return enabled;    }     public void setEnabled(Integer enabled) {        this.enabled = enabled;    } }</pre></td>

<p>package com.lyyzoo.core.system.dto;</p>
<p>import com.fasterxml.jackson.annotation.JsonFormat;<br>import com.fasterxml.jackson.annotation.JsonInclude;<br>import com.lyyzoo.core.base.BaseDTO;<br>import com.lyyzoo.core.util.Dates;</p>
<p>import java.util.Date;</p>
<p>&#x2F;**</p>
<ul>
<li>系统用户</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>@JsonInclude(JsonInclude.Include.NON_NULL)<br>public class User extends BaseDTO {<br>    private static final long serialVersionUID &#x3D; -7395431342743009038L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 用户ID
 */</span>
<span class="token keyword">private</span> Long userId<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 用户名
 */</span>
<span class="token keyword">private</span> String username<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 密码
 */</span>
<span class="token keyword">private</span> String password<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 昵称
 */</span>
<span class="token keyword">private</span> String nickname<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 生日
 */</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> Dates<span class="token punctuation">.</span>Pattern<span class="token punctuation">.</span>DATE<span class="token punctuation">)</span>
<span class="token keyword">private</span> Date birthday<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 性别：1-男/0-女
 */</span>
<span class="token keyword">private</span> Integer sex<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 是否启用：1/0
 */</span>
<span class="token keyword">private</span> Integer enabled<span class="token punctuation">;</span>

<span class="token keyword">public</span> Long <span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserId</span><span class="token punctuation">(</span>Long userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> username<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span>String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> nickname<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNickname</span><span class="token punctuation">(</span>String nickname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>nickname <span class="token operator">=</span> nickname<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Date <span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBirthday</span><span class="token punctuation">(</span>Date birthday<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>birthday <span class="token operator">=</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Integer <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span>Integer sex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Integer <span class="token function">getEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> enabled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEnabled</span><span class="token punctuation">(</span>Integer enabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> enabled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>UserController：用户控制层；用@RestController注解，前后端分离，因为无需返回视图，采用Restful风格，直接返回数据。</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.controller; import com.lyyzoo.core.Constants;import com.lyyzoo.core.base.BaseController;import com.lyyzoo.core.base.BaseEnums;import com.lyyzoo.core.base.Result;import com.lyyzoo.core.system.dto.User;import com.lyyzoo.core.util.Dates;import com.lyyzoo.core.util.Results;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController; import java.util.ArrayList;import java.util.List; /** * 用户Controller * * @version 1.0 * @author bojiangzhou 2017-12-31 */@RequestMapping("/sys/user")@RestControllerpublic class UserController extends BaseController {     private static ListUser userList = new ArrayList();     // 先静态模拟数据    static {        User user1 = new User();        user1.setUserId(1L);        user1.setUsername("lufei");        user1.setNickname("蒙奇D路飞");        user1.setBirthday(Dates.parseDate("2000-05-05"));        user1.setSex(Constants.Sex.MALE);        user1.setEnabled(Constants.Flag.YES);        userList.add(user1);         User user2 = new User();        user2.setUserId(2L);        user2.setUsername("nami");        user2.setNickname("娜美");        user2.setBirthday(Dates.parseDate("2000/7/3"));        user2.setSex(Constants.Sex.FEMALE);        user2.setEnabled(Constants.Flag.YES);        userList.add(user2);    }     @RequestMapping("/queryAll")    public Result queryAll(){        return Results.successWithData(userList, BaseEnums.SUCCESS.code(), BaseEnums.SUCCESS.description());    }     @RequestMapping("/queryOne/{userId}")    public Result queryOne(@PathVariable Long userId){        User user = null;        for(User u : userList){            if(u.getUserId().longValue() == userId){                user = u;            }        }        return Results.successWithData(user);    }}</pre></td>

<p>package com.lyyzoo.core.system.controller;</p>
<p>import com.lyyzoo.core.Constants;<br>import com.lyyzoo.core.base.BaseController;<br>import com.lyyzoo.core.base.BaseEnums;<br>import com.lyyzoo.core.base.Result;<br>import com.lyyzoo.core.system.dto.User;<br>import com.lyyzoo.core.util.Dates;<br>import com.lyyzoo.core.util.Results;<br>import org.springframework.web.bind.annotation.PathVariable;<br>import org.springframework.web.bind.annotation.RequestMapping;<br>import org.springframework.web.bind.annotation.RestController;</p>
<p>import java.util.ArrayList;<br>import java.util.List;</p>
<p>&#x2F;**</p>
<ul>
<li>用户Controller</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>@RequestMapping(“&#x2F;sys&#x2F;user”)<br>@RestController<br>public class UserController extends BaseController {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">private</span> <span class="token keyword">static</span> ListUser userList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 先静态模拟数据</span>
<span class="token keyword">static</span> <span class="token punctuation">{</span>
    User user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>1L<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"lufei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setNickname</span><span class="token punctuation">(</span><span class="token string">"蒙奇D路飞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>Dates<span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span><span class="token string">"2000-05-05"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>Sex<span class="token punctuation">.</span>MALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user1<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>Flag<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    User user2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>2L<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"nami"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setNickname</span><span class="token punctuation">(</span><span class="token string">"娜美"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>Dates<span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span><span class="token string">"2000/7/3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>Sex<span class="token punctuation">.</span>FEMALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user2<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>Flag<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/queryAll"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">queryAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>userList<span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/queryOne/{userId}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">queryOne</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Long userId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    User user <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>User u <span class="token operator">:</span> userList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> userId<span class="token punctuation">)</span><span class="token punctuation">{</span>
            user <span class="token operator">=</span> u<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>② Postman请求：请求成功，基础的HTTP服务已经实现了。</p>
<img class=" aligncenter" style="border: 1px solid black;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/1-1532934500.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" style="border: 1px solid black;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934500.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h2 id="三、集成MyBatis，实现基础Mapper和Service"><a href="#三、集成MyBatis，实现基础Mapper和Service" class="headerlink" title="三、集成MyBatis，实现基础Mapper和Service"></a>三、集成MyBatis，实现基础Mapper和Service</h2><h3 id="1、添加JDBC、配置数据源"><a href="#1、添加JDBC、配置数据源" class="headerlink" title="1、添加JDBC、配置数据源"></a>1、添加JDBC、配置数据源</h3><p>添加spring-boot-starter-jdbc以支持JDBC访问数据库，然后添加MySql的JDBC驱动mysql-connector-java；</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934500.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>在application.properties里配置mysql的数据库驱动</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934500.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>之后在application-dev.properties里配置开发环境数据库的连接信息，添加之后，Springboot就会自动配置数据源了。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934500.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="2、集成MyBatis"><a href="#2、集成MyBatis" class="headerlink" title="2、集成MyBatis"></a>2、集成MyBatis</h3><p>MyBatis官方为了方便Springboot集成MyBatis，专门提供了一个符合Springboot规范的starter项目，即mybatis-spring-boot-starter。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934501.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>在application.properties里添加mybatis映射配置：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934501.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="3、添加MyBatis通用Mapper"><a href="#3、添加MyBatis通用Mapper" class="headerlink" title="3、添加MyBatis通用Mapper"></a>3、添加MyBatis通用Mapper</h3><p>通用Mapper可以极大的简化开发，极其方便的进行单表的增删改查。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934501.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>关于通用Mapper，参考网站地址：</p>
<p>之后，在core.base下创建自定义的Mapper，按需选择接口。</p>
<p>具体可参考：</p>
<td class="line_numbers"><pre>123456789101112131415161718</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import tk.mybatis.mapper.common.BaseMapper;import tk.mybatis.mapper.common.ConditionMapper;import tk.mybatis.mapper.common.IdsMapper;import tk.mybatis.mapper.common.special.InsertListMapper; /** * * BaseMapper * * @name BaseMapper * @version 1.0 * @author bojiangzhou 2017-12-31 */public interface MapperT extends BaseMapperT, ConditionMapperT, IdsMapperT, InsertListMapperT { }</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import tk.mybatis.mapper.common.BaseMapper;<br>import tk.mybatis.mapper.common.ConditionMapper;<br>import tk.mybatis.mapper.common.IdsMapper;<br>import tk.mybatis.mapper.common.special.InsertListMapper;</p>
<p>&#x2F;**<br> *</p>
<ul>
<li>BaseMapper</li>
<li></li>
<li>@name BaseMapper</li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>public interface Mapper extends BaseMapper, ConditionMapper, IdsMapper, InsertListMapper {</p>
<p>}</p>
<p> </p>
<p>定义好基础Mapper后，就具有下图中的基本通用方法了。每个实体类对应的*Mapper继承Mapper来获得基本的增删改查的通用方法。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934501.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>在application.properties里配置自定义的基础Mapper</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/7-1532934502.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="4、添加分页插件PageHelper"><a href="#4、添加分页插件PageHelper" class="headerlink" title="4、添加分页插件PageHelper"></a>4、添加分页插件PageHelper</h3><img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934502.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>参考地址：</p>
<p>分页插件配置，一般情况下，不需要做任何配置。</p>
<p>之后，我们就可以在代码中使用 PageHelper.startPage(1, 10) 对紧随其后的一个查询进行分页查询，非常方便。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/9-1532934502.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="5、配置自动扫描Mapper"><a href="#5、配置自动扫描Mapper" class="headerlink" title="5、配置自动扫描Mapper"></a>5、配置自动扫描Mapper</h3><p>在config下创建MyBatisConfig配置文件，通过mapperScannerConfigurer方法配置自动扫描Mapper文件。</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.config; import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration; import tk.mybatis.spring.mapper.MapperScannerConfigurer; /** * MyBatis相关配置. * * @version 1.0 * @author bojiangzhou 2018-01-07 */@Configurationpublic class MyBatisConfig {     /**     * Mapper扫描配置. 自动扫描将Mapper接口生成代理注入到Spring.     */    @Bean    public static MapperScannerConfigurer mapperScannerConfigurer() {        MapperScannerConfigurer mapperScannerConfigurer = new MapperScannerConfigurer();        // 注意这里的扫描路径: 1.不要扫描到自定义的Mapper; 2.定义的路径不要扫描到tk.mybatis.mapper(如定义**.mapper).        // 两个做法都会导致扫描到tk.mybatis的Mapper，就会产生重复定义的报错.        mapperScannerConfigurer.setBasePackage("**.lyyzoo.**.mapper");        return mapperScannerConfigurer;    } }</pre></td>

<p>package com.lyyzoo.core.config;</p>
<p>import org.springframework.context.annotation.Bean;<br>import org.springframework.context.annotation.Configuration;</p>
<p>import tk.mybatis.spring.mapper.MapperScannerConfigurer;</p>
<p>&#x2F;**</p>
<ul>
<li>MyBatis相关配置.</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-07</li>
</ul>
<p> *&#x2F;<br>@Configuration<br>public class MyBatisConfig {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * Mapper扫描配置. 自动扫描将Mapper接口生成代理注入到Spring.
 */</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> MapperScannerConfigurer <span class="token function">mapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MapperScannerConfigurer mapperScannerConfigurer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 注意这里的扫描路径: 1.不要扫描到自定义的Mapper; 2.定义的路径不要扫描到tk.mybatis.mapper(如定义**.mapper).</span>
    <span class="token comment" spellcheck="true">// 两个做法都会导致扫描到tk.mybatis的Mapper，就会产生重复定义的报错.</span>
    mapperScannerConfigurer<span class="token punctuation">.</span><span class="token function">setBasePackage</span><span class="token punctuation">(</span><span class="token string">"**.lyyzoo.**.mapper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mapperScannerConfigurer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>注意这里的 MapperScannerConfigurer 是tk.mybatis.spring.mapper.MapperScannerConfigurer，而不是org.mybatis，否则使用通用Mapper的方法时会报类似下面的这种错误</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/7-1532934502-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="6、定义基础Service"><a href="#6、定义基础Service" class="headerlink" title="6、定义基础Service"></a>6、定义基础Service</h3><p>一般来说，我们不能在Controller中直接访问Mapper，因此我们需要加上Service，通过Service访问Mapper。</p>
<p>首先定义基础Service接口，根据Mapper定义基本的增删改查接口方法。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import java.util.List; /** * Service 基础通用接口 * * @name BaseService * @version 1.0 * @author bojiangzhou 2017-12-31 */public interface ServiceT {     //    // insert    // ----------------------------------------------------------------------------------------------------    /**     * 保存一个实体，null的属性也会保存，不会使用数据库默认值     *     * @param record     * @return     */    T insert(T record);     /**     * 批量插入，null的属性也会保存，不会使用数据库默认值     *     * @param recordList     * @return     */    ListT insert(ListT recordList);     /**     * 保存一个实体，null的属性不会保存，会使用数据库默认值     *     * @param record     * @return     */    T insertSelective(T record);     /**     * 批量插入，null的属性不会保存，会使用数据库默认值     *     * @param recordList     * @return     */    ListT insertSelective(ListT recordList);     //    // update    // ----------------------------------------------------------------------------------------------------    /**     * 根据主键更新实体全部字段，null值会被更新     *     * @param record     * @return     */    T update(T record);     /**     * 批量更新，根据主键更新实体全部字段，null值会被更新     *     * @param recordList     * @return     */    ListT update(ListT recordList);     /**     * 根据主键更新属性不为null的值     *     * @param record     * @return     */    T updateSelective(T record);     /**     * 批量更新，根据主键更新属性不为null的值     *     * @param recordList     * @return     */    ListT updateSelective(ListT recordList);     //    // delete    // ----------------------------------------------------------------------------------------------------    /**     * 根据主键删除     *     * @param id id不能为空     * @return     */    int delete(Long id);     /**     * 根据主键字符串进行删除，类中只有存在一个带有@Id注解的字段     *     * @param ids 类似1,2,3     */    int delete(String ids);     /**     * 根据主键删除多个实体，ID数组     *     * @param ids 类似[1,2,3]，不能为空     */    int delete(Long[] ids);     /**     * 根据实体属性作为条件进行删除     *     * @param record     * @return     */    int delete(T record);     /**     * 根据主键删除多个实体     *     * @param recordList     * @return     */    int delete(ListT recordList);     //    // insert or update or delete    // ----------------------------------------------------------------------------------------------------    /**     * 根据实体的operate决定哪种操作. null的属性也会保存，不会使用数据库默认值     *     * @param record     * @return     */    T persist(T record);     /**     * 批量操作.根据实体的operate决定哪种操作. null的属性也会保存，不会使用数据库默认值     *     * @param recordList     * @return     */    ListT persist(ListT recordList);     /**     * 根据实体的operate决定哪种操作. 根据主键更新属性不为null的值     *     * @param record     * @return     */    T persistSelective(T record);     /**     * 批量操作.根据实体的operate决定哪种操作. 根据主键更新属性不为null的值     *     * @param recordList     * @return     */    ListT persistSelective(ListT recordList);      //    // select    // ----------------------------------------------------------------------------------------------------    /**     * 根据主键查询     *     * @param id 不能为空     * @return     */    T get(Long id);     /**     * 根据实体中的属性进行查询，只能有一个返回值，有多个结果是抛出异常     *     * @param record     * @return     */    T get(T record);     /**     * 根据字段和值查询 返回一个     * @param key 不能为空     * @param value 不能为空     * @return     */    T get(String key, Object value);      /**     * 根据主键字符串进行查询     *     * @param ids 如 "1,2,3,4"     * @return     */    ListT select(String ids);     /**     * 根据实体中的属性值进行查询     *     * @param record     * @return     */    ListT select(T record);     /**     * 根据属性和值查询     *     * @param key     * @param value     * @return     */    ListT select(String key, Object value);     /**     * 根据实体中的属性值进行分页查询     *     * @param record     * @param pageNum     * @param pageSize     * @return     */    ListT select(T record, int pageNum, int pageSize);     /**     * 查询全部结果     *     * @return     */    ListT selectAll();     /**     * 根据实体中的属性查询总数     *     * @param record     * @return     */    int count(T record); }</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import java.util.List;</p>
<p>&#x2F;**</p>
<ul>
<li>Service 基础通用接口</li>
<li></li>
<li>@name BaseService</li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>public interface Service {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// insert</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 保存一个实体，null的属性也会保存，不会使用数据库默认值
 *
 * @param record
 * @return
 */</span>
T <span class="token function">insert</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量插入，null的属性也会保存，不会使用数据库默认值
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">insert</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 保存一个实体，null的属性不会保存，会使用数据库默认值
 *
 * @param record
 * @return
 */</span>
T <span class="token function">insertSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量插入，null的属性不会保存，会使用数据库默认值
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">insertSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// update</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 根据主键更新实体全部字段，null值会被更新
 *
 * @param record
 * @return
 */</span>
T <span class="token function">update</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量更新，根据主键更新实体全部字段，null值会被更新
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">update</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据主键更新属性不为null的值
 *
 * @param record
 * @return
 */</span>
T <span class="token function">updateSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量更新，根据主键更新属性不为null的值
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">updateSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// delete</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 根据主键删除
 *
 * @param id id不能为空
 * @return
 */</span>
<span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>Long id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据主键字符串进行删除，类中只有存在一个带有@Id注解的字段
 *
 * @param ids 类似1,2,3
 */</span>
<span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>String ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据主键删除多个实体，ID数组
 *
 * @param ids 类似[1,2,3]，不能为空
 */</span>
<span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>Long<span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体属性作为条件进行删除
 *
 * @param record
 * @return
 */</span>
<span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据主键删除多个实体
 *
 * @param recordList
 * @return
 */</span>
<span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// insert or update or delete</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 根据实体的operate决定哪种操作. null的属性也会保存，不会使用数据库默认值
 *
 * @param record
 * @return
 */</span>
T <span class="token function">persist</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量操作.根据实体的operate决定哪种操作. null的属性也会保存，不会使用数据库默认值
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">persist</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体的operate决定哪种操作. 根据主键更新属性不为null的值
 *
 * @param record
 * @return
 */</span>
T <span class="token function">persistSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 批量操作.根据实体的operate决定哪种操作. 根据主键更新属性不为null的值
 *
 * @param recordList
 * @return
 */</span>
List <span class="token function">persistSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// select</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 根据主键查询
 *
 * @param id 不能为空
 * @return
 */</span>
T <span class="token function">get</span><span class="token punctuation">(</span>Long id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体中的属性进行查询，只能有一个返回值，有多个结果是抛出异常
 *
 * @param record
 * @return
 */</span>
T <span class="token function">get</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据字段和值查询 返回一个
 * @param key 不能为空
 * @param value 不能为空
 * @return
 */</span>
T <span class="token function">get</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/**
 * 根据主键字符串进行查询
 *
 * @param ids 如 "1,2,3,4"
 * @return
 */</span>
List <span class="token function">select</span><span class="token punctuation">(</span>String ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体中的属性值进行查询
 *
 * @param record
 * @return
 */</span>
List <span class="token function">select</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据属性和值查询
 *
 * @param key
 * @param value
 * @return
 */</span>
List <span class="token function">select</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体中的属性值进行分页查询
 *
 * @param record
 * @param pageNum
 * @param pageSize
 * @return
 */</span>
List <span class="token function">select</span><span class="token punctuation">(</span>T record<span class="token punctuation">,</span> <span class="token keyword">int</span> pageNum<span class="token punctuation">,</span> <span class="token keyword">int</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 查询全部结果
 *
 * @return
 */</span>
List <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 根据实体中的属性查询总数
 *
 * @param record
 * @return
 */</span>
<span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>然后是实现类BaseService，以后的开发中，Service接口实现Service，Service实现类继承BaseService。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import com.github.pagehelper.PageHelper;import com.lyyzoo.core.constants.Constants;import com.lyyzoo.core.exception.UpdateFailedException;import com.lyyzoo.core.util.Reflections;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.transaction.annotation.Transactional;import org.springframework.util.Assert; import javax.annotation.PostConstruct;import javax.persistence.Id;import java.lang.reflect.Field;import java.util.List; /** * 基础Service实现类 * * @version 1.0 * @author bojiangzhou 2018-01-04 */public abstract class BaseServiceT implements ServiceT {     @Autowired    private MapperT mapper;     private ClassT entityClass;     @SuppressWarnings("unchecked")    @PostConstruct    public void init() {        this.entityClass = Reflections.getClassGenericType(getClass());    }     //    // insert    // ----------------------------------------------------------------------------------------------------    @Transactional(rollbackFor = Exception.class)    public T insert(T record) {        mapper.insert(record);        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT insert(ListT recordList) {        mapper.insertList(recordList);        return recordList;    }     @Transactional(rollbackFor = Exception.class)    public T insertSelective(T record) {        mapper.insertSelective(record);        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT insertSelective(ListT recordList) {        // 由于Mapper暂未提供Selective的批量插入，此处循环查询. 当然也可参考InsertListMapper自己实现.        for(T record : recordList){            mapper.insertSelective(record);        }        return recordList;    }     //    // update    // ----------------------------------------------------------------------------------------------------    @Transactional(rollbackFor = Exception.class)    public T update(T record) {        int count = mapper.updateByPrimaryKey(record);        checkUpdate(count, record);        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT update(ListT recordList) {        // Mapper暂未提供批量更新，此处循实现        for(T record : recordList){            int count = mapper.updateByPrimaryKey(record);            checkUpdate(count, record);        }        return recordList;    }     @Transactional(rollbackFor = Exception.class)    public T updateSelective(T record) {        int count = mapper.updateByPrimaryKeySelective(record);        checkUpdate(count, record);        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT updateSelective(ListT recordList) {        // Mapper暂未提供批量更新，此处循实现        for(T record : recordList){            int count = mapper.updateByPrimaryKeySelective(record);            checkUpdate(count, record);        }        return recordList;    }     //    // delete    // ----------------------------------------------------------------------------------------------------    @Transactional(rollbackFor = Exception.class)    public int delete(Long id) {        return mapper.deleteByPrimaryKey(id);    }     @Transactional(rollbackFor = Exception.class)    public int delete(Long[] ids) {        int count = 0;        for(Long id : ids){            mapper.deleteByPrimaryKey(id);            count++;        }        return count;    }     @Transactional(rollbackFor = Exception.class)    public int delete(T record) {        return mapper.delete(record);    }     @Transactional(rollbackFor = Exception.class)    public int delete(ListT recordList) {        int count = 0;        for(T record : recordList){            mapper.delete(record);            count++;        }        return count;    }     //    // all operate. insert or update or delete    // ----------------------------------------------------------------------------------------------------    @Transactional(rollbackFor = Exception.class)    public T persist(T record) {        BaseDTO dto = (BaseDTO) record;        Assert.notNull(dto.get_operate(), "_operate not be null.");        switch (dto.get_operate()) {            case Constants.Operation.ADD:                insert(record);                break;            case Constants.Operation.UPDATE:                update(record);                break;            case Constants.Operation.DELETE:                delete(record);                break;            default:                break;        }        dto.set_operate(null);        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT persist(ListT recordList) {        for(T record : recordList){            BaseDTO dto = (BaseDTO) record;            Assert.notNull(dto.get_operate(), "_operate not be null.");            switch (dto.get_operate()) {                case Constants.Operation.ADD:                    insert(record);                    break;                case Constants.Operation.UPDATE:                    update(record);                    break;                case Constants.Operation.DELETE:                    delete(record);                    break;                default:                    break;            }            dto.set_operate(null);        }        return recordList;    }     @Transactional(rollbackFor = Exception.class)    public T persistSelective(T record) {        BaseDTO dto = (BaseDTO) record;        Assert.notNull(dto.get_operate(), "_operate not be null.");        switch (dto.get_operate()) {            case Constants.Operation.ADD:                insertSelective(record);                break;            case Constants.Operation.UPDATE:                updateSelective(record);                break;            case Constants.Operation.DELETE:                delete(record);                break;            default:                break;        }        return record;    }     @Transactional(rollbackFor = Exception.class)    public ListT persistSelective(ListT recordList) {        for(T record : recordList){            BaseDTO dto = (BaseDTO) record;            Assert.notNull(dto.get_operate(), "_operate not be null.");            switch (dto.get_operate()) {                case Constants.Operation.ADD:                    insertSelective(record);                    break;                case Constants.Operation.UPDATE:                    updateSelective(record);                    break;                case Constants.Operation.DELETE:                    delete(record);                    break;                default:                    break;            }        }        return recordList;    }     //    // select    // ----------------------------------------------------------------------------------------------------    public T get(Long id) {        T entity = null;        try {            entity = entityClass.newInstance();            Field idField = Reflections.getFieldByAnnotation(entityClass, Id.class);            idField.set(entity, id);        } catch (Exception e) {            e.printStackTrace();        }         return mapper.selectByPrimaryKey(entity);    }     public T get(T record) {        return mapper.selectOne(record);    }     public T get(String key, Object value) {        T entity = null;        try {            entity = entityClass.newInstance();            Field field = Reflections.getField(entityClass, key);            field.set(entity, value);        } catch (Exception e) {            e.printStackTrace();        }         return mapper.selectOne(entity);    }     public ListT select(String ids) {        return mapper.selectByIds(ids);    }     public ListT select(T record) {         return mapper.select(record);    }     public ListT select(String key, Object value) {        T entity = null;        try {            entity = entityClass.newInstance();            Field field = Reflections.getField(entityClass, key);            field.set(entity, value);        } catch (Exception e) {            e.printStackTrace();        }        return mapper.select(entity);    }     public ListT select(T record, int pageNum, int pageSize) {        PageHelper.startPage(pageNum, pageSize);        return mapper.select(record);    }     public ListT selectAll() {        return mapper.selectAll();    }     public int count(T record) {        return mapper.selectCount(record);    }     /**     * 检查乐观锁br     * 更新失败时，抛出 UpdateFailedException 异常     *     * @param updateCount update,delete 操作返回的值     * @param record 操作参数     */    protected void checkUpdate(int updateCount, Object record) {        if (updateCount == 0 && record instanceof BaseDTO) {            BaseDTO baseDTO = (BaseDTO) record;            if (baseDTO.getVersion() != null) {                throw new UpdateFailedException();            }        }    } }</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import com.github.pagehelper.PageHelper;<br>import com.lyyzoo.core.constants.Constants;<br>import com.lyyzoo.core.exception.UpdateFailedException;<br>import com.lyyzoo.core.util.Reflections;<br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.transaction.annotation.Transactional;<br>import org.springframework.util.Assert;</p>
<p>import javax.annotation.PostConstruct;<br>import javax.persistence.Id;<br>import java.lang.reflect.Field;<br>import java.util.List;</p>
<p>&#x2F;**</p>
<ul>
<li>基础Service实现类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-04</li>
</ul>
<p> *&#x2F;<br>public abstract class BaseService implements Service {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> Mapper mapper<span class="token punctuation">;</span>

<span class="token keyword">private</span> Class <span class="token class-name">entityClass</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostConstruct</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>entityClass <span class="token operator">=</span> Reflections<span class="token punctuation">.</span><span class="token function">getClassGenericType</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// insert</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">insert</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">insert</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mapper<span class="token punctuation">.</span><span class="token function">insertList</span><span class="token punctuation">(</span>recordList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">insertSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mapper<span class="token punctuation">.</span><span class="token function">insertSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">insertSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 由于Mapper暂未提供Selective的批量插入，此处循环查询. 当然也可参考InsertListMapper自己实现.</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        mapper<span class="token punctuation">.</span><span class="token function">insertSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// update</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">update</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">checkUpdate</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">update</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Mapper暂未提供批量更新，此处循实现</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">checkUpdate</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">updateSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">checkUpdate</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">updateSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Mapper暂未提供批量更新，此处循实现</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">checkUpdate</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// delete</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>Long id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>Long<span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>Long id <span class="token operator">:</span> ids<span class="token punctuation">)</span><span class="token punctuation">{</span>
        mapper<span class="token punctuation">.</span><span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        mapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// all operate. insert or update or delete</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">persist</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    BaseDTO dto <span class="token operator">=</span> <span class="token punctuation">(</span>BaseDTO<span class="token punctuation">)</span> record<span class="token punctuation">;</span>
    Assert<span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"_operate not be null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>ADD<span class="token operator">:</span>
            <span class="token function">insert</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>UPDATE<span class="token operator">:</span>
            <span class="token function">update</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>DELETE<span class="token operator">:</span>
            <span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    dto<span class="token punctuation">.</span><span class="token function">set_operate</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">persist</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        BaseDTO dto <span class="token operator">=</span> <span class="token punctuation">(</span>BaseDTO<span class="token punctuation">)</span> record<span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"_operate not be null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>ADD<span class="token operator">:</span>
                <span class="token function">insert</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>UPDATE<span class="token operator">:</span>
                <span class="token function">update</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>DELETE<span class="token operator">:</span>
                <span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        dto<span class="token punctuation">.</span><span class="token function">set_operate</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> T <span class="token function">persistSelective</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    BaseDTO dto <span class="token operator">=</span> <span class="token punctuation">(</span>BaseDTO<span class="token punctuation">)</span> record<span class="token punctuation">;</span>
    Assert<span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"_operate not be null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>ADD<span class="token operator">:</span>
            <span class="token function">insertSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>UPDATE<span class="token operator">:</span>
            <span class="token function">updateSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>DELETE<span class="token operator">:</span>
            <span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> record<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> List <span class="token function">persistSelective</span><span class="token punctuation">(</span>List recordList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>T record <span class="token operator">:</span> recordList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        BaseDTO dto <span class="token operator">=</span> <span class="token punctuation">(</span>BaseDTO<span class="token punctuation">)</span> record<span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"_operate not be null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">get_operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>ADD<span class="token operator">:</span>
                <span class="token function">insertSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>UPDATE<span class="token operator">:</span>
                <span class="token function">updateSelective</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> Constants<span class="token punctuation">.</span>Operation<span class="token punctuation">.</span>DELETE<span class="token operator">:</span>
                <span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> recordList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// select</span>
<span class="token comment" spellcheck="true">// ----------------------------------------------------------------------------------------------------</span>
<span class="token keyword">public</span> T <span class="token function">get</span><span class="token punctuation">(</span>Long id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    T entity <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        entity <span class="token operator">=</span> entityClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Field idField <span class="token operator">=</span> Reflections<span class="token punctuation">.</span><span class="token function">getFieldByAnnotation</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">,</span> Id<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        idField<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>entity<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> T <span class="token function">get</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> T <span class="token function">get</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    T entity <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        entity <span class="token operator">=</span> entityClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Field field <span class="token operator">=</span> Reflections<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>entity<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> List <span class="token function">select</span><span class="token punctuation">(</span>String ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectByIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> List <span class="token function">select</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> List <span class="token function">select</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    T entity <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        entity <span class="token operator">=</span> entityClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Field field <span class="token operator">=</span> Reflections<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>entity<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> List <span class="token function">select</span><span class="token punctuation">(</span>T record<span class="token punctuation">,</span> <span class="token keyword">int</span> pageNum<span class="token punctuation">,</span> <span class="token keyword">int</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    PageHelper<span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> List <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span>T record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 检查乐观锁br
 * 更新失败时，抛出 UpdateFailedException 异常
 *
 * @param updateCount update,delete 操作返回的值
 * @param record 操作参数
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">checkUpdate</span><span class="token punctuation">(</span><span class="token keyword">int</span> updateCount<span class="token punctuation">,</span> Object record<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>updateCount <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> record <span class="token keyword">instanceof</span> <span class="token class-name">BaseDTO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BaseDTO baseDTO <span class="token operator">=</span> <span class="token punctuation">(</span>BaseDTO<span class="token punctuation">)</span> record<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>baseDTO<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UpdateFailedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>BaseService的实现用到了反射工具类Reflections：</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.util; import org.slf4j.Logger;import org.slf4j.LoggerFactory; import java.lang.reflect.Field;import java.lang.reflect.Modifier;import java.lang.reflect.ParameterizedType;import java.lang.reflect.Type; /** * 反射工具类. * * @version 1.0 * @author bojiangzhou 2018-01-06 */ public abstract class Reflections {     private static Logger logger = LoggerFactory.getLogger(Reflections.class);     /**     * 通过反射, 获得Class定义中声明的泛型参数的类型, 注意泛型必须定义在父类处. 如无法找到, 返回Object.class.     *     * @param clazz class类     *     * @return the 返回第一个声明的泛型类型. 如果没有,则返回Object.class     */    @SuppressWarnings("unchecked")    public static Class getClassGenericType(final Class clazz) {        return getClassGenericType(clazz, 0);    }     /**     * 通过反射, 获得Class定义中声明的父类的泛型参数的类型. 如无法找到, 返回Object.class.     *     * @param clazz class类     *     * @param index 获取第几个泛型参数的类型,默认从0开始,即第一个     *     * @return 返回第index个泛型参数类型.     */    public static Class getClassGenericType(final Class clazz, final int index) {        Type genType = clazz.getGenericSuperclass();         if (!(genType instanceof ParameterizedType)) {            return Object.class;        }         Type[] params = ((ParameterizedType) genType).getActualTypeArguments();         if (index = params.length || index  0) {            logger.warn("Index: " + index + ", Size of " + clazz.getSimpleName() + "'s Parameterized Type: " + params.length);            return Object.class;        }        if (!(params[index] instanceof Class)) {            logger.warn(clazz.getSimpleName() + " not set the actual class on superclass generic parameter");            return Object.class;        }         return (Class) params[index];    }     /**     * 根据注解类型获取实体的Field     *     * @param entityClass 实体类型     *      * @param annotationClass 注解类型     *     * @return 返回第一个有该注解类型的Field,如果没有则返回null.     */    @SuppressWarnings("unchecked")    public static Field getFieldByAnnotation(Class entityClass, Class annotationClass) {        Field[] fields = entityClass.getDeclaredFields();        for (Field field : fields) {            if (field.getAnnotation(annotationClass) != null) {                makeAccessible(field);                return field;            }        }        return null;    }     /**     * 获取实体的字段     *     * @param entityClass 实体类型     *     * @param fieldName 字段名称     *     * @return 该字段名称对应的字段,如果没有则返回null.     */    public static Field getField(Class entityClass, String fieldName){        try {            Field field = entityClass.getDeclaredField(fieldName);            makeAccessible(field);            return field;        } catch (NoSuchFieldException e) {            e.printStackTrace();        }        return null;    }      /**     * 改变private/protected的成员变量为public.     */    public static void makeAccessible(Field field) {        if (!Modifier.isPublic(field.getModifiers()) || !Modifier.isPublic(field.getDeclaringClass().getModifiers())) {            field.setAccessible(true);        }    } }</pre></td>

<p>package com.lyyzoo.core.util;</p>
<p>import org.slf4j.Logger;<br>import org.slf4j.LoggerFactory;</p>
<p>import java.lang.reflect.Field;<br>import java.lang.reflect.Modifier;<br>import java.lang.reflect.ParameterizedType;<br>import java.lang.reflect.Type;</p>
<p>&#x2F;**</p>
<ul>
<li>反射工具类.</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-06</li>
</ul>
<p> *&#x2F;</p>
<p>public abstract class Reflections {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">private</span> <span class="token keyword">static</span> Logger logger <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>Reflections<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 通过反射, 获得Class定义中声明的泛型参数的类型, 注意泛型必须定义在父类处. 如无法找到, 返回Object.class.
 *
 * @param clazz class类
 *
 * @return the 返回第一个声明的泛型类型. 如果没有,则返回Object.class
 */</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Class <span class="token class-name">getClassGenericType</span><span class="token punctuation">(</span><span class="token keyword">final</span> Class <span class="token class-name">clazz</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">getClassGenericType</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 通过反射, 获得Class定义中声明的父类的泛型参数的类型. 如无法找到, 返回Object.class.
 *
 * @param clazz class类
 *
 * @param index 获取第几个泛型参数的类型,默认从0开始,即第一个
 *
 * @return 返回第index个泛型参数类型.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Class <span class="token class-name">getClassGenericType</span><span class="token punctuation">(</span><span class="token keyword">final</span> Class <span class="token class-name">clazz</span><span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Type genType <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getGenericSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>genType <span class="token keyword">instanceof</span> <span class="token class-name">ParameterizedType</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Type<span class="token punctuation">[</span><span class="token punctuation">]</span> params <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ParameterizedType<span class="token punctuation">)</span> genType<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getActualTypeArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> params<span class="token punctuation">.</span>length <span class="token operator">||</span> index  <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Index: "</span> <span class="token operator">+</span> index <span class="token operator">+</span> <span class="token string">", Size of "</span> <span class="token operator">+</span> clazz<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'s Parameterized Type: "</span> <span class="token operator">+</span> params<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" not set the actual class on superclass generic parameter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>Class<span class="token punctuation">)</span> params<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 根据注解类型获取实体的Field
 *
 * @param entityClass 实体类型
 * 
 * @param annotationClass 注解类型
 *
 * @return 返回第一个有该注解类型的Field,如果没有则返回null.
 */</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Field <span class="token function">getFieldByAnnotation</span><span class="token punctuation">(</span>Class <span class="token class-name">entityClass</span><span class="token punctuation">,</span> Class <span class="token class-name">annotationClass</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Field<span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> entityClass<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>Field field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>annotationClass<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">makeAccessible</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> field<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 获取实体的字段
 *
 * @param entityClass 实体类型
 *
 * @param fieldName 字段名称
 *
 * @return 该字段名称对应的字段,如果没有则返回null.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Field <span class="token function">getField</span><span class="token punctuation">(</span>Class <span class="token class-name">entityClass</span><span class="token punctuation">,</span> String fieldName<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        Field field <span class="token operator">=</span> entityClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">makeAccessible</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> field<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchFieldException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">/**
 * 改变private/protected的成员变量为public.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">makeAccessible</span><span class="token punctuation">(</span>Field field<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Modifier<span class="token punctuation">.</span><span class="token function">isPublic</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>Modifier<span class="token punctuation">.</span><span class="token function">isPublic</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<h3 id="7、获取AOP代理"><a href="#7、获取AOP代理" class="headerlink" title="7、获取AOP代理"></a>7、获取AOP代理</h3><p>Spring 只要引入aop则是默认开启事务的，一般我们只要在需要事务管理的地方加上@Transactional注解即可支持事务，一般我们会加在Service的类或者具体的增加、删除、更改的方法上。</p>
<p>我这里要说的是获取代理的问题。Service的事务管理是AOP实现的，AOP的实现用的是JDK动态代理或CGLIB动态代理。所以，如果你想在你的代理方法中以 this 调用当前接口的另一个方法，另一个方法的事务是不会起作用的。因为事务的方法是代理对象的，而 this 是当前类对象，不是一个代理对象，自然事务就不会起作用了。这是我在不久前的开发中遇到的实际问题，我自定义了一个注解，加在方法上，使用AspectJ来拦截该注解，却没拦截到，原因就是这个方法是被另一个方法以 this 的方式调用的，所以AOP不能起作用。</p>
<p>更详细的可参考：</p>
<p>所以添加一个获取自身代理对象的接口，以方便获取代理对象来操作当前类方法。Service接口只需要继承该接口，T为接口本身即可，就可以通过self()获取自身的代理对象了。</p>
<td class="line_numbers"><pre>123456789101112131415161718</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.base; import org.springframework.aop.framework.AopContext; /** * 获取代理对象本身. */public interface ProxySelfT {    /**     * 取得当前对象的代理.     *      * @return 代理对象,如果未被代理,则抛出 IllegalStateException     */    @SuppressWarnings("unchecked")    default T self() {        return (T) AopContext.currentProxy();    }}</pre></td>

<p>package com.lyyzoo.core.base;</p>
<p>import org.springframework.aop.framework.AopContext;</p>
<p>&#x2F;**</p>
<ul>
<li>获取代理对象本身.</li>
</ul>
<p> <em>&#x2F;<br>public interface ProxySelf {<br>    &#x2F;</em>*<br>     * 取得当前对象的代理.<br>     *<br>     * @return 代理对象,如果未被代理,则抛出 IllegalStateException<br>     *&#x2F;<br>    @SuppressWarnings(“unchecked”)<br>    default T self() {<br>        return (T) AopContext.currentProxy();<br>    }<br>}</p>
<p> </p>
<p>还需要开启开启 exposeProxy &#x3D; true，暴露代理对象，否则 AopContext.currentProxy() 会抛出异常。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/3-1532934504.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="8、数据持久化测试"><a href="#8、数据持久化测试" class="headerlink" title="8、数据持久化测试"></a>8、数据持久化测试</h3><p>① 实体映射</p>
<p>实体类按照如下规则和数据库表进行转换，注解全部是JPA中的注解：</p>
<ul>
<li>表名默认使用类名，驼峰转下划线(只对大写字母进行处理)，如UserInfo默认对应的表名为user_info</li>
<li>表名可以使@Table(name &#x3D; “tableName”)进行指定，对不符合第一条默认规则的可以通过这种方式指定表名。</li>
<li>字段默认和@Column一样，都会作为表字段，表字段默认为Java对象的Field名字驼峰转下划线形式。</li>
<li>可以使用@Column(name &#x3D; “fieldName”)指定不符合第3条规则的字段名。</li>
<li><strong>使用@Transient注解可以忽略字段，添加该注解的字段不会作为表字段使用，注意，如果没有与表关联，一定要用@Transient标注。</strong></li>
<li><strong>建议一定是有一个@Id注解作为主键的字段,可以有多个@Id注解的字段作为联合主键。</strong></li>
<li><strong>默认情况下，实体类中如果不存在包含@Id注解的字段,所有的字段都会作为主键字段进行使用(这种效率极低)。</strong></li>
<li>由于基本类型，如int作为实体类字段时会有默认值0，而且无法消除，所以实体类中建议不要使用基本类型。<img id="code_img_opened_b770a9f7-017d-4d91-90d9-3f1049ac844d" class="code_img_opened aligncenter" style="display: none;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/1-1532934504.gif" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构"></li>
</ul>
<p>User实体主要加了@Table注解，映射表名；然后在userId上标注主键注解；其它字段如果没加@Transient注解的默认都会作为表字段。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.dto; import com.fasterxml.jackson.annotation.JsonFormat;import com.fasterxml.jackson.annotation.JsonInclude;import com.lyyzoo.core.base.BaseDTO;import com.lyyzoo.core.util.Dates; import javax.persistence.*;import java.util.Date;import java.util.List; /** * 系统用户 * * @name User * @version 1.0 * @author bojiangzhou 2017-12-31 */@JsonInclude(JsonInclude.Include.NON_NULL)@Table(name = "SYS_USER")public class User extends BaseDTO {    private static final long serialVersionUID = -7395431342743009038L;     /**     * 用户ID     */    @Id    @GeneratedValue(strategy = GenerationType.IDENTITY)    @OrderBy("DESC")    private Long userId;    /**     * 用户名     */    private String username;    /**     * 密码     */    private String password;    /**     * 昵称     */    private String nickname;    /**     * 生日     */    @JsonFormat(pattern = Dates.Pattern.DATE)    private Date birthday;    /**     * 性别：1-男/0-女     */    private Integer sex;    /**     * 是否启用：1/0     */    private Integer enabled;      public Long getUserId() {        return userId;    }     public void setUserId(Long userId) {        this.userId = userId;    }     public String getUsername() {        return username;    }     public void setUsername(String username) {        this.username = username;    }     public String getPassword() {        return password;    }     public void setPassword(String password) {        this.password = password;    }     public String getNickname() {        return nickname;    }     public void setNickname(String nickname) {        this.nickname = nickname;    }     public Date getBirthday() {        return birthday;    }     public void setBirthday(Date birthday) {        this.birthday = birthday;    }     public Integer getSex() {        return sex;    }     public void setSex(Integer sex) {        this.sex = sex;    }     public Integer getEnabled() {        return enabled;    }     public void setEnabled(Integer enabled) {        this.enabled = enabled;    } }</pre></td>

<p>package com.lyyzoo.core.system.dto;</p>
<p>import com.fasterxml.jackson.annotation.JsonFormat;<br>import com.fasterxml.jackson.annotation.JsonInclude;<br>import com.lyyzoo.core.base.BaseDTO;<br>import com.lyyzoo.core.util.Dates;</p>
<p>import javax.persistence.*;<br>import java.util.Date;<br>import java.util.List;</p>
<p>&#x2F;**</p>
<ul>
<li>系统用户</li>
<li></li>
<li>@name User</li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>@JsonInclude(JsonInclude.Include.NON_NULL)<br>@Table(name &#x3D; “SYS_USER”)<br>public class User extends BaseDTO {<br>    private static final long serialVersionUID &#x3D; -7395431342743009038L;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 用户ID
 */</span>
<span class="token annotation punctuation">@Id</span>
<span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> GenerationType<span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
<span class="token annotation punctuation">@OrderBy</span><span class="token punctuation">(</span><span class="token string">"DESC"</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> Long userId<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 用户名
 */</span>
<span class="token keyword">private</span> String username<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 密码
 */</span>
<span class="token keyword">private</span> String password<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 昵称
 */</span>
<span class="token keyword">private</span> String nickname<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 生日
 */</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> Dates<span class="token punctuation">.</span>Pattern<span class="token punctuation">.</span>DATE<span class="token punctuation">)</span>
<span class="token keyword">private</span> Date birthday<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 性别：1-男/0-女
 */</span>
<span class="token keyword">private</span> Integer sex<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * 是否启用：1/0
 */</span>
<span class="token keyword">private</span> Integer enabled<span class="token punctuation">;</span>


<span class="token keyword">public</span> Long <span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserId</span><span class="token punctuation">(</span>Long userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> username<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span>String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> String <span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> nickname<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNickname</span><span class="token punctuation">(</span>String nickname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>nickname <span class="token operator">=</span> nickname<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Date <span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBirthday</span><span class="token punctuation">(</span>Date birthday<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>birthday <span class="token operator">=</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Integer <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span>Integer sex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> Integer <span class="token function">getEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> enabled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEnabled</span><span class="token punctuation">(</span>Integer enabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> enabled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>② 创建表结构</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">CREATE TABLE `sys_user` (  `USER_ID` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '表ID，主键，供其他表做外键',  `USERNAME` varchar(30) NOT NULL COMMENT '用户名',  `PASSWORD` varchar(100) NOT NULL COMMENT '密码',  `NICKNAME` varchar(30) NOT NULL COMMENT '用户名称',  `BIRTHDAY` date DEFAULT NULL COMMENT '生日',  `SEX` int(1) DEFAULT NULL COMMENT '性别：1-男；0-女',  `ENABLED` int(1) NOT NULL DEFAULT '1' COMMENT '启用标识：1/0',  `VERSION_NUMBER` int(11) NOT NULL DEFAULT '1' COMMENT '行版本号，用来处理锁',  `CREATE_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',  `CREATE_BY` bigint(11) NOT NULL DEFAULT '-1' COMMENT '创建人',  `UPDATE_BY` bigint(11) NOT NULL DEFAULT '-1' COMMENT '更新人',  `UPDATE_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',  `ATTRIBUTE1` varchar(150) DEFAULT NULL,  `ATTRIBUTE2` varchar(150) DEFAULT NULL,  `ATTRIBUTE3` varchar(150) DEFAULT NULL,  `ATTRIBUTE4` varchar(150) DEFAULT NULL,  `ATTRIBUTE5` varchar(150) DEFAULT NULL,  `ATTRIBUTE6` varchar(150) DEFAULT NULL,  `ATTRIBUTE7` varchar(150) DEFAULT NULL,  `ATTRIBUTE8` varchar(150) DEFAULT NULL,  `ATTRIBUTE9` varchar(150) DEFAULT NULL,  `ATTRIBUTE10` varchar(150) DEFAULT NULL,  PRIMARY KEY (`USER_ID`),  UNIQUE KEY `USERNAME` (`USERNAME`)) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 COMMENT='系统用户';</pre></td>

<p>CREATE TABLE <code class="java">
sys_user</code> (<br>  <code class="java">
USER_ID</code> bigint(20) NOT NULL AUTO_INCREMENT COMMENT ‘表ID，主键，供其他表做外键’,<br>  <code class="java">
USERNAME</code> varchar(30) NOT NULL COMMENT ‘用户名’,<br>  <code class="java">
PASSWORD</code> varchar(100) NOT NULL COMMENT ‘密码’,<br>  <code class="java">
NICKNAME</code> varchar(30) NOT NULL COMMENT ‘用户名称’,<br>  <code class="java">
BIRTHDAY</code> date DEFAULT NULL COMMENT ‘生日’,<br>  <code class="java">
SEX</code> int(1) DEFAULT NULL COMMENT ‘性别：1-男；0-女’,<br>  <code class="java">
ENABLED</code> int(1) NOT NULL DEFAULT ‘1’ COMMENT ‘启用标识：1&#x2F;0’,<br>  <code class="java">
VERSION_NUMBER</code> int(11) NOT NULL DEFAULT ‘1’ COMMENT ‘行版本号，用来处理锁’,<br>  <code class="java">
CREATE_DATE</code> datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT ‘创建时间’,<br>  <code class="java">
CREATE_BY</code> bigint(11) NOT NULL DEFAULT ‘-1’ COMMENT ‘创建人’,<br>  <code class="java">
UPDATE_BY</code> bigint(11) NOT NULL DEFAULT ‘-1’ COMMENT ‘更新人’,<br>  <code class="java">
UPDATE_DATE</code> datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT ‘更新时间’,<br>  <code class="java">
ATTRIBUTE1</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE2</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE3</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE4</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE5</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE6</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE7</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE8</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE9</code> varchar(150) DEFAULT NULL,<br>  <code class="java">
ATTRIBUTE10</code> varchar(150) DEFAULT NULL,<br>  PRIMARY KEY (<code class="java">
USER_ID</code>),<br>  UNIQUE KEY <code class="java">
USERNAME</code> (<code class="java">
USERNAME</code>)<br>) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;3 DEFAULT CHARSET&#x3D;utf8 COMMENT&#x3D;’系统用户’;</p>
<p> </p>
<p>③ 创建UserMapper</p>
<p>在system.mapper下创建UserMapper接口，继承MapperUser：</p>
<td class="line_numbers"><pre>1234567891011121314</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.mapper; import com.lyyzoo.core.base.Mapper;import com.lyyzoo.core.system.dto.User; /** * * @name UserMapper * @version 1.0 * @author bojiangzhou 2018-01-06 */public interface UserMapper extends MapperUser { }</pre></td>

<p>package com.lyyzoo.core.system.mapper;</p>
<p>import com.lyyzoo.core.base.Mapper;<br>import com.lyyzoo.core.system.dto.User;</p>
<p>&#x2F;**<br> *</p>
<ul>
<li>@name UserMapper</li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-06</li>
</ul>
<p> *&#x2F;<br>public interface UserMapper extends MapperUser {</p>
<p>}</p>
<p> </p>
<p>④ 创建UserService</p>
<p>在system.service下创建UserService接口，只需继承ServiceUser接口即可。</p>
<td class="line_numbers"><pre>1234567891011121314</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.service; import com.lyyzoo.core.base.Service;import com.lyyzoo.core.system.dto.User; /** * 用户Service接口 * * @version 1.0 * @author bojiangzhou 2018-01-06 */public interface UserService extends ServiceUser { }</pre></td>

<p>package com.lyyzoo.core.system.service;</p>
<p>import com.lyyzoo.core.base.Service;<br>import com.lyyzoo.core.system.dto.User;</p>
<p>&#x2F;**</p>
<ul>
<li>用户Service接口</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-06</li>
</ul>
<p> *&#x2F;<br>public interface UserService extends ServiceUser {</p>
<p>}</p>
<p> </p>
<p>在system.service.impl下创建UserServiceImpl实现类，继承BaseServiceUser类，实现UserService接口。同时加上@Service注解。</p>
<td class="line_numbers"><pre>123456789101112131415161718</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.service.impl; import org.springframework.stereotype.Service; import com.lyyzoo.core.base.BaseService;import com.lyyzoo.core.system.dto.User;import com.lyyzoo.core.system.service.UserService; /** * 用户Service实现类 * * @version 1.0 * @author bojiangzhou 2018-01-06 */@Servicepublic class UserServiceImpl extends BaseServiceUser implements UserService { }</pre></td>

<p>package com.lyyzoo.core.system.service.impl;</p>
<p>import org.springframework.stereotype.Service;</p>
<p>import com.lyyzoo.core.base.BaseService;<br>import com.lyyzoo.core.system.dto.User;<br>import com.lyyzoo.core.system.service.UserService;</p>
<p>&#x2F;**</p>
<ul>
<li>用户Service实现类</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-01-06</li>
</ul>
<p> *&#x2F;<br>@Service<br>public class UserServiceImpl extends BaseServiceUser implements UserService {</p>
<p>}</p>
<p> </p>
<p>⑤ 修改UserController，注入UserService，增加一些测试API</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.system.controller; import com.lyyzoo.core.base.BaseController;import com.lyyzoo.core.base.BaseEnums;import com.lyyzoo.core.base.Result;import com.lyyzoo.core.system.dto.User;import com.lyyzoo.core.system.service.UserService;import com.lyyzoo.core.util.Results;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*; import javax.validation.Valid;import java.util.List; /** * 用户Controller * * @version 1.0 * @author bojiangzhou 2017-12-31 */@RequestMapping@RestControllerpublic class UserController extends BaseController {     @Autowired    private UserService userService;      @PostMapping("/sys/user/queryAll")    public Result queryAll(){        ListUser list = userService.selectAll();        return Results.successWithData(list, BaseEnums.SUCCESS.code(), BaseEnums.SUCCESS.description());    }     @RequestMapping("/sys/user/queryOne/{userId}")    public Result queryOne(@PathVariable Long userId){        User user = userService.get(userId);        return Results.successWithData(user);    }     @PostMapping("/sys/user/save")    public Result save(@Valid @RequestBody User user){        user = userService.insertSelective(user);        return Results.successWithData(user);    }     @PostMapping("/sys/user/update")    public Result update(@Valid @RequestBody ListUser user){        user = userService.persistSelective(user);        return Results.successWithData(user);    }     @RequestMapping("/sys/user/delete")    public Result delete(User user){        userService.delete(user);        return Results.success();    }     @RequestMapping("/sys/user/delete/{userId}")    public Result delete(@PathVariable Long userId){        userService.delete(userId);        return Results.success();    } }</pre></td>

<p>package com.lyyzoo.core.system.controller;</p>
<p>import com.lyyzoo.core.base.BaseController;<br>import com.lyyzoo.core.base.BaseEnums;<br>import com.lyyzoo.core.base.Result;<br>import com.lyyzoo.core.system.dto.User;<br>import com.lyyzoo.core.system.service.UserService;<br>import com.lyyzoo.core.util.Results;<br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.web.bind.annotation.*;</p>
<p>import javax.validation.Valid;<br>import java.util.List;</p>
<p>&#x2F;**</p>
<ul>
<li>用户Controller</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2017-12-31</li>
</ul>
<p> *&#x2F;<br>@RequestMapping<br>@RestController<br>public class UserController extends BaseController {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> UserService userService<span class="token punctuation">;</span>


<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/queryAll"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">queryAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ListUser list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/queryOne/{userId}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">queryOne</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Long userId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    User user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/save"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> User user<span class="token punctuation">)</span><span class="token punctuation">{</span>
    user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">insertSelective</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/update"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> ListUser user<span class="token punctuation">)</span><span class="token punctuation">{</span>
    user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">persistSelective</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/delete"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">delete</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span><span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/user/delete/{userId}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Long userId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>⑥ 测试结果</p>
<p>查询所有：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934505.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>批量保存&#x2F;修改：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/9-1532934505.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="9、代码生成器"><a href="#9、代码生成器" class="headerlink" title="9、代码生成器"></a>9、代码生成器</h3><p>使用代码生成器来生成基础的代码结构，生成DTO、XML等等。</p>
<p>MyBatis官方提供了代码生成器MyBatis Generator，但一般需要定制化。</p>
<p>我这里从网上找了一个使用起来比较方便的界面工具，可生成DTO、Mapper、Mapper.xml，生成之后还需做一些小调整。另需要自己创建对应的Service、Controller。之后有时间再重新定制化一个符合本项目的代码生成器。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934506.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="828" height="576">

<p> </p>
<h2 id="四、日志及全局异常处理"><a href="#四、日志及全局异常处理" class="headerlink" title="四、日志及全局异常处理"></a>四、日志及全局异常处理</h2><p>在前面的测试中，会发现控制台输出的日志不怎么友好，有很多日志也没有输出，不便于查找排查问题。对于一个应用程序来说日志记录是必不可少的一部分。线上问题追踪，基于日志的业务逻辑统计分析等都离不日志。</p>
<p>先贴出一些参考资料：</p>
<h3 id="1、日志框架简介"><a href="#1、日志框架简介" class="headerlink" title="1、日志框架简介"></a>1、日志框架简介</h3><p>Java有很多常用的日志框架，如Log4j、Log4j 2、Commons Logging、Slf4j、Logback等。有时候你可能会感觉有点混乱，下面简单介绍下。</p>
<ul>
<li>Log4j：Apache Log4j是一个基于Java的日志记录工具，是Apache软件基金会的一个项目。</li>
<li>Log4j 2：Apache Log4j 2是apache开发的一款Log4j的升级产品。</li>
<li>Commons Logging：Apache基金会所属的项目，是一套Java日志接口。</li>
<li>Slf4j：类似于Commons Logging，是一套简易Java日志门面，本身并无日志的实现。（Simple Logging Facade for Java，缩写Slf4j）。</li>
<li>Logback：一套日志组件的实现(slf4j阵营)。</li>
</ul>
<p>Commons Logging和Slf4j是日志门面，提供一个统一的高层接口，为各种loging API提供一个简单统一的接口。log4j和Logback则是具体的日志实现方案。可以简单的理解为接口与接口的实现，调用者只需要关注接口而无需关注具体的实现，做到解耦。</p>
<p>比较常用的组合使用方式是Slf4j与Logback组合使用，Commons Logging与Log4j组合使用。</p>
<p>基于下面的一些优点，选用Slf4j+Logback的日志框架：</p>
<ul>
<li>更快的执行速度，Logback重写了内部的实现，在一些关键执行路径上性能提升10倍以上。而且logback不仅性能提升了，初始化内存加载也更小了</li>
<li>自动清除旧的日志归档文件，通过设置TimeBasedRollingPolicy 或者 SizeAndTimeBasedFNATP的 maxHistory 属性，你就可以控制日志归档文件的最大数量</li>
<li>Logback拥有远比log4j更丰富的过滤能力，可以不用降低日志级别而记录低级别中的日志。</li>
<li>Logback必须配合Slf4j使用。由于Logback和Slf4j是同一个作者，其兼容性不言而喻。</li>
<li>默认情况下，Spring Boot会用Logback来记录日志，并用INFO级别输出到控制台。</li>
</ul>
<h3 id="2、配置日志"><a href="#2、配置日志" class="headerlink" title="2、配置日志"></a>2、配置日志</h3><p>可以看到，只要集成了spring-boot-starter-web，就引入了spring-boot-starter-logging，即slf4j和logback。</p>
<p>其它的几个包：jcl-over-slf4j，代码直接调用common-logging会被桥接到slf4j；jul-to-slf4j，代码直接调用java.util.logging会被桥接到slf4j；log4j-over-slf4j，代码直接调用log4j会被桥接到slf4j。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934506-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>还需引入janino，如果不加入这个包会报错。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934506.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>在resources下添加logback.xml配置文件，Logback默认会查找classpath下的logback.xml文件。</p>
<p>具体配置如下，有较详细的注释，很容易看懂。可以通过application.properties配置日志记录级别、日志输出文件目录等。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">?xml version="1.0" encoding="UTF-8"? !-- 级别从高到低 OFF 、 FATAL 、 ERROR 、 WARN 、 INFO 、 DEBUG 、 TRACE 、 ALL --!-- 日志输出规则 根据当前ROOT 级别，日志输出时，级别高于root默认的级别时 会输出 --!-- 以下 每个配置的 filter 是过滤掉输出文件里面，会出现高级别文件，依然出现低级别的日志信息，通过filter 过滤只记录本级别的日志 --!-- scan 当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。 --!-- scanPeriod 设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。 --!-- debug 当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。 --configuration debug="false" scan="false" scanPeriod="5 minutes"     !-- 引入配置文件 --    property resource="application.properties"/    property resource="application-${app.env:-dev}.properties"/     property name="app.name" value="${app.name:-sunny}"/    property name="app.env" value="${app.env:-dev}"/     !-- 日志记录级别 --    property name="logback_level" value="${logback.level:-DEBUG}"/    !-- 是否输出日志到文件 --    property name="logback_rolling" value="${logback.rolling:-false}"/    !-- 设置日志输出目录 --    property name="logback_rolling_path" value="${logback.rolling.path:-/data/logs}"/    !-- 日志文件最大大小 --    property name="logback_max_file_size" value="${logback.max_file_size:-10MB}"/    !-- 格式化输出：%d：表示日期，%thread：表示线程名，%-5level：级别从左显示5个字符宽度，%logger：日志输出者的名字(通常是所在类的全名)，%L：输出代码中的行号，%msg：日志消息，%n：换行符 --    property name="logback_pattern" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger %L  -| %msg%n"/      if condition='p("logback_rolling").equals("true")'        then            !-- 滚动记录文件 --            appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"                file${logback_rolling_path}/${app.name}.log/file                !-- rollingPolicy：当发生滚动时，决定RollingFileAppender的行为，涉及文件移动和重命名 --                !-- TimeBasedRollingPolicy：最常用的滚动策略，它根据时间来制定滚动策略 --                rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"                    !-- 活动文件的名字会根据fileNamePattern的值，每隔一段时间改变一次 --                    fileNamePattern${logback_rolling_path}/${app.name}.%d{yyyy-MM-dd}.%i.log/fileNamePattern                     !-- 日志文件的保存期限为30天 --                    maxHistory30/maxHistory                     timeBasedFileNamingAndTriggeringPolicy  class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"                        !-- maxFileSize:这是活动文件的大小，默认值是10MB --                        maxFileSize${logback_max_file_size}/maxFileSize                    /timeBasedFileNamingAndTriggeringPolicy                /rollingPolicy                encoder                    pattern${logback_pattern}/pattern                    charsetUTF-8/charset                /encoder            /appender             root                appender-ref ref="FILE"/            /root        /then    /if      !-- 将日志打印到控制台 --    appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender"        encoder            pattern${logback_pattern}/pattern        /encoder    /appender     root level="${logback_level}"        appender-ref ref="CONSOLE"/    /root     contextName${app.name}/contextName /configuration</pre></td>

<p>?xml version&#x3D;”1.0” encoding&#x3D;”UTF-8”?</p>
<p>!– 级别从高到低 OFF 、 FATAL 、 ERROR 、 WARN 、 INFO 、 DEBUG 、 TRACE 、 ALL –<br>!– 日志输出规则 根据当前ROOT 级别，日志输出时，级别高于root默认的级别时 会输出 –<br>!– 以下 每个配置的 filter 是过滤掉输出文件里面，会出现高级别文件，依然出现低级别的日志信息，通过filter 过滤只记录本级别的日志 –<br>!– scan 当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。 –<br>!– scanPeriod 设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。 –<br>!– debug 当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。 –<br>configuration debug&#x3D;”false” scan&#x3D;”false” scanPeriod&#x3D;”5 minutes”</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token operator">!</span><span class="token operator">--</span> 引入配置文件 <span class="token operator">--</span>
property resource<span class="token operator">=</span><span class="token string">"application.properties"</span><span class="token operator">/</span>
property resource<span class="token operator">=</span><span class="token string">"application-${app.env:-dev}.properties"</span><span class="token operator">/</span>

property name<span class="token operator">=</span><span class="token string">"app.name"</span> value<span class="token operator">=</span><span class="token string">"${app.name:-sunny}"</span><span class="token operator">/</span>
property name<span class="token operator">=</span><span class="token string">"app.env"</span> value<span class="token operator">=</span><span class="token string">"${app.env:-dev}"</span><span class="token operator">/</span>

<span class="token operator">!</span><span class="token operator">--</span> 日志记录级别 <span class="token operator">--</span>
property name<span class="token operator">=</span><span class="token string">"logback_level"</span> value<span class="token operator">=</span><span class="token string">"${logback.level:-DEBUG}"</span><span class="token operator">/</span>
<span class="token operator">!</span><span class="token operator">--</span> 是否输出日志到文件 <span class="token operator">--</span>
property name<span class="token operator">=</span><span class="token string">"logback_rolling"</span> value<span class="token operator">=</span><span class="token string">"${logback.rolling:-false}"</span><span class="token operator">/</span>
<span class="token operator">!</span><span class="token operator">--</span> 设置日志输出目录 <span class="token operator">--</span>
property name<span class="token operator">=</span><span class="token string">"logback_rolling_path"</span> value<span class="token operator">=</span><span class="token string">"${logback.rolling.path:-/data/logs}"</span><span class="token operator">/</span>
<span class="token operator">!</span><span class="token operator">--</span> 日志文件最大大小 <span class="token operator">--</span>
property name<span class="token operator">=</span><span class="token string">"logback_max_file_size"</span> value<span class="token operator">=</span><span class="token string">"${logback.max_file_size:-10MB}"</span><span class="token operator">/</span>
<span class="token operator">!</span><span class="token operator">--</span> 格式化输出：<span class="token operator">%</span>d：表示日期，<span class="token operator">%</span>thread：表示线程名，<span class="token operator">%</span><span class="token operator">-</span>5level：级别从左显示<span class="token number">5</span>个字符宽度，<span class="token operator">%</span>logger：日志输出者的名字<span class="token punctuation">(</span>通常是所在类的全名<span class="token punctuation">)</span>，<span class="token operator">%</span>L：输出代码中的行号，<span class="token operator">%</span>msg：日志消息，<span class="token operator">%</span>n：换行符 <span class="token operator">--</span>
property name<span class="token operator">=</span><span class="token string">"logback_pattern"</span> value<span class="token operator">=</span><span class="token string">"%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger %L  -| %msg%n"</span><span class="token operator">/</span>


<span class="token keyword">if</span> condition<span class="token operator">=</span><span class="token string">'p("logback_rolling").equals("true")'</span>
    then
        <span class="token operator">!</span><span class="token operator">--</span> 滚动记录文件 <span class="token operator">--</span>
        appender name<span class="token operator">=</span><span class="token string">"FILE"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>
            file$<span class="token punctuation">{</span>logback_rolling_path<span class="token punctuation">}</span><span class="token operator">/</span>$<span class="token punctuation">{</span>app<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">.</span>log<span class="token operator">/</span>file
            <span class="token operator">!</span><span class="token operator">--</span> rollingPolicy：当发生滚动时，决定RollingFileAppender的行为，涉及文件移动和重命名 <span class="token operator">--</span>
            <span class="token operator">!</span><span class="token operator">--</span> TimeBasedRollingPolicy：最常用的滚动策略，它根据时间来制定滚动策略 <span class="token operator">--</span>
            rollingPolicy <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>
                <span class="token operator">!</span><span class="token operator">--</span> 活动文件的名字会根据fileNamePattern的值，每隔一段时间改变一次 <span class="token operator">--</span>
                fileNamePattern$<span class="token punctuation">{</span>logback_rolling_path<span class="token punctuation">}</span><span class="token operator">/</span>$<span class="token punctuation">{</span>app<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">.</span>%d<span class="token punctuation">{</span>yyyy<span class="token operator">-</span>MM<span class="token operator">-</span>dd<span class="token punctuation">}</span><span class="token punctuation">.</span>%i<span class="token punctuation">.</span>log<span class="token operator">/</span>fileNamePattern

                <span class="token operator">!</span><span class="token operator">--</span> 日志文件的保存期限为<span class="token number">30</span>天 <span class="token operator">--</span>
                maxHistory30<span class="token operator">/</span>maxHistory

                timeBasedFileNamingAndTriggeringPolicy  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>
                    <span class="token operator">!</span><span class="token operator">--</span> maxFileSize<span class="token operator">:</span>这是活动文件的大小，默认值是10MB <span class="token operator">--</span>
                    maxFileSize$<span class="token punctuation">{</span>logback_max_file_size<span class="token punctuation">}</span><span class="token operator">/</span>maxFileSize
                <span class="token operator">/</span>timeBasedFileNamingAndTriggeringPolicy
            <span class="token operator">/</span>rollingPolicy
            encoder
                pattern$<span class="token punctuation">{</span>logback_pattern<span class="token punctuation">}</span><span class="token operator">/</span>pattern
                charsetUTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>charset
            <span class="token operator">/</span>encoder
        <span class="token operator">/</span>appender

        root
            appender<span class="token operator">-</span>ref ref<span class="token operator">=</span><span class="token string">"FILE"</span><span class="token operator">/</span>
        <span class="token operator">/</span>root
    <span class="token operator">/</span>then
<span class="token operator">/</span><span class="token keyword">if</span>


<span class="token operator">!</span><span class="token operator">--</span> 将日志打印到控制台 <span class="token operator">--</span>
appender name<span class="token operator">=</span><span class="token string">"CONSOLE"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.ConsoleAppender"</span>
    encoder
        pattern$<span class="token punctuation">{</span>logback_pattern<span class="token punctuation">}</span><span class="token operator">/</span>pattern
    <span class="token operator">/</span>encoder
<span class="token operator">/</span>appender

root level<span class="token operator">=</span><span class="token string">"${logback_level}"</span>
    appender<span class="token operator">-</span>ref ref<span class="token operator">=</span><span class="token string">"CONSOLE"</span><span class="token operator">/</span>
<span class="token operator">/</span>root

contextName$<span class="token punctuation">{</span>app<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">/</span>contextName
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x2F;configuration</p>
<p> </p>
<p>加入配置文件后，就可以看到控制台格式化后的日志输出，还可以看到具体代码行数等，比之前的友好多了。</p>
<p>同时，将日志滚动输出到日志文件，保留历史记录。可通过logback.rolling&#x3D;false控制是否需要输出日志到文件。</p>
<h3 id="3、使用Logger"><a href="#3、使用Logger" class="headerlink" title="3、使用Logger"></a>3、使用Logger</h3><p>配置好之后，就可以使用Logger来输出日志了，使用起来也是非常方便。</p>
<ul>
<li><p>可以看到引入的包是slf4j.Logger，代码里并没有引用任何一个跟 Logback 相关的类，这便是使用 Slf4j的好处，在需要将日志框架切换为其它日志框架时，无需改动已有的代码。</p>
</li>
<li><p>LoggerFactory 的 getLogger() 方法接收一个参数，以这个参数决定 logger 的名字，比如第二图中的日志输出。在为 logger 命名时，用类的全限定类名作为 logger name 是最好的策略，这样能够追踪到每一条日志消息的来源</p>
</li>
<li><p>可以看到，可以通过提供占位符，以参数化的方式打印日志，避免字符串拼接的不必要损耗，也无需通过logger.isDebugEnabled()这种方式判断是否需要打印。</p>
</li>
</ul>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934506-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="1130" height="586">

<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/1-1532934507.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="4、全局异常处理"><a href="#4、全局异常处理" class="headerlink" title="4、全局异常处理"></a>4、全局异常处理</h3><p>现在有一个问题，当日志级别设置到INFO级别后，只会输出INFO以上的日志，如INFO、WARN、ERROR，这没毛病，问题是，程序中抛出的异常堆栈(运行时异常)都没有打印了，不利于排查问题。</p>
<p>而且，在某些情况下，我们在Service中想直接把异常往Controller抛出不做处理，但我们不能直接把异常信息输出到客户端，这是非常不友好的。</p>
<p>所以，在config下建一个GlobalExceptionConfig作为全局统一异常处理。主要处理了自定义的ServiceException、AuthorityException、BaseException，以及系统的NoHandlerFoundException和Exception异常。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.config; import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.http.HttpStatus;import org.springframework.web.bind.annotation.ExceptionHandler;import org.springframework.web.bind.annotation.RestControllerAdvice;import org.springframework.web.servlet.NoHandlerFoundException; import com.lyyzoo.core.base.Result;import com.lyyzoo.core.constants.BaseEnums;import com.lyyzoo.core.exception.AuthorityException;import com.lyyzoo.core.exception.BaseException;import com.lyyzoo.core.exception.ServiceException;import com.lyyzoo.core.util.Results; /** * 全局异常处理 * * @author bojiangzhou 2018-02-06 * @version 1.0 */@RestControllerAdvicepublic class GlobalExceptionConfig {     private static final Logger logger = LoggerFactory.getLogger(GlobalExceptionConfig.class);     /**     * 处理 ServiceException 异常     */    @ExceptionHandler(ServiceException.class)    public Result handleServiceException(ServiceException e){        Result result = Results.failure(e.getCode(), e.getMessage());        result.setStatus(HttpStatus.BAD_REQUEST.value());        logger.info("ServiceException[code: {}, message: {}]", e.getCode(), e.getMessage());        return result;    }     /**     * 处理 AuthorityException 异常     */    @ExceptionHandler(AuthorityException.class)    public Result handleAuthorityException(AuthorityException e){        Result result = Results.failure(BaseEnums.FORBIDDEN.code(), BaseEnums.FORBIDDEN.desc());        result.setStatus(HttpStatus.FORBIDDEN.value());        logger.info("AuthorityException[code: {}, message: {}]", e.getCode(), e.getMessage());        return result;    }     /**     * 处理 NoHandlerFoundException 异常. br/     * 需配置 [spring.mvc.throw-exception-if-no-handler-found=true]     * 需配置 [spring.resources.add-mappings=false]     */    @ExceptionHandler(NoHandlerFoundException.class)    public Result handleNotFoundException(NoHandlerFoundException e){        Result result = Results.failure(BaseEnums.NOT_FOUND.code(), BaseEnums.NOT_FOUND.desc());        result.setStatus(HttpStatus.NOT_FOUND.value());        logger.info(e.getMessage());        return result;    }     /**     * 处理 BaseException 异常     */    @ExceptionHandler(BaseException.class)    public Result handleBaseException(BaseException e){        Result result = Results.failure(e.getCode(), e.getMessage());        result.setStatus(HttpStatus.INTERNAL_SERVER_ERROR.value());        logger.error("BaseException[code: {}, message: {}]", e.getCode(), e.getMessage(), e);        return result;    }     /**     * 处理 Exception 异常     */    @ExceptionHandler(Exception.class)    public Result handleException(Exception e){        Result result = Results.failure(BaseEnums.ERROR.code(), BaseEnums.ERROR.desc());        result.setStatus(HttpStatus.INTERNAL_SERVER_ERROR.value());        logger.error(e.getMessage(), e);        return result;    } }</pre></td>

<p>package com.lyyzoo.core.config;</p>
<p>import org.slf4j.Logger;<br>import org.slf4j.LoggerFactory;<br>import org.springframework.http.HttpStatus;<br>import org.springframework.web.bind.annotation.ExceptionHandler;<br>import org.springframework.web.bind.annotation.RestControllerAdvice;<br>import org.springframework.web.servlet.NoHandlerFoundException;</p>
<p>import com.lyyzoo.core.base.Result;<br>import com.lyyzoo.core.constants.BaseEnums;<br>import com.lyyzoo.core.exception.AuthorityException;<br>import com.lyyzoo.core.exception.BaseException;<br>import com.lyyzoo.core.exception.ServiceException;<br>import com.lyyzoo.core.util.Results;</p>
<p>&#x2F;**</p>
<ul>
<li>全局异常处理</li>
<li></li>
<li>@author bojiangzhou 2018-02-06</li>
<li>@version 1.0</li>
</ul>
<p> *&#x2F;<br>@RestControllerAdvice<br>public class GlobalExceptionConfig {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger logger <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>GlobalExceptionConfig<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 处理 ServiceException 异常
 */</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>ServiceException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">handleServiceException</span><span class="token punctuation">(</span>ServiceException e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Result result <span class="token operator">=</span> Results<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>BAD_REQUEST<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ServiceException[code: {}, message: {}]"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 处理 AuthorityException 异常
 */</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>AuthorityException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">handleAuthorityException</span><span class="token punctuation">(</span>AuthorityException e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Result result <span class="token operator">=</span> Results<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>BaseEnums<span class="token punctuation">.</span>FORBIDDEN<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>FORBIDDEN<span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>FORBIDDEN<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"AuthorityException[code: {}, message: {}]"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 处理 NoHandlerFoundException 异常. br/
 * 需配置 [spring.mvc.throw-exception-if-no-handler-found=true]
 * 需配置 [spring.resources.add-mappings=false]
 */</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>NoHandlerFoundException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">handleNotFoundException</span><span class="token punctuation">(</span>NoHandlerFoundException e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Result result <span class="token operator">=</span> Results<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>BaseEnums<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 处理 BaseException 异常
 */</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>BaseException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">handleBaseException</span><span class="token punctuation">(</span>BaseException e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Result result <span class="token operator">=</span> Results<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>INTERNAL_SERVER_ERROR<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"BaseException[code: {}, message: {}]"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 处理 Exception 异常
 */</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>Exception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">handleException</span><span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Result result <span class="token operator">=</span> Results<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>BaseEnums<span class="token punctuation">.</span>ERROR<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BaseEnums<span class="token punctuation">.</span>ERROR<span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>INTERNAL_SERVER_ERROR<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>看上面的代码，@ControllAdvice(@RestControllerAdvice可以返回ResponseBody)，可看做Controller增强器，可以在@ControllerAdvice作用类下添加@ExceptionHandler，@InitBinder，@ModelAttribute注解的方法来增强Controller，都会作用在被 @RequestMapping 注解的方法上。</p>
<p>使用@ExceptionHandler 拦截异常，我们可以通过该注解实现自定义异常处理。在每个处理方法中，封装Result，返回对应的消息及状态码等。</p>
<p>通过Logger打印对应级别的日志，也可以看到控制台及日志文件中有异常堆栈的输出了。注意除了BaseException、Exception，其它的都只是打印了简单信息，且为INFO级别。Exception是ERROR级别，且打印了堆栈信息。</p>
<p>NoHandlerFoundException 是404异常，这里注意要先关闭DispatcherServlet的NotFound默认异常处理。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934507.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>测试如下：这种返回结果就比较友好了。</p>
<p><img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934507.png" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">    <img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934508.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构"></p>
<p> </p>
<h2 id="五、数据库乐观锁"><a href="#五、数据库乐观锁" class="headerlink" title="五、数据库乐观锁"></a>五、数据库乐观锁</h2><h3 id="1、乐观锁"><a href="#1、乐观锁" class="headerlink" title="1、乐观锁"></a>1、乐观锁</h3><p>在并发修改同一条记录时，为避免更新丢失，需要加锁。要么在应用层加锁，要么在缓存层加锁，要么在数据库层使用乐观锁，使用version作为更新依据【强制】。 —— 《阿里巴巴Java开发手册》</p>
<p>乐观锁，基于数据版本(version)记录机制实现，为数据库表增加一个”version”字段。读取出数据时，将此版本号一同读出，之后更新时，对此版本号加一。提交数据时，提交的版本数据与数据库表对应记录的当前版本信息进行比对，如果提交的数据版本号大于数据库表当前版本号，则予以更新，否则认为是过期数据。</p>
<p>因此，这节就来处理BaseDTO中的”version”字段，通过增加一个mybatis插件来实现更新时版本号自动+1。</p>
<h3 id="2、MyBatis插件介绍"><a href="#2、MyBatis插件介绍" class="headerlink" title="2、MyBatis插件介绍"></a>2、MyBatis插件介绍</h3><p>MyBatis 允许在己映射语句执行过程中的某一点进行拦截调用。默认情况下， MyBatis 允许使用插件来拦截的接口和方法包括以下几个：</p>
<ul>
<li>Executor (update 、query 、flushStatements 、commit 、rollback 、getTransaction 、close 、isClosed)</li>
<li>ParameterHandler (getParameterObject 、setParameters)</li>
<li>ResultSetHandler (handleResul tSets 、handleCursorResultSets、handleOutputParameters)<li>StatementHandler (prepare 、parameterize 、batch update 、query)</li>
</ul>
</li>

<p>MyBatis 插件实现拦截器接口Interceptor，在实现类中对拦截对象和方法进行处理 。</p>
<ul>
<li>setProperties：传递插件的参数，可以通过参数来改变插件的行为。</li>
<li>plugin：参数 target 就是要拦截的对象，作用就是给被拦截对象生成一个代理对象，并返回。</li>
<li>intercept：会覆盖所拦截对象的原方法，Invocation参数可以反射调度原来对象的方法，可以获取到很多有用的东西。</li>
</ul>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934508.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>除了需要实现拦截器接口外，还需要给实现类配置拦截器签名。 使用 @Intercepts 和 @Signature 这两个注解来配置拦截器要拦截的接口的方法，接口方法对应的签名基本都是固定的。 </p>
<p>@Intercepts 注解的属性是一个 ＠Signature  数组，可以在同 一个拦截器中同时拦截不同的接口和方法。 </p>
<p>@Signature 注解包含以下三个属性。</p>
<ul>
<li>type：设置拦截的接口，可选值是前面提到的4个接口 。</li>
<li>method：设置拦截接口中的方法名，可选值是前面4个接口对应的方法，需要和接口匹配 。<li>args：设置拦截方法的参数类型数组，通过方法名和参数类型可以确定唯一一个方法 。</li>
</ul>
</li>

<h3 id="3、数据版本插件"><a href="#3、数据版本插件" class="headerlink" title="3、数据版本插件"></a>3、数据版本插件</h3><p>要实现版本号自动更新，我们需要在SQL被执行前修改SQL，因此我们需要拦截的就是 StatementHandler  接口的 prepare 方法，该方法会在数据库执行前被调用，优先于当前接口的其它方法而被执行。</p>
<p>在 core.plugin 包下新建一个VersionPlugin插件，实现Interceptor拦截器接口。</p>
<p>该接口方法签名如下：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934508.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>在 interceptor 方法中对 UPDATE 类型的操作，修改原SQL，加入version，修改后的SQL类似下图，更新时就会自动将version+1。同时带上version条件，如果该版本号小于数据库记录版本号，则不会更新。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934508-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>VersionInterceptor插件：</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.core.plugins; import net.sf.jsqlparser.expression.Expression;import net.sf.jsqlparser.expression.LongValue;import net.sf.jsqlparser.expression.operators.arithmetic.Addition;import net.sf.jsqlparser.expression.operators.conditional.AndExpression;import net.sf.jsqlparser.expression.operators.relational.EqualsTo;import net.sf.jsqlparser.parser.CCJSqlParserUtil;import net.sf.jsqlparser.schema.Column;import net.sf.jsqlparser.statement.Statement;import net.sf.jsqlparser.statement.update.Update;import org.apache.ibatis.executor.statement.StatementHandler;import org.apache.ibatis.mapping.BoundSql;import org.apache.ibatis.mapping.MappedStatement;import org.apache.ibatis.mapping.SqlCommandType;import org.apache.ibatis.plugin.*;import org.apache.ibatis.reflection.MetaObject;import org.apache.ibatis.reflection.SystemMetaObject;import org.slf4j.Logger;import org.slf4j.LoggerFactory; import java.lang.reflect.Proxy;import java.sql.Connection;import java.util.List;import java.util.Properties; /** * 乐观锁：数据版本插件 * * @version 1.0 * @author bojiangzhou 2018-02-10 */@Intercepts(    @Signature(        type = StatementHandler.class,        method = "prepare",        args = {Connection.class, Integer.class}    ))public class VersionInterceptor implements Interceptor {     private static final String VERSION_COLUMN_NAME = "version";     private static final Logger logger = LoggerFactory.getLogger(VersionInterceptor.class);     @Override    public Object intercept(Invocation invocation) throws Throwable {        // 获取 StatementHandler，实际是 RoutingStatementHandler        StatementHandler handler = (StatementHandler) processTarget(invocation.getTarget());        // 包装原始对象，便于获取和设置属性        MetaObject metaObject = SystemMetaObject.forObject(handler);        // MappedStatement 是对SQL更高层次的一个封装，这个对象包含了执行SQL所需的各种配置信息        MappedStatement ms = (MappedStatement) metaObject.getValue("delegate.mappedStatement");        // SQL类型        SqlCommandType sqlType = ms.getSqlCommandType();        if(sqlType != SqlCommandType.UPDATE) {            return invocation.proceed();        }        // 获取版本号        Object originalVersion = metaObject.getValue("delegate.boundSql.parameterObject." + VERSION_COLUMN_NAME);        if(originalVersion == null || Long.valueOf(originalVersion.toString()) = 0){            return invocation.proceed();        }        // 获取绑定的SQL        BoundSql boundSql = (BoundSql) metaObject.getValue("delegate.boundSql");        // 原始SQL        String originalSql = boundSql.getSql();        // 加入version的SQL        originalSql = addVersionToSql(originalSql, originalVersion);        // 修改 BoundSql        metaObject.setValue("delegate.boundSql.sql", originalSql);         // proceed() 可以执行被拦截对象真正的方法，该方法实际上执行了method.invoke(target, args)方法        return invocation.proceed();    }     /**     * Plugin.wrap 方法会自动判断拦截器的签名和被拦截对象的接口是否匹配，只有匹配的情况下才会使用动态代理拦截目标对象.     *     * @param target 被拦截的对象     * @return 代理对象     */    @Override    public Object plugin(Object target) {        return Plugin.wrap(target, this);    }     /**     * 设置参数     */    @Override    public void setProperties(Properties properties) {     }     /**     * 获取代理的原始对象     *     * @param target     * @return     */    private static Object processTarget(Object target) {        if(Proxy.isProxyClass(target.getClass())) {            MetaObject mo = SystemMetaObject.forObject(target);            return processTarget(mo.getValue("h.target"));        }        return target;    }     /**     * 为原SQL添加version     *     * @param originalSql 原SQL     * @param originalVersion 原版本号     * @return 加入version的SQL     */    private String addVersionToSql(String originalSql, Object originalVersion){        try{            Statement stmt = CCJSqlParserUtil.parse(originalSql);            if(!(stmt instanceof Update)){                return originalSql;            }            Update update = (Update)stmt;            if(!contains(update)){                buildVersionExpression(update);            }            Expression where = update.getWhere();            if(where != null){                AndExpression and = new AndExpression(where, buildVersionEquals(originalVersion));                update.setWhere(and);            }else{                update.setWhere(buildVersionEquals(originalVersion));            }            return stmt.toString();        }catch(Exception e){            logger.error(e.getMessage(), e);            return originalSql;        }    }     private boolean contains(Update update){        ListColumn columns = update.getColumns();        for(Column column : columns){            if(column.getColumnName().equalsIgnoreCase(VERSION_COLUMN_NAME)){                return true;            }        }        return false;    }     private void buildVersionExpression(Update update){        // 列 version        Column versionColumn = new Column();        versionColumn.setColumnName(VERSION_COLUMN_NAME);        update.getColumns().add(versionColumn);         // 值 version+1        Addition add = new Addition();        add.setLeftExpression(versionColumn);        add.setRightExpression(new LongValue(1));        update.getExpressions().add(add);    }     private Expression buildVersionEquals(Object originalVersion){        Column column = new Column();        column.setColumnName(VERSION_COLUMN_NAME);         // 条件 version = originalVersion        EqualsTo equal = new EqualsTo();        equal.setLeftExpression(column);        equal.setRightExpression(new LongValue(originalVersion.toString()));        return equal;    } }</pre></td>

<p>package com.lyyzoo.core.plugins;</p>
<p>import net.sf.jsqlparser.expression.Expression;<br>import net.sf.jsqlparser.expression.LongValue;<br>import net.sf.jsqlparser.expression.operators.arithmetic.Addition;<br>import net.sf.jsqlparser.expression.operators.conditional.AndExpression;<br>import net.sf.jsqlparser.expression.operators.relational.EqualsTo;<br>import net.sf.jsqlparser.parser.CCJSqlParserUtil;<br>import net.sf.jsqlparser.schema.Column;<br>import net.sf.jsqlparser.statement.Statement;<br>import net.sf.jsqlparser.statement.update.Update;<br>import org.apache.ibatis.executor.statement.StatementHandler;<br>import org.apache.ibatis.mapping.BoundSql;<br>import org.apache.ibatis.mapping.MappedStatement;<br>import org.apache.ibatis.mapping.SqlCommandType;<br>import org.apache.ibatis.plugin.*;<br>import org.apache.ibatis.reflection.MetaObject;<br>import org.apache.ibatis.reflection.SystemMetaObject;<br>import org.slf4j.Logger;<br>import org.slf4j.LoggerFactory;</p>
<p>import java.lang.reflect.Proxy;<br>import java.sql.Connection;<br>import java.util.List;<br>import java.util.Properties;</p>
<p>&#x2F;**</p>
<ul>
<li>乐观锁：数据版本插件</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-02-10</li>
</ul>
<p> *&#x2F;<br>@Intercepts(<br>    @Signature(<br>        type &#x3D; StatementHandler.class,<br>        method &#x3D; “prepare”,<br>        args &#x3D; {Connection.class, Integer.class}<br>    )<br>)<br>public class VersionInterceptor implements Interceptor {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String VERSION_COLUMN_NAME <span class="token operator">=</span> <span class="token string">"version"</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger logger <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>VersionInterceptor<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> Object <span class="token function">intercept</span><span class="token punctuation">(</span>Invocation invocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 获取 StatementHandler，实际是 RoutingStatementHandler</span>
    StatementHandler handler <span class="token operator">=</span> <span class="token punctuation">(</span>StatementHandler<span class="token punctuation">)</span> <span class="token function">processTarget</span><span class="token punctuation">(</span>invocation<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 包装原始对象，便于获取和设置属性</span>
    MetaObject metaObject <span class="token operator">=</span> SystemMetaObject<span class="token punctuation">.</span><span class="token function">forObject</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// MappedStatement 是对SQL更高层次的一个封装，这个对象包含了执行SQL所需的各种配置信息</span>
    MappedStatement ms <span class="token operator">=</span> <span class="token punctuation">(</span>MappedStatement<span class="token punctuation">)</span> metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">"delegate.mappedStatement"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// SQL类型</span>
    SqlCommandType sqlType <span class="token operator">=</span> ms<span class="token punctuation">.</span><span class="token function">getSqlCommandType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>sqlType <span class="token operator">!=</span> SqlCommandType<span class="token punctuation">.</span>UPDATE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// 获取版本号</span>
    Object originalVersion <span class="token operator">=</span> metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">"delegate.boundSql.parameterObject."</span> <span class="token operator">+</span> VERSION_COLUMN_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originalVersion <span class="token operator">==</span> null <span class="token operator">||</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>originalVersion<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// 获取绑定的SQL</span>
    BoundSql boundSql <span class="token operator">=</span> <span class="token punctuation">(</span>BoundSql<span class="token punctuation">)</span> metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">"delegate.boundSql"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 原始SQL</span>
    String originalSql <span class="token operator">=</span> boundSql<span class="token punctuation">.</span><span class="token function">getSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 加入version的SQL</span>
    originalSql <span class="token operator">=</span> <span class="token function">addVersionToSql</span><span class="token punctuation">(</span>originalSql<span class="token punctuation">,</span> originalVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 修改 BoundSql</span>
    metaObject<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">"delegate.boundSql.sql"</span><span class="token punctuation">,</span> originalSql<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// proceed() 可以执行被拦截对象真正的方法，该方法实际上执行了method.invoke(target, args)方法</span>
    <span class="token keyword">return</span> invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * Plugin.wrap 方法会自动判断拦截器的签名和被拦截对象的接口是否匹配，只有匹配的情况下才会使用动态代理拦截目标对象.
 *
 * @param target 被拦截的对象
 * @return 代理对象
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> Object <span class="token function">plugin</span><span class="token punctuation">(</span>Object target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Plugin<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 设置参数
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setProperties</span><span class="token punctuation">(</span>Properties properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 获取代理的原始对象
 *
 * @param target
 * @return
 */</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> Object <span class="token function">processTarget</span><span class="token punctuation">(</span>Object target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Proxy<span class="token punctuation">.</span><span class="token function">isProxyClass</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MetaObject mo <span class="token operator">=</span> SystemMetaObject<span class="token punctuation">.</span><span class="token function">forObject</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">processTarget</span><span class="token punctuation">(</span>mo<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">"h.target"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 为原SQL添加version
 *
 * @param originalSql 原SQL
 * @param originalVersion 原版本号
 * @return 加入version的SQL
 */</span>
<span class="token keyword">private</span> String <span class="token function">addVersionToSql</span><span class="token punctuation">(</span>String originalSql<span class="token punctuation">,</span> Object originalVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
        Statement stmt <span class="token operator">=</span> CCJSqlParserUtil<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>originalSql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>stmt <span class="token keyword">instanceof</span> <span class="token class-name">Update</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> originalSql<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Update update <span class="token operator">=</span> <span class="token punctuation">(</span>Update<span class="token punctuation">)</span>stmt<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">contains</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">buildVersionExpression</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Expression where <span class="token operator">=</span> update<span class="token punctuation">.</span><span class="token function">getWhere</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>where <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            AndExpression and <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AndExpression</span><span class="token punctuation">(</span>where<span class="token punctuation">,</span> <span class="token function">buildVersionEquals</span><span class="token punctuation">(</span>originalVersion<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            update<span class="token punctuation">.</span><span class="token function">setWhere</span><span class="token punctuation">(</span>and<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            update<span class="token punctuation">.</span><span class="token function">setWhere</span><span class="token punctuation">(</span><span class="token function">buildVersionEquals</span><span class="token punctuation">(</span>originalVersion<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> stmt<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> originalSql<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span>Update update<span class="token punctuation">)</span><span class="token punctuation">{</span>
    ListColumn columns <span class="token operator">=</span> update<span class="token punctuation">.</span><span class="token function">getColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>Column column <span class="token operator">:</span> columns<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>VERSION_COLUMN_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">buildVersionExpression</span><span class="token punctuation">(</span>Update update<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 列 version</span>
    Column versionColumn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    versionColumn<span class="token punctuation">.</span><span class="token function">setColumnName</span><span class="token punctuation">(</span>VERSION_COLUMN_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    update<span class="token punctuation">.</span><span class="token function">getColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>versionColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 值 version+1</span>
    Addition add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Addition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    add<span class="token punctuation">.</span><span class="token function">setLeftExpression</span><span class="token punctuation">(</span>versionColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    add<span class="token punctuation">.</span><span class="token function">setRightExpression</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LongValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    update<span class="token punctuation">.</span><span class="token function">getExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> Expression <span class="token function">buildVersionEquals</span><span class="token punctuation">(</span>Object originalVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Column column <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    column<span class="token punctuation">.</span><span class="token function">setColumnName</span><span class="token punctuation">(</span>VERSION_COLUMN_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 条件 version = originalVersion</span>
    EqualsTo equal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EqualsTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    equal<span class="token punctuation">.</span><span class="token function">setLeftExpression</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
    equal<span class="token punctuation">.</span><span class="token function">setRightExpression</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LongValue</span><span class="token punctuation">(</span>originalVersion<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> equal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>之后还需配置该插件，只需要在MyBatisConfig中加入该配置即可。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/2-1532934508-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>最后，如果版本不匹配，更新失败，需要往外抛出异常提醒，所以修改BaseService的update方法，增加检查更新是否失败。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934508.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>最后，能不用插件尽量不要用插件，因为它将修改MyBatis的底层设计。插件生成的是层层代理对象的责任链模式，通过反射方法运行，会有一定的性能消耗。</p>
<p>我们也可以修改 tk.mapper 生成SQL的方法，加入version，这里通过插件方式实现乐观锁主要是不为了去修改 mapper 的底层源码，比较方便。</p>
<p> </p>
<h2 id="六、Druid数据库连接池"><a href="#六、Druid数据库连接池" class="headerlink" title="六、Druid数据库连接池"></a>六、Druid数据库连接池</h2><p>创建数据库连接是一个很耗时的操作，也很容易对数据库造成安全隐患。对数据库连接的管理能显著影响到整个应用程序的伸缩性和健壮性，影响程序的性能指标。</p>
<p>数据库连接池负责分配、管理和释放数据库连接，它允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个；释放空闲时间超过最大空闲时间的数据库连接来避免因为没有释放数据库连接而引起的数据库连接遗漏。数据库连接池能明显提高对数据库操作的性能。</p>
<p>参考：</p>
<h3 id="1、Druid"><a href="#1、Druid" class="headerlink" title="1、Druid"></a>1、Druid</h3><p>Druid首先是一个数据库连接池，但它不仅仅是一个数据库连接池，它还包含一个ProxyDriver，一系列内置的JDBC组件库，一个SQLParser。Druid支持所有JDBC兼容的数据库，包括Oracle、MySql、Derby、Postgresql、SQLServer、H2等等。 Druid针对Oracle和MySql做了特别优化，比如Oracle的PSCache内存占用优化，MySql的ping检测优化。Druid在监控、可扩展性、稳定性和性能方面都有明显的优势。Druid提供了Filter-Chain模式的扩展API，可以自己编写Filter拦截JDBC中的任何方法，可以在上面做任何事情，比如说性能监控、SQL审计、用户名密码加密、日志等等。</p>
<h3 id="2、配置"><a href="#2、配置" class="headerlink" title="2、配置"></a>2、配置</h3><p>Druid配置到core模块下，只需在application.properties中添加如下配置即可，大部分配置是默认配置，可更改。有详细的注释，比较容易理解。</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">##################################### Druid####################################spring.datasource.driver-class-name=com.mysql.jdbc.Driverspring.datasource.type=com.alibaba.druid.pool.DruidDataSource # 初始化连接大小[0]spring.datasource.druid.initial-size=1# 最小空闲连接数[0]spring.datasource.druid.min-idle=1# 最大连接数[8]spring.datasource.druid.max-active=20 # 配置获取连接等待超时的时间(毫秒)[-1]spring.datasource.druid.max-wait=60000# 查询超时时间(秒)spring.datasource.druid.query-timeout=90 # 用来检测连接是否有效的sql，要求是一个查询语句spring.datasource.druid.validation-query=SELECT 'x'# 申请连接时检测连接可用性[false]spring.datasource.druid.test-on-borrow=false# 归还连接检测[false]spring.datasource.druid.test-on-return=false# 超时是否检测连接可用性[true]spring.datasource.druid.test-while-idle=true # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接 (毫秒)spring.datasource.druid.time-between-eviction-runs-millis=60000#  配置一个连接在池中最小生存的时间(毫秒，默认30分钟)spring.datasource.druid.min-evictable-idle-time-millis=300000# 通过别名的方式配置扩展插件，常用的插件有：监控统计用的filter:stat；日志用的filter:log4j；防御sql注入的filter:wallspring.datasource.druid.filters=stat,wall,slf4j# 合并多个DruidDataSource的监控数据spring.datasource.druid.use-global-data-source-stat=true # 是否缓存PreparedStatement. PSCache对支持游标的数据库性能提升巨大，比如说oracle.在mysql下建议关闭.spring.datasource.druid.pool-prepared-statements=false# 每个连接上PSCache的大小spring.datasource.druid.max-pool-prepared-statement-per-connection-size=20 # StatViewServlet [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatViewServlet%E9%85%8D%E7%BD%AE]spring.datasource.druid.stat-view-servlet.enabled=truespring.datasource.druid.stat-view-servlet.url-pattern=/druid/*# 监控页面的用户名和密码spring.datasource.druid.stat-view-servlet.login-username=adminspring.datasource.druid.stat-view-servlet.login-password=adminspring.datasource.druid.stat-view-servlet.reset-enable=false # StatFilter [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatFilter]spring.datasource.druid.filter.stat.db-type=mysql#慢SQL记录spring.datasource.druid.filter.stat.log-slow-sql=truespring.datasource.druid.filter.stat.slow-sql-millis=2000# SQL合并spring.datasource.druid.filter.stat.merge-sql=false # WallFilter [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE-wallfilter]spring.datasource.druid.filter.wall.enabled=truespring.datasource.druid.filter.wall.db-type=mysqlspring.datasource.druid.filter.wall.config.delete-allow=falsespring.datasource.druid.filter.wall.config.drop-table-allow=false</pre></td>

<p>####################################</p>
<h1 id="Druid"><a href="#Druid" class="headerlink" title="Druid"></a>Druid</h1><p>####################################<br>spring.datasource.driver-class-name&#x3D;com.mysql.jdbc.Driver<br>spring.datasource.type&#x3D;com.alibaba.druid.pool.DruidDataSource</p>
<h1 id="初始化连接大小-0"><a href="#初始化连接大小-0" class="headerlink" title="初始化连接大小[0]"></a>初始化连接大小[0]</h1><p>spring.datasource.druid.initial-size&#x3D;1</p>
<h1 id="最小空闲连接数-0"><a href="#最小空闲连接数-0" class="headerlink" title="最小空闲连接数[0]"></a>最小空闲连接数[0]</h1><p>spring.datasource.druid.min-idle&#x3D;1</p>
<h1 id="最大连接数-8"><a href="#最大连接数-8" class="headerlink" title="最大连接数[8]"></a>最大连接数[8]</h1><p>spring.datasource.druid.max-active&#x3D;20</p>
<h1 id="配置获取连接等待超时的时间-毫秒-1"><a href="#配置获取连接等待超时的时间-毫秒-1" class="headerlink" title="配置获取连接等待超时的时间(毫秒)[-1]"></a>配置获取连接等待超时的时间(毫秒)[-1]</h1><p>spring.datasource.druid.max-wait&#x3D;60000</p>
<h1 id="查询超时时间-秒"><a href="#查询超时时间-秒" class="headerlink" title="查询超时时间(秒)"></a>查询超时时间(秒)</h1><p>spring.datasource.druid.query-timeout&#x3D;90</p>
<h1 id="用来检测连接是否有效的sql，要求是一个查询语句"><a href="#用来检测连接是否有效的sql，要求是一个查询语句" class="headerlink" title="用来检测连接是否有效的sql，要求是一个查询语句"></a>用来检测连接是否有效的sql，要求是一个查询语句</h1><p>spring.datasource.druid.validation-query&#x3D;SELECT ‘x’</p>
<h1 id="申请连接时检测连接可用性-false"><a href="#申请连接时检测连接可用性-false" class="headerlink" title="申请连接时检测连接可用性[false]"></a>申请连接时检测连接可用性[false]</h1><p>spring.datasource.druid.test-on-borrow&#x3D;false</p>
<h1 id="归还连接检测-false"><a href="#归还连接检测-false" class="headerlink" title="归还连接检测[false]"></a>归还连接检测[false]</h1><p>spring.datasource.druid.test-on-return&#x3D;false</p>
<h1 id="超时是否检测连接可用性-true"><a href="#超时是否检测连接可用性-true" class="headerlink" title="超时是否检测连接可用性[true]"></a>超时是否检测连接可用性[true]</h1><p>spring.datasource.druid.test-while-idle&#x3D;true</p>
<h1 id="配置间隔多久才进行一次检测，检测需要关闭的空闲连接-毫秒"><a href="#配置间隔多久才进行一次检测，检测需要关闭的空闲连接-毫秒" class="headerlink" title="配置间隔多久才进行一次检测，检测需要关闭的空闲连接 (毫秒)"></a>配置间隔多久才进行一次检测，检测需要关闭的空闲连接 (毫秒)</h1><p>spring.datasource.druid.time-between-eviction-runs-millis&#x3D;60000</p>
<h1 id="配置一个连接在池中最小生存的时间-毫秒，默认30分钟"><a href="#配置一个连接在池中最小生存的时间-毫秒，默认30分钟" class="headerlink" title="配置一个连接在池中最小生存的时间(毫秒，默认30分钟)"></a>配置一个连接在池中最小生存的时间(毫秒，默认30分钟)</h1><p>spring.datasource.druid.min-evictable-idle-time-millis&#x3D;300000</p>
<h1 id="通过别名的方式配置扩展插件，常用的插件有：监控统计用的filter-stat；日志用的filter-log4j；防御sql注入的filter-wall"><a href="#通过别名的方式配置扩展插件，常用的插件有：监控统计用的filter-stat；日志用的filter-log4j；防御sql注入的filter-wall" class="headerlink" title="通过别名的方式配置扩展插件，常用的插件有：监控统计用的filter:stat；日志用的filter:log4j；防御sql注入的filter:wall"></a>通过别名的方式配置扩展插件，常用的插件有：监控统计用的filter:stat；日志用的filter:log4j；防御sql注入的filter:wall</h1><p>spring.datasource.druid.filters&#x3D;stat,wall,slf4j</p>
<h1 id="合并多个DruidDataSource的监控数据"><a href="#合并多个DruidDataSource的监控数据" class="headerlink" title="合并多个DruidDataSource的监控数据"></a>合并多个DruidDataSource的监控数据</h1><p>spring.datasource.druid.use-global-data-source-stat&#x3D;true</p>
<h1 id="是否缓存PreparedStatement-PSCache对支持游标的数据库性能提升巨大，比如说oracle-在mysql下建议关闭"><a href="#是否缓存PreparedStatement-PSCache对支持游标的数据库性能提升巨大，比如说oracle-在mysql下建议关闭" class="headerlink" title="是否缓存PreparedStatement. PSCache对支持游标的数据库性能提升巨大，比如说oracle.在mysql下建议关闭."></a>是否缓存PreparedStatement. PSCache对支持游标的数据库性能提升巨大，比如说oracle.在mysql下建议关闭.</h1><p>spring.datasource.druid.pool-prepared-statements&#x3D;false</p>
<h1 id="每个连接上PSCache的大小"><a href="#每个连接上PSCache的大小" class="headerlink" title="每个连接上PSCache的大小"></a>每个连接上PSCache的大小</h1><p>spring.datasource.druid.max-pool-prepared-statement-per-connection-size&#x3D;20</p>
<h1 id="StatViewServlet-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-StatViewServlet-E9-85-8D-E7-BD-AE"><a href="#StatViewServlet-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-StatViewServlet-E9-85-8D-E7-BD-AE" class="headerlink" title="StatViewServlet [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatViewServlet%E9%85%8D%E7%BD%AE]"></a>StatViewServlet [<a target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatViewServlet%E9%85%8D%E7%BD%AE]">https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatViewServlet%E9%85%8D%E7%BD%AE]</a></h1><p>spring.datasource.druid.stat-view-servlet.enabled&#x3D;true<br>spring.datasource.druid.stat-view-servlet.url-pattern&#x3D;&#x2F;druid&#x2F;*</p>
<h1 id="监控页面的用户名和密码"><a href="#监控页面的用户名和密码" class="headerlink" title="监控页面的用户名和密码"></a>监控页面的用户名和密码</h1><p>spring.datasource.druid.stat-view-servlet.login-username&#x3D;admin<br>spring.datasource.druid.stat-view-servlet.login-password&#x3D;admin<br>spring.datasource.druid.stat-view-servlet.reset-enable&#x3D;false</p>
<h1 id="StatFilter-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-StatFilter"><a href="#StatFilter-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-StatFilter" class="headerlink" title="StatFilter [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatFilter]"></a>StatFilter [<a target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatFilter]">https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatFilter]</a></h1><p>spring.datasource.druid.filter.stat.db-type&#x3D;mysql<br>#慢SQL记录<br>spring.datasource.druid.filter.stat.log-slow-sql&#x3D;true<br>spring.datasource.druid.filter.stat.slow-sql-millis&#x3D;2000</p>
<h1 id="SQL合并"><a href="#SQL合并" class="headerlink" title="SQL合并"></a>SQL合并</h1><p>spring.datasource.druid.filter.stat.merge-sql&#x3D;false</p>
<h1 id="WallFilter-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-wallfilter"><a href="#WallFilter-https-github-com-alibaba-druid-wiki-E9-85-8D-E7-BD-AE-wallfilter" class="headerlink" title="WallFilter [https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE-wallfilter]"></a>WallFilter [<a target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE-wallfilter]">https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE-wallfilter]</a></h1><p>spring.datasource.druid.filter.wall.enabled&#x3D;true<br>spring.datasource.druid.filter.wall.db-type&#x3D;mysql<br>spring.datasource.druid.filter.wall.config.delete-allow&#x3D;false<br>spring.datasource.druid.filter.wall.config.drop-table-allow&#x3D;false</p>
<p> </p>
<p>之后启动项目在地址栏输入&#x2F;druid&#x2F;index.html并登录就可以看到Druid监控页面：</p>
<img class=" aligncenter" style="border: 1px solid black;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934509.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="1357" height="774">

<p> </p>
<h2 id="七、Redis缓存"><a href="#七、Redis缓存" class="headerlink" title="七、Redis缓存"></a>七、Redis缓存</h2><p>对于如今的一个中小型系统来说，至少也需要一个缓存来缓存热点数据，加快数据的访问数据，这里选用Redis做缓存数据库。在以后可以使用Redis做分布式缓存、做Session共享等。</p>
<h3 id="1、SpringBoot的缓存支持"><a href="#1、SpringBoot的缓存支持" class="headerlink" title="1、SpringBoot的缓存支持"></a>1、SpringBoot的缓存支持</h3><p>Spring定义了org.springframework.cache.CacheManager和org.springframework.cache.Cache接口来统一不同的缓存技术。CacheManager是Spring提供的各种缓存技术抽象接口，Cache接口包含缓存的各种操作。</p>
<p>针对不同的缓存技术，需要实现不同的CacheManager，Redis缓存则提供了RedisCacheManager的实现。</p>
<p>我将redis缓存功能放到sunny-starter-cache模块下，cache模块下可以有多种缓存技术，同时，对于其它项目来说，缓存是可插拔的，想用缓存直接引入cache模块即可。</p>
<p>首先引入Redis的依赖：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934510.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>SpringBoot已经默认为我们自动配置了多个CacheManager的实现，在autoconfigure.cache包下。在Spring Boot 环境下，使用缓存技术只需在项目中导入相关的依赖包即可。</p>
<p>在 RedisCacheConfiguration 里配置了默认的 CacheManager；SpringBoot提供了默认的redis配置，RedisAutoConfiguration 是Redis的自动化配置，比如创建连接池、初始化RedisTemplate等。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934510.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934510-1.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="2、Redis-配置及声明式缓存支持"><a href="#2、Redis-配置及声明式缓存支持" class="headerlink" title="2、Redis 配置及声明式缓存支持"></a>2、Redis 配置及声明式缓存支持</h3><p>Redis 默认配置了 RedisTemplate 和 StringRedisTemplate ，其使用的序列化规则是 JdkSerializationRedisSerializer，缓存到redis后，数据都变成了下面这种样式，非常不易于阅读。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934510-2.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="785" height="228">

<p>因此，重新配置RedisTemplate，使用 Jackson2JsonRedisSerializer 来序列化 Key 和 Value。同时，增加HashOperations、ValueOperations等Redis数据结构相关的操作，这样比较方便使用。</p>
<td class="line_numbers"><pre>12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.cache.redis; import org.springframework.beans.factory.annotation.Autowired;import org.springframework.cache.annotation.EnableCaching;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.data.redis.cache.RedisCacheManager;import org.springframework.data.redis.connection.RedisConnectionFactory;import org.springframework.data.redis.core.*;import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;import org.springframework.http.converter.json.Jackson2ObjectMapperBuilder; import com.fasterxml.jackson.annotation.JsonAutoDetect;import com.fasterxml.jackson.annotation.PropertyAccessor;import com.fasterxml.jackson.databind.ObjectMapper; /** * Redis配置. * * 使用@EnableCaching开启声明式缓存支持. 之后就可以使用 @Cacheable/@CachePut/@CacheEvict 注解缓存数据. * * @author bojiangzhou 2018-02-11 * @version 1.0 */@Configuration@EnableCachingpublic class RedisConfig {    @Autowired    private RedisConnectionFactory redisConnectionFactory;    @Autowired    private Jackson2ObjectMapperBuilder jackson2ObjectMapperBuilder;     /**     * 覆盖默认配置 RedisTemplate，使用 String 类型作为key，设置key/value的序列化规则     */    @Bean    @SuppressWarnings("unchecked")    public RedisTemplateString, Object redisTemplate() {        RedisTemplateString, Object redisTemplate = new RedisTemplate();        redisTemplate.setConnectionFactory(redisConnectionFactory);         // 使用 Jackson2JsonRedisSerialize 替换默认序列化        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);        ObjectMapper objectMapper = jackson2ObjectMapperBuilder.createXmlMapper(false).build();        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);         // 设置value的序列化规则和key的序列化规则        redisTemplate.setKeySerializer(jackson2JsonRedisSerializer);        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);        redisTemplate.setHashKeySerializer(jackson2JsonRedisSerializer);        redisTemplate.setHashValueSerializer(jackson2JsonRedisSerializer);        redisTemplate.afterPropertiesSet();         return redisTemplate;    }     @Bean    public HashOperationsString, String, Object hashOperations(RedisTemplateString, Object redisTemplate) {        return redisTemplate.opsForHash();    }     @Bean    public ValueOperationsString, String valueOperations(RedisTemplateString, String redisTemplate) {        return redisTemplate.opsForValue();    }     @Bean    public ListOperationsString, Object listOperations(RedisTemplateString, Object redisTemplate) {        return redisTemplate.opsForList();    }     @Bean    public SetOperationsString, Object setOperations(RedisTemplateString, Object redisTemplate) {        return redisTemplate.opsForSet();    }     @Bean    public ZSetOperationsString, Object zSetOperations(RedisTemplateString, Object redisTemplate) {        return redisTemplate.opsForZSet();    }     @Bean    public RedisCacheManager cacheManager() {        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate());        cacheManager.setUsePrefix(true);        return cacheManager;    } }</pre></td>

<p>package com.lyyzoo.cache.redis;</p>
<p>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.cache.annotation.EnableCaching;<br>import org.springframework.context.annotation.Bean;<br>import org.springframework.context.annotation.Configuration;<br>import org.springframework.data.redis.cache.RedisCacheManager;<br>import org.springframework.data.redis.connection.RedisConnectionFactory;<br>import org.springframework.data.redis.core.*;<br>import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;<br>import org.springframework.http.converter.json.Jackson2ObjectMapperBuilder;</p>
<p>import com.fasterxml.jackson.annotation.JsonAutoDetect;<br>import com.fasterxml.jackson.annotation.PropertyAccessor;<br>import com.fasterxml.jackson.databind.ObjectMapper;</p>
<p>&#x2F;**</p>
<ul>
<li>Redis配置.</li>
<li></li>
<li>使用@EnableCaching开启声明式缓存支持. 之后就可以使用 @Cacheable&#x2F;@CachePut&#x2F;@CacheEvict 注解缓存数据.</li>
<li></li>
<li>@author bojiangzhou 2018-02-11</li>
<li>@version 1.0</li>
</ul>
<p> *&#x2F;<br>@Configuration<br>@EnableCaching<br>public class RedisConfig {<br>    @Autowired<br>    private RedisConnectionFactory redisConnectionFactory;<br>    @Autowired<br>    private Jackson2ObjectMapperBuilder jackson2ObjectMapperBuilder;</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token comment" spellcheck="true">/**
 * 覆盖默认配置 RedisTemplate，使用 String 类型作为key，设置key/value的序列化规则
 */</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> RedisTemplateString<span class="token punctuation">,</span> Object <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 使用 Jackson2JsonRedisSerialize 替换默认序列化</span>
    Jackson2JsonRedisSerializer jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ObjectMapper objectMapper <span class="token operator">=</span> jackson2ObjectMapperBuilder<span class="token punctuation">.</span><span class="token function">createXmlMapper</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMapper<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>PropertyAccessor<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> JsonAutoDetect<span class="token punctuation">.</span>Visibility<span class="token punctuation">.</span>ANY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span>ObjectMapper<span class="token punctuation">.</span>DefaultTyping<span class="token punctuation">.</span>NON_FINAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 设置value的序列化规则和key的序列化规则</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> HashOperationsString<span class="token punctuation">,</span> String<span class="token punctuation">,</span> Object <span class="token function">hashOperations</span><span class="token punctuation">(</span>RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> ValueOperationsString<span class="token punctuation">,</span> String <span class="token function">valueOperations</span><span class="token punctuation">(</span>RedisTemplateString<span class="token punctuation">,</span> String redisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> ListOperationsString<span class="token punctuation">,</span> Object <span class="token function">listOperations</span><span class="token punctuation">(</span>RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> SetOperationsString<span class="token punctuation">,</span> Object <span class="token function">setOperations</span><span class="token punctuation">(</span>RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> ZSetOperationsString<span class="token punctuation">,</span> Object <span class="token function">zSetOperations</span><span class="token punctuation">(</span>RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> RedisCacheManager <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RedisCacheManager cacheManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">(</span><span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cacheManager<span class="token punctuation">.</span><span class="token function">setUsePrefix</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p>同时，使用@EnableCaching开启声明式缓存支持，这样就可以使用基于注解的缓存技术。注解缓存是一个对缓存使用的抽象，通过在代码中添加下面的一些注解，达到缓存的效果。</p>
<ul>
<li>@Cacheable：在方法执行前Spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；没有则调用方法并将方法返回值放进缓存。</li>
<li>@CachePut：将方法的返回值放到缓存中。</li>
<li>@CacheEvict：删除缓存中的数据。</li>
</ul>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/6-1532934511.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<img class=" aligncenter" style="border: 1px solid black;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934511.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>Redis服务器相关的一些配置可在application.properties中进行配置：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/5-1532934511.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="3、Redis工具类"><a href="#3、Redis工具类" class="headerlink" title="3、Redis工具类"></a>3、Redis工具类</h3><p>添加一个Redis的统一操作工具，主要是对redis的常用数据类型操作类做了一个归集。</p>
<p>ValueOperations用于操作String类型，HashOperations用于操作hash数据，ListOperations操作List集合，SetOperations操作Set集合，ZSetOperations操作有序集合。</p>
<p>关于redis的key命令和数据类型可参考：</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.cache.redis; import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.data.redis.connection.DataType;import org.springframework.data.redis.core.*;import org.springframework.stereotype.Component; import java.util.Collection;import java.util.Date;import java.util.Set;import java.util.concurrent.TimeUnit;import java.util.stream.Collectors;import java.util.stream.Stream; /** * Redis 操作工具 * * @version 1.0 * @author bojiangzhou 2018-02-12 */@Componentpublic class RedisOperator {     @Autowired    private RedisTemplateString, Object redisTemplate;    @Autowired    private ValueOperationsString, String valueOperator;    @Autowired    private HashOperationsString, String, Object hashOperator;    @Autowired    private ListOperationsString, Object listOperator;    @Autowired    private SetOperationsString, Object setOperator;    @Autowired    private ZSetOperationsString, Object zSetOperator;     /**     * 默认过期时长，单位：秒     */    public final static long DEFAULT_EXPIRE = 60 * 60 * 24;     /** 不设置过期时长 */    public final static long NOT_EXPIRE = -1;     /**     * Redis的根操作路径     */    @Value("${redis.root:sunny}")    private String category;     public RedisOperator setCategory(String category) {        this.category = category;        return this;    }     /**     * 获取Key的全路径     *      * @param key key     * @return full key     */    public String getFullKey(String key) {        return this.category + ":" + key;    }      //    // key    // ------------------------------------------------------------------------------    /**     * 判断key是否存在     *     * p     * iexists key/i     *     * @param key key     */    public boolean existsKey(String key) {        return redisTemplate.hasKey(getFullKey(key));    }     /**     * 判断key存储的值类型     *     * p     * itype key/i     *     * @param key key     * @return DataType[string、list、set、zset、hash]     */    public DataType typeKey(String key){        return redisTemplate.type(getFullKey(key));    }     /**     * 重命名key. 如果newKey已经存在，则newKey的原值被覆盖     *     * p     * irename oldKey newKey/i     *     * @param oldKey oldKeys     * @param newKey newKey     */    public void renameKey(String oldKey, String newKey){        redisTemplate.rename(getFullKey(oldKey), getFullKey(newKey));    }     /**     * newKey不存在时才重命名.     *     * p     * irenamenx oldKey newKey/i     *     * @param oldKey oldKey     * @param newKey newKey     * @return 修改成功返回true     */    public boolean renameKeyNx(String oldKey, String newKey){        return redisTemplate.renameIfAbsent(getFullKey(oldKey), getFullKey(newKey));    }     /**     * 删除key     *     * p     * idel key/i     *     * @param key key     */    public void deleteKey(String key){        redisTemplate.delete(key);    }     /**     * 删除key     *     * p     * idel key1 key2 .../i     *     * @param keys 可传入多个key     */    public void deleteKey(String ... keys){        SetString ks = Stream.of(keys).map(k - getFullKey(k)).collect(Collectors.toSet());        redisTemplate.delete(ks);    }     /**     * 删除key     *     * p     * idel key1 key2 .../i     *     * @param keys key集合     */    public void deleteKey(CollectionString keys){        SetString ks = keys.stream().map(k - getFullKey(k)).collect(Collectors.toSet());        redisTemplate.delete(ks);    }     /**     * 设置key的生命周期，单位秒     *     * p     * iexpire key seconds/ibr     * ipexpire key milliseconds/i     *     * @param key key     * @param time 时间数     * @param timeUnit TimeUnit 时间单位     */    public void expireKey(String key, long time, TimeUnit timeUnit){        redisTemplate.expire(key, time, timeUnit);    }     /**     * 设置key在指定的日期过期     *     * p     * iexpireat key timestamp/i     *     * @param key key     * @param date 指定日期     */    public void expireKeyAt(String key, Date date){        redisTemplate.expireAt(key, date);    }     /**     * 查询key的生命周期     *     * p     * ittl key/i     *     * @param key key     * @param timeUnit TimeUnit 时间单位     * @return 指定时间单位的时间数     */    public long getKeyExpire(String key, TimeUnit timeUnit){        return redisTemplate.getExpire(key, timeUnit);    }     /**     * 将key设置为永久有效     *     * p     * ipersist key/i     *     * @param key key     */    public void persistKey(String key){        redisTemplate.persist(key);    }      /**     *     * @return RedisTemplate     */    public RedisTemplateString, Object getRedisTemplate() {        return redisTemplate;    }     /**     *     * @return ValueOperations     */    public ValueOperationsString, String getValueOperator() {        return valueOperator;    }     /**     *     * @return HashOperations     */    public HashOperationsString, String, Object getHashOperator() {        return hashOperator;    }     /**     *     * @return ListOperations     */    public ListOperationsString, Object getListOperator() {        return listOperator;    }     /**     *     * @return SetOperations     */    public SetOperationsString, Object getSetOperator() {        return setOperator;    }     /**     *     * @return ZSetOperations     */    public ZSetOperationsString, Object getZSetOperator() {        return zSetOperator;    } }</pre></td>

<p>package com.lyyzoo.cache.redis;</p>
<p>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.beans.factory.annotation.Value;<br>import org.springframework.data.redis.connection.DataType;<br>import org.springframework.data.redis.core.*;<br>import org.springframework.stereotype.Component;</p>
<p>import java.util.Collection;<br>import java.util.Date;<br>import java.util.Set;<br>import java.util.concurrent.TimeUnit;<br>import java.util.stream.Collectors;<br>import java.util.stream.Stream;</p>
<p>&#x2F;**</p>
<ul>
<li>Redis 操作工具</li>
<li></li>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-02-12</li>
</ul>
<p> *&#x2F;<br>@Component<br>public class RedisOperator {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> RedisTemplateString<span class="token punctuation">,</span> Object redisTemplate<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> ValueOperationsString<span class="token punctuation">,</span> String valueOperator<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> HashOperationsString<span class="token punctuation">,</span> String<span class="token punctuation">,</span> Object hashOperator<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> ListOperationsString<span class="token punctuation">,</span> Object listOperator<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> SetOperationsString<span class="token punctuation">,</span> Object setOperator<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> ZSetOperationsString<span class="token punctuation">,</span> Object zSetOperator<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 默认过期时长，单位：秒
 */</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">long</span> DEFAULT_EXPIRE <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/** 不设置过期时长 */</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">long</span> NOT_EXPIRE <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * Redis的根操作路径
 */</span>
<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${redis.root:sunny}"</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> String category<span class="token punctuation">;</span>

<span class="token keyword">public</span> RedisOperator <span class="token function">setCategory</span><span class="token punctuation">(</span>String category<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> category<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 获取Key的全路径
 * 
 * @param key key
 * @return full key
 */</span>
<span class="token keyword">public</span> String <span class="token function">getFullKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> key<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">// key</span>
<span class="token comment" spellcheck="true">// ------------------------------------------------------------------------------</span>
<span class="token comment" spellcheck="true">/**
 * 判断key是否存在
 *
 * p
 * iexists key/i
 *
 * @param key key
 */</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">existsKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span><span class="token function">getFullKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 判断key存储的值类型
 *
 * p
 * itype key/i
 *
 * @param key key
 * @return DataType[string、list、set、zset、hash]
 */</span>
<span class="token keyword">public</span> DataType <span class="token function">typeKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token function">getFullKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 重命名key. 如果newKey已经存在，则newKey的原值被覆盖
 *
 * p
 * irename oldKey newKey/i
 *
 * @param oldKey oldKeys
 * @param newKey newKey
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">renameKey</span><span class="token punctuation">(</span>String oldKey<span class="token punctuation">,</span> String newKey<span class="token punctuation">)</span><span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token function">getFullKey</span><span class="token punctuation">(</span>oldKey<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getFullKey</span><span class="token punctuation">(</span>newKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * newKey不存在时才重命名.
 *
 * p
 * irenamenx oldKey newKey/i
 *
 * @param oldKey oldKey
 * @param newKey newKey
 * @return 修改成功返回true
 */</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">renameKeyNx</span><span class="token punctuation">(</span>String oldKey<span class="token punctuation">,</span> String newKey<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">renameIfAbsent</span><span class="token punctuation">(</span><span class="token function">getFullKey</span><span class="token punctuation">(</span>oldKey<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getFullKey</span><span class="token punctuation">(</span>newKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 删除key
 *
 * p
 * idel key/i
 *
 * @param key key
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span><span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 删除key
 *
 * p
 * idel key1 key2 .../i
 *
 * @param keys 可传入多个key
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteKey</span><span class="token punctuation">(</span>String <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> keys<span class="token punctuation">)</span><span class="token punctuation">{</span>
    SetString ks <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token function">getFullKey</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>ks<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 删除key
 *
 * p
 * idel key1 key2 .../i
 *
 * @param keys key集合
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteKey</span><span class="token punctuation">(</span>CollectionString keys<span class="token punctuation">)</span><span class="token punctuation">{</span>
    SetString ks <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token function">getFullKey</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>ks<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 设置key的生命周期，单位秒
 *
 * p
 * iexpire key seconds/ibr
 * ipexpire key milliseconds/i
 *
 * @param key key
 * @param time 时间数
 * @param timeUnit TimeUnit 时间单位
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">expireKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">,</span> TimeUnit timeUnit<span class="token punctuation">)</span><span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 设置key在指定的日期过期
 *
 * p
 * iexpireat key timestamp/i
 *
 * @param key key
 * @param date 指定日期
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">expireKeyAt</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Date date<span class="token punctuation">)</span><span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">expireAt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 查询key的生命周期
 *
 * p
 * ittl key/i
 *
 * @param key key
 * @param timeUnit TimeUnit 时间单位
 * @return 指定时间单位的时间数
 */</span>
<span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getKeyExpire</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> TimeUnit timeUnit<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">getExpire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 将key设置为永久有效
 *
 * p
 * ipersist key/i
 *
 * @param key key
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">persistKey</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span><span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">/**
 *
 * @return RedisTemplate
 */</span>
<span class="token keyword">public</span> RedisTemplateString<span class="token punctuation">,</span> Object <span class="token function">getRedisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 *
 * @return ValueOperations
 */</span>
<span class="token keyword">public</span> ValueOperationsString<span class="token punctuation">,</span> String <span class="token function">getValueOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> valueOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 *
 * @return HashOperations
 */</span>
<span class="token keyword">public</span> HashOperationsString<span class="token punctuation">,</span> String<span class="token punctuation">,</span> Object <span class="token function">getHashOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hashOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 *
 * @return ListOperations
 */</span>
<span class="token keyword">public</span> ListOperationsString<span class="token punctuation">,</span> Object <span class="token function">getListOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> listOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 *
 * @return SetOperations
 */</span>
<span class="token keyword">public</span> SetOperationsString<span class="token punctuation">,</span> Object <span class="token function">getSetOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> setOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 *
 * @return ZSetOperations
 */</span>
<span class="token keyword">public</span> ZSetOperationsString<span class="token punctuation">,</span> Object <span class="token function">getZSetOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> zSetOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<h2 id="八、Swagger支持API文档"><a href="#八、Swagger支持API文档" class="headerlink" title="八、Swagger支持API文档"></a>八、Swagger支持API文档</h2><h3 id="1、Swagger"><a href="#1、Swagger" class="headerlink" title="1、Swagger"></a>1、Swagger</h3><p>做前后端分离，前端和后端的唯一联系，变成了API接口；API文档变成了前后端开发人员联系的纽带，变得越来越重要，swagger就是一款让你更好的书写API文档的框架。</p>
<p>Swagger是一个简单又强大的能为你的Restful风格的Api生成文档的工具。在项目中集成这个工具，根据我们自己的配置信息能够自动为我们生成一个api文档展示页，可以在浏览器中直接访问查看项目中的接口信息，同时也可以测试每个api接口。</p>
<h3 id="2、配置-1"><a href="#2、配置-1" class="headerlink" title="2、配置"></a>2、配置</h3><p>我这里直接使用别人已经整合好的swagger-spring-boot-starter，快速方便。</p>
<p>参考：</p>
<p>新建一个sunny-starter-swagger模块，做到可插拔。</p>
<p>根据文档，一般只需要做些简单的配置即可：</p>
<p>但如果想要显示swagger-ui.html文档展示页，还必须注入swagger资源：</p>
<td class="line_numbers"><pre>1234567891011121314151617181920212223242526272829</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.swagger.config; import org.springframework.context.annotation.Configuration;import org.springframework.context.annotation.PropertySource;import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter; import com.spring4all.swagger.EnableSwagger2Doc; /** * @version 1.0 * @author bojiangzhou 2018-02-19 */@Configuration@EnableSwagger2Doc@PropertySource(value = "classpath:application-swagger.properties")public class SunnySwaggerConfig extends WebMvcConfigurerAdapter {    /**     * 注入swagger资源文件     */    @Override    public void addResourceHandlers(ResourceHandlerRegistry registry) {        registry.addResourceHandler("swagger-ui.html")                .addResourceLocations("classpath:/META-INF/resources/");        registry.addResourceHandler("/webjars/**")                .addResourceLocations("classpath:/META-INF/resources/webjars/");    } }</pre></td>

<p>package com.lyyzoo.swagger.config;</p>
<p>import org.springframework.context.annotation.Configuration;<br>import org.springframework.context.annotation.PropertySource;<br>import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;<br>import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</p>
<p>import com.spring4all.swagger.EnableSwagger2Doc;</p>
<p>&#x2F;**</p>
<ul>
<li>@version 1.0</li>
<li>@author bojiangzhou 2018-02-19</li>
</ul>
<p> <em>&#x2F;<br>@Configuration<br>@EnableSwagger2Doc<br>@PropertySource(value &#x3D; “classpath:application-swagger.properties”)<br>public class SunnySwaggerConfig extends WebMvcConfigurerAdapter {<br>    &#x2F;</em>*<br>     * 注入swagger资源文件<br>     *&#x2F;<br>    @Override<br>    public void addResourceHandlers(ResourceHandlerRegistry registry) {<br>        registry.addResourceHandler(“swagger-ui.html”)<br>                .addResourceLocations(“classpath:&#x2F;META-INF&#x2F;resources&#x2F;“);<br>        registry.addResourceHandler(“&#x2F;webjars&#x2F;**”)<br>                .addResourceLocations(“classpath:&#x2F;META-INF&#x2F;resources&#x2F;webjars&#x2F;“);<br>    }</p>
<p>}</p>
<p> </p>
<h3 id="3、使用"><a href="#3、使用" class="headerlink" title="3、使用"></a>3、使用</h3><p>一般只需要在Controller加上swagger的注解即可显示对应的文档信息，如@Api、@ApiOperation、@ApiParam等。</p>
<p>常用注解参考：</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">package com.lyyzoo.admin.system.controller; import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*; import com.lyyzoo.admin.system.dto.Menu;import com.lyyzoo.admin.system.service.MenuService;import com.lyyzoo.core.base.BaseController;import com.lyyzoo.core.base.Result;import com.lyyzoo.core.util.Results; import io.swagger.annotations.Api;import io.swagger.annotations.ApiImplicitParam;import io.swagger.annotations.ApiOperation;import io.swagger.annotations.ApiParam; @Api(tags = "菜单管理")@RequestMapping@RestControllerpublic class MenuController extends BaseController {     @Autowired    private MenuService service;     /**     * 查找单个用户     *     * @param menuId 菜单ID     * @return Result     */    @ApiOperation("查找单个用户")    @ApiImplicitParam(name = "menuId", value = "菜单ID", paramType = "path")    @GetMapping("/sys/menu/get/{menuId}")    public Result get(@PathVariable Long menuId){        Menu menu = service.selectById(menuId);        return Results.successWithData(menu);    }     /**     * 保存菜单     *     * @param menu 菜单     * @return Result     */    @ApiOperation("保存菜单")    @PostMapping("/sys/menu/save")    public Result save(@ApiParam(name = "menu", value = "菜单")@RequestBody Menu menu){        menu = service.save(menu);        return Results.successWithData(menu);    }     /**     * 删除菜单     *     * @param menuId 菜单ID     * @return Result     */    @ApiOperation("删除菜单")    @ApiImplicitParam(name = "menuId", value = "菜单ID", paramType = "path")    @PostMapping("/sys/menu/delete/{menuId}")    public Result delete(@PathVariable Long menuId){        service.deleteById(menuId);        return Results.success();    } }</pre></td>

<p>package com.lyyzoo.admin.system.controller;</p>
<p>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.web.bind.annotation.*;</p>
<p>import com.lyyzoo.admin.system.dto.Menu;<br>import com.lyyzoo.admin.system.service.MenuService;<br>import com.lyyzoo.core.base.BaseController;<br>import com.lyyzoo.core.base.Result;<br>import com.lyyzoo.core.util.Results;</p>
<p>import io.swagger.annotations.Api;<br>import io.swagger.annotations.ApiImplicitParam;<br>import io.swagger.annotations.ApiOperation;<br>import io.swagger.annotations.ApiParam;</p>
<p>@Api(tags &#x3D; “菜单管理”)<br>@RequestMapping<br>@RestController<br>public class MenuController extends BaseController {</p>
<pre class="line-numbers language-java"><code class="language-java">
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> MenuService service<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 查找单个用户
 *
 * @param menuId 菜单ID
 * @return Result
 */</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">"查找单个用户"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"menuId"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"菜单ID"</span><span class="token punctuation">,</span> paramType <span class="token operator">=</span> <span class="token string">"path"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/menu/get/{menuId}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">get</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Long menuId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Menu menu <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>menuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 保存菜单
 *
 * @param menu 菜单
 * @return Result
 */</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">"保存菜单"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/menu/save"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"menu"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"菜单"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@RequestBody</span> Menu menu<span class="token punctuation">)</span><span class="token punctuation">{</span>
    menu <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 删除菜单
 *
 * @param menuId 菜单ID
 * @return Result
 */</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">"删除菜单"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"menuId"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"菜单ID"</span><span class="token punctuation">,</span> paramType <span class="token operator">=</span> <span class="token string">"path"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sys/menu/delete/{menuId}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Result <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Long menuId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    service<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>menuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Results<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>}</p>
<p> </p>
<p>之后访问swagger-ui.html页面就可以看到API文档信息了。</p>
<img class=" aligncenter" style="border: 1px solid black;" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/8-1532934512.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构" width="1310" height="770">

<p>如果不需要swagger，在配置文件中配置swagger.enabled&#x3D;false，或移除sunny-starter-swagger的依赖即可。</p>
<p> </p>
<h2 id="九、项目优化调整"><a href="#九、项目优化调整" class="headerlink" title="九、项目优化调整"></a>九、项目优化调整</h2><p>到这里，项目最基础的一些功能就算完成了，但由于前期的一些设计不合理及未考虑周全等因素，对项目做一些调整。并参考《阿里巴巴Java开发手册》对代码做了一些优化。</p>
<h3 id="1、项目结构"><a href="#1、项目结构" class="headerlink" title="1、项目结构"></a>1、项目结构</h3><p>目前项目分为5个模块：</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/4-1532934512.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p>最外层的Sunny作为聚合模块负责管理所有子模块，方便统一构建。并且继承 spring-boot-starter-parent ，其它子模块则继承该模块，方便统一管理 Spring Boot 及本项目的版本。这里已经把Spring Boot的版本升到 1.5.10.RELEASE。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">?xml version="1.0" encoding="UTF-8"?project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"    modelVersion4.0.0/modelVersion     groupIdcom.lyyzoo/groupId    artifactIdsunny/artifactId    version0.0.1-SNAPSHOT/version    packagingpom/packaging     nameSunny/name    descriptionLyyzoo Base Application development platform/description     parent        groupIdorg.springframework.boot/groupId        artifactIdspring-boot-starter-parent/artifactId        version1.5.10.RELEASE/version        relativePath/    /parent     properties        project.build.sourceEncodingUTF-8/project.build.sourceEncoding        project.reporting.outputEncodingUTF-8/project.reporting.outputEncoding        java.version1.8/java.version         sunny.version0.0.1-SNAPSHOT/sunny.version        springboot.version1.5.10.RELEASE/springboot.version    /properties     modules        modulesunny-starter/module        modulesunny-starter-core/module        modulesunny-starter-cache/module        modulesunny-starter-security/module        modulesunny-starter-admin/module        modulesunny-starter-swagger/module    /modules     build        plugins            plugin                groupIdorg.springframework.boot/groupId                artifactIdspring-boot-maven-plugin/artifactId            /plugin        /plugins    /build /project</pre></td>

<p>?xml version&#x3D;”1.0” encoding&#x3D;”UTF-8”?<br>project xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://maven.apache.org/POM/4.0.0&quot;">http://maven.apache.org/POM/4.0.0&quot;</a> xmlns:xsi&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2001/XMLSchema-instance&quot;">http://www.w3.org/2001/XMLSchema-instance&quot;</a><br>         xsi:schemaLocation&#x3D;”<a target="_blank" rel="noopener" href="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</a> <a target="_blank" rel="noopener" href="http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;">http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</a><br>    modelVersion4.0.0&#x2F;modelVersion</p>
<pre class="line-numbers language-java"><code class="language-java">
groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token operator">/</span>groupId
artifactIdsunny<span class="token operator">/</span>artifactId
version0<span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">-</span>SNAPSHOT<span class="token operator">/</span>version
packagingpom<span class="token operator">/</span>packaging

nameSunny<span class="token operator">/</span>name
descriptionLyyzoo Base Application development platform<span class="token operator">/</span>description

parent
    groupIdorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">/</span>groupId
    artifactIdspring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>parent<span class="token operator">/</span>artifactId
    version1<span class="token number">.5</span><span class="token punctuation">.</span><span class="token number">10</span><span class="token punctuation">.</span>RELEASE<span class="token operator">/</span>version
    relativePath<span class="token operator">/</span>
<span class="token operator">/</span>parent

properties
    project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncodingUTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncoding
    project<span class="token punctuation">.</span>reporting<span class="token punctuation">.</span>outputEncodingUTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>project<span class="token punctuation">.</span>reporting<span class="token punctuation">.</span>outputEncoding
    java<span class="token punctuation">.</span>version1<span class="token number">.8</span><span class="token operator">/</span>java<span class="token punctuation">.</span>version

    sunny<span class="token punctuation">.</span>version0<span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">-</span>SNAPSHOT<span class="token operator">/</span>sunny<span class="token punctuation">.</span>version
    springboot<span class="token punctuation">.</span>version1<span class="token number">.5</span><span class="token punctuation">.</span><span class="token number">10</span><span class="token punctuation">.</span>RELEASE<span class="token operator">/</span>springboot<span class="token punctuation">.</span>version
<span class="token operator">/</span>properties

modules
    modulesunny<span class="token operator">-</span>starter<span class="token operator">/</span>module
    modulesunny<span class="token operator">-</span>starter<span class="token operator">-</span>core<span class="token operator">/</span>module
    modulesunny<span class="token operator">-</span>starter<span class="token operator">-</span>cache<span class="token operator">/</span>module
    modulesunny<span class="token operator">-</span>starter<span class="token operator">-</span>security<span class="token operator">/</span>module
    modulesunny<span class="token operator">-</span>starter<span class="token operator">-</span>admin<span class="token operator">/</span>module
    modulesunny<span class="token operator">-</span>starter<span class="token operator">-</span>swagger<span class="token operator">/</span>module
<span class="token operator">/</span>modules

build
    plugins
        plugin
            groupIdorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">/</span>groupId
            artifactIdspring<span class="token operator">-</span>boot<span class="token operator">-</span>maven<span class="token operator">-</span>plugin<span class="token operator">/</span>artifactId
        <span class="token operator">/</span>plugin
    <span class="token operator">/</span>plugins
<span class="token operator">/</span>build
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x2F;project</p>
<p> </p>
<p>sunny-starter 则引入了其余几个模块，在开发项目时，只需要继承或引入sunny-starter即可，而无需一个个引入各个模块。</p>
<td class="line_numbers"><pre>123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263</pre></td><td class="code"><pre class="java5" style="font-family:monospace;">?xml version="1.0" encoding="UTF-8"?project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"    modelVersion4.0.0/modelVersion     parent        groupIdcom.lyyzoo/groupId        artifactIdsunny/artifactId        version0.0.1-SNAPSHOT/version    /parent     groupIdcom.lyyzoo.parent/groupId    artifactIdsunny-starter/artifactId    packagingjar/packaging     namesunny-starter/name    descriptionSunny Parent/description     dependencies        !-- core --        dependency            groupIdcom.lyyzoo.core/groupId            artifactIdsunny-starter-core/artifactId            version${sunny.version}/version        /dependency        !-- cache --        dependency            groupIdcom.lyyzoo.cache/groupId            artifactIdsunny-starter-cache/artifactId            version${sunny.version}/version        /dependency        !-- security --        dependency            groupIdcom.lyyzoo.security/groupId            artifactIdsunny-starter-security/artifactId            version${sunny.version}/version        /dependency        !-- admin --        dependency            groupIdcom.lyyzoo.admin/groupId            artifactIdsunny-starter-admin/artifactId            version${sunny.version}/version        /dependency        !-- swagger --        dependency            groupIdcom.lyyzoo.swagger/groupId            artifactIdsunny-starter-swagger/artifactId            version${sunny.version}/version        /dependency     /dependencies     build        plugins            plugin                groupIdorg.springframework.boot/groupId                artifactIdspring-boot-maven-plugin/artifactId            /plugin        /plugins    /build  /project</pre></td>

<p>?xml version&#x3D;”1.0” encoding&#x3D;”UTF-8”?<br>project xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://maven.apache.org/POM/4.0.0&quot;">http://maven.apache.org/POM/4.0.0&quot;</a> xmlns:xsi&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2001/XMLSchema-instance&quot;">http://www.w3.org/2001/XMLSchema-instance&quot;</a><br>         xsi:schemaLocation&#x3D;”<a target="_blank" rel="noopener" href="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</a> <a target="_blank" rel="noopener" href="http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;">http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</a><br>    modelVersion4.0.0&#x2F;modelVersion</p>
<pre class="line-numbers language-java"><code class="language-java">
parent
    groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token operator">/</span>groupId
    artifactIdsunny<span class="token operator">/</span>artifactId
    version0<span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">-</span>SNAPSHOT<span class="token operator">/</span>version
<span class="token operator">/</span>parent

groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>parent<span class="token operator">/</span>groupId
artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">/</span>artifactId
packagingjar<span class="token operator">/</span>packaging

namesunny<span class="token operator">-</span>starter<span class="token operator">/</span>name
descriptionSunny Parent<span class="token operator">/</span>description

dependencies
    <span class="token operator">!</span><span class="token operator">--</span> core <span class="token operator">--</span>
    dependency
        groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>core<span class="token operator">/</span>groupId
        artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">-</span>core<span class="token operator">/</span>artifactId
        version$<span class="token punctuation">{</span>sunny<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">/</span>version
    <span class="token operator">/</span>dependency
    <span class="token operator">!</span><span class="token operator">--</span> cache <span class="token operator">--</span>
    dependency
        groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>cache<span class="token operator">/</span>groupId
        artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">-</span>cache<span class="token operator">/</span>artifactId
        version$<span class="token punctuation">{</span>sunny<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">/</span>version
    <span class="token operator">/</span>dependency
    <span class="token operator">!</span><span class="token operator">--</span> security <span class="token operator">--</span>
    dependency
        groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>security<span class="token operator">/</span>groupId
        artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">-</span>security<span class="token operator">/</span>artifactId
        version$<span class="token punctuation">{</span>sunny<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">/</span>version
    <span class="token operator">/</span>dependency
    <span class="token operator">!</span><span class="token operator">--</span> admin <span class="token operator">--</span>
    dependency
        groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>admin<span class="token operator">/</span>groupId
        artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">-</span>admin<span class="token operator">/</span>artifactId
        version$<span class="token punctuation">{</span>sunny<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">/</span>version
    <span class="token operator">/</span>dependency
    <span class="token operator">!</span><span class="token operator">--</span> swagger <span class="token operator">--</span>
    dependency
        groupIdcom<span class="token punctuation">.</span>lyyzoo<span class="token punctuation">.</span>swagger<span class="token operator">/</span>groupId
        artifactIdsunny<span class="token operator">-</span>starter<span class="token operator">-</span>swagger<span class="token operator">/</span>artifactId
        version$<span class="token punctuation">{</span>sunny<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">/</span>version
    <span class="token operator">/</span>dependency

<span class="token operator">/</span>dependencies

build
    plugins
        plugin
            groupIdorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">/</span>groupId
            artifactIdspring<span class="token operator">-</span>boot<span class="token operator">-</span>maven<span class="token operator">-</span>plugin<span class="token operator">/</span>artifactId
        <span class="token operator">/</span>plugin
    <span class="token operator">/</span>plugins
<span class="token operator">/</span>build
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x2F;project</p>
<p> </p>
<p>对于一个Spring Boot项目，应该只有一个入口，即 @SpringBootApplication 注解的类。经测试，其它的模块的配置文件application.properties的配置不会生效，应该是引用了入口模块的配置文件。</p>
<p>所以为了让各个模块的配置文件都能生效，只需使用 @PropertySource 引入该配置文件即可，每个模块都如此。在主模块定义的配置会覆盖其它模块的配置。</p>
<img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/10-1532934513.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<h3 id="2、开发规范"><a href="#2、开发规范" class="headerlink" title="2、开发规范"></a>2、开发规范</h3><img class=" aligncenter" title="基于SpringBoot搭建应用开发框架(一) —— 基础架构" src="https://www.javazhiyin.com/wp-content/uploads/2018/07/0-1532934514.png" src="https://www.javazhiyin.com/wp-content/themes/mnews/images/post-loading.gif" alt="基于SpringBoot搭建应用开发框架(一) —— 基础架构">

<p> </p>
<h2 id="十、结语"><a href="#十、结语" class="headerlink" title="十、结语"></a>十、结语</h2><p>到此，基础架构篇结束！学习了很多新东西，如Spring Boot、Mapper、Druid；有些知识也深入地学习了，如MyBatis、Redis、日志框架、Maven等等。</p>
<p>在这期间，看完两本书，可参考：《MyBatis从入门到精通》、《JavaEE开发的颠覆者 Spring Boot实战》，另外，开发规范遵从《阿里巴巴Java开发手册》，其它的参考资料都在文中有体现。</p>
<p> </p>
<p>紧接着，后面会完成 sunny-starter-security 模块的开发，主要使用spring-security技术，开发用户登录及权限控制等。</p>
<p> </p>

                </div>
                <!-- 欧阳思海，modify，2020.05.01-->
<!-- 文章详情详情页面的头部广告位置信息 -->
<div id="post-head-panel">
    
    <a href="https://github.com/OUYANGSIHAI/JavaInterview" style="font-size: 18px;" target="_blank">
        <img src="/icons/hot.gif">
        本人花费半年的时间总结的《Java面试指南》已拿腾讯等大厂offer，已开源在github ，欢迎star！
    </a>
    
    
</div>
<br />



<blockquote>
    
            <p>本文GitHub <a href="https://github.com/OUYANGSIHAI/JavaInterview" target="_blank">https://github.com/OUYANGSIHAI/JavaInterview</a> 已收录，这是我花了6个月总结的<b>一线大厂Java面试</b>总结，本人已拿大厂offer，欢迎star</p>
    
    <p>原文链接：blog.ouyangsihai.cn &gt;&gt; <a href="/ji-yu-springboot-da-jian-ying-yong-kai-fa-kuang-jia-jiao-cheng.html" target="_blank">基于SpringBoot搭建应用开发框架教程</a></p>
</blockquote>
                <hr />

                
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">多少都是对我的认可</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="http://image.ouyangsihai.cn/FpbhsOuf3Ar9vY34B97Y2qQ7LVGe" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="http://image.ouyangsihai.cn/FgYlMzms68PH73PWpZBwPfbLTAws" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
                

                <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

                

                
                <div class="reprint1">
                    <p>
                        <span class="reprint1-tip">
                            <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                        </span>
                        <a href="https://blog.ouyangsihai.cn" class="b-link-green">好好学java</a>
                        <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                        <a href="/ji-yu-springboot-da-jian-ying-yong-kai-fa-kuang-jia-jiao-cheng.html" class="b-link-green">基于SpringBoot搭建应用开发框架教程</a>
                    </p>
                </div>

            </div>
        </div>

        

        

        

        

        
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }
    /* valine 评论框增加背景图片 */
    #vcomments textarea {
        box-sizing: border-box;
        background: url("") 100% 100% no-repeat;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    /* 修复评论第一行位置错位 */
    .v .vlist .vcard {
    padding-top: 2.5em !important ;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="/libs//libs/jQuery-emoji/dist/css/jquery.emoji.css">
<script src="/libs//libs/jQuery-emoji/dist/js/jquery.emoji.min.js"></script>
<script src="/libs//libs/jQuery-emoji/dist/js/emoji.list.js"></script> -->
<script>
    new Valine({
        el: '#vcomments',
        appId: 'MxSNOS83TYWU3Opsy2GTW1ih-gzGzoHsz',
        appKey: '4XevOgmAxHEwVDnIKgvEUihB',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '请畅所欲言吧，别害羞~',

    });

//     function parse_emoji() {
//     jQuery(".vcontent").emojiParse({
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists   // 注：详见 js/emoji.list.js
//     });
//   }
  
//   setTimeout(function() {
//     // jQuery emoji 解析
//     parse_emoji();
//     // jquery emoji 初始化
//     jQuery(".veditor").emoji({
//       showTab: true,
//       animation: 'slide',
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists  // 注：详见 js/emoji.list.js
//     });
//     jQuery(".vmore").on("click", function() {
//       setTimeout(function() {
//         parse_emoji();
//       }, 500);
//     });
//   }, 800)

</script>
        

        

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/niao-kan-wei-fu-wu-jia-gou.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="鸟瞰微服务架构">
                        
                        <span class="card-title">鸟瞰微服务架构</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            





来源：后端技术杂谈
www.rowkey.me/blog/2019/05/30/msa/




www.rowkey.me/blog/2019/05/30/msa/
这几年在Java工程师招聘时，会看到很多人的简历都写着使用了
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock fa-fw icon-date"></i>2021-04-05
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/springcloud%E6%95%99%E7%A8%8B/" class="post-category" target="_blank">
                                    springcloud教程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/springcloud-springcloud%E6%95%99%E7%A8%8B-springcloud%E6%BA%90%E7%A0%81/" target="_blank">
                        <span class="chip bg-color">springcloud,springcloud教程,springcloud源码</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/java-web-xian-dai-hua-kai-fa-spring-boot-mybatis-redis-er-ji-huan-cun-2.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="Java Web现代化开发——Spring Boot + Mybatis + Redis二级缓存">
                        
                        <span class="card-title">Java Web现代化开发——Spring Boot + Mybatis + Redis二级缓存</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            背景Spring-Boot因其提供了各种开箱即用的插件，使得它成为了当今最为主流的Java Web开发框架之一。Mybatis是一个十分轻量好用的ORM框架。Redis是当今十分主流的分布式key-value型数据库，在web开发中，我们常
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock fa-fw icon-date"></i>2021-04-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/springboot%E6%95%99%E7%A8%8B/" class="post-category" target="_blank">
                                    springboot教程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/springboot-springboot%E6%95%99%E7%A8%8B-springboot%E6%BA%90%E7%A0%81/" target="_blank">
                        <span class="chip bg-color">springboot,springboot教程,springboot源码</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
    </div>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('500')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 好好学java<br />'
            + '作者: 好好学java<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>



<!--
<script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script>
<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '15305-1590684104111-518',
        name: '程序员的技术圈子',
        qrcode: 'http://image.ouyangsihai.cn/FtAUOeE5--1JTdcuuZFIhMuEUuJO',
        keyword: 'vip',
    });
</script>
-->

    </div>
    <div id="toc-aside" style="width: 310px;" class="expanded col l3 hide-on-med-and-down">
        <!-- 自定义右侧card：欧阳思海 -->
        <!-- <div id="my-card" style="background: ">
            
        </div> -->
        <!-- <div class="toc-widget">
            <div class="toc-title" style="display: none;"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;</div>
            <div id="toc-content"></div>
        </div> -->








        <aside class="col-lg-3" style="width: 300px;">

            <link rel="stylesheet" type="text/css" href="/css/my-aside.css">

            <!-- 关注公众号信息：欧阳思海 -->
            <div class="widget-wrap">
                <div class="widget bg-danger" style="color:whitesmoke; background-color: #419488">
                    <div class="card-front animated col s12 m12 l8 offset-l2 fadeInUp">
                        <div class="row">
                            <div class="col-md-5" style="text-align: center;">
                                <img class="adv" style="width: 95px; height: 95px;"
                                    src="http://image.ouyangsihai.cn/FtAUOeE5--1JTdcuuZFIhMuEUuJO">
                            </div>
                            <div class="col-md-7" style="text-align: center;">
                                <h2 style="font-size: 18px; 
                                    margin: 0; 
                                    padding: 0;
                                    border: 0; 
                                    outline: 0;
                                    font-weight: inherit;
                                    font-style: inherit;
                                    font-family: inherit;
                                    vertical-align: baseline;">关注公众号</h2>
                                 
                                <small style="font-size: 15px;">
                                    →「技术干货」每日推送 <br>
                                    →「回复资料」领取资料 <br>
                                    →「微信加群」每周福利 <br>
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- <div style="font-size: 0.8em;">
                        <a href="/assets/erweima.jpg" target="_blank"
                            style="color:orange;font-size: 14px;">点击添加我的微信，加入技术讨论群</a>
                        除公众号以外，我还会在以下平台发布内容：
                    </div>
                    -->

                    <div class="profile-block social-links col-md-7" style="text-align: center;">
                        <table style="align-items: center; 
                                        padding-left: 25px;">
                            <tbody>
                                <tr>
                                    <td style="margin: 0;
                                                padding: 0;
                                                border: 0;
                                                outline: 0;
                                                font-weight: inherit;
                                                font-style: inherit;
                                                font-family: inherit;
                                                vertical-align: baseline;"><a
                                            style="color: whitesmoke;font-size: 25px;"
                                            href="https://github.com/OUYANGSIHAI/JavaInterview" target="_blank" title="GitHub"
                                            class="tooltip">
                                            <img style="width: 22px;height: 22px;" src="/icons/github.svg"></a>
                                    </td>

                                    <td style="margin: 0;
                                                padding: 0;
                                                border: 0;
                                                outline: 0;
                                                font-weight: inherit;
                                                font-style: inherit;
                                                font-family: inherit;
                                                vertical-align: baseline;"><a
                                            style="color: whitesmoke;font-size: 25px;"
                                            href="https://www.zhihu.com/people/hai-hai-ren-sheng-50/activities"
                                            target="_blank" title="知乎" class="tooltip">
                                            <img style="width: 22px;" src="/icons/zhihu.svg"></a>
                                    </td>
                                    <td style="margin: 0;
                                                padding: 0;
                                                border: 0;
                                                outline: 0;
                                                font-weight: inherit;
                                                font-style: inherit;
                                                font-family: inherit;
                                                vertical-align: baseline;"><a
                                            style="color: whitesmoke;font-size: 25px;"
                                            href="https://blog.csdn.net/sihai12345" target="_blank" title="CSDN"
                                            class="tooltip">
                                            <img style="width: 18px;" src="/icons/CSDN.svg"></a>
                                    </td>
                                    <td style="margin: 0;
                                                padding: 0;
                                                border: 0;
                                                outline: 0;
                                                font-weight: inherit;
                                                font-style: inherit;
                                                font-family: inherit;
                                                vertical-align: baseline;"><a
                                            style="color: whitesmoke;font-size: 25px;"
                                            href="https://www.jianshu.com/u/12b0bd4c857c" target="_blank" title="简书"
                                            class="tooltip">
                                            <img style="width: 22px;" src="/icons/JianShu.svg"></a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            

            <!-- custom rightside_link：热门文章推荐：欧阳思海 -->
            
            <div class="widget-wrap widget-panel">
                <p style="text-align: left;padding-bottom: 10px;line-height: 30px; font-size: 14px;">
                    
                    <a href="https://github.com/OUYANGSIHAI/JavaInterview" target="_blank">

                        <img src="/icons/hot.gif">

                        本人花费半年的时间总结的《 Java 面试指南》已拿腾讯等大厂 offer，已开源在 github ，欢迎 star！
                    </a><br>
                    
                    <a href="https://mp.weixin.qq.com/s/I0jimqziHqRNaIy0kXRCnw" target="_blank">

                        <img src="/icons/hot.gif">

                        2020 Java 1000G 最新学习资源，Java基础、Java项目实战、Java分布式等等！
                    </a><br>
                    
                    <a href="http://image.ouyangsihai.cn/FpB-dO6g-XU44mMrVlj7EL1y7Rs7" target="_blank">

                        <img src="/icons/hot.gif">

                        高级 Java 开发微信群，一起搞事情吧！
                    </a><br>
                    
                </p>
            </div>
            

            

            <!-- custom rightside_banner：右侧广告或者其他的栏目设置：欧阳思海 -->
            
            <div class="widget-wrap">
                <a href="https://github.com/OUYANGSIHAI/JavaInterview" target="_blank">
                    <img src="http://image.ouyangsihai.cn/FhhoEYMaNr6m0v8KhG8vSPgoREBV" style="width: 100%;">
                </a>
            </div>
            
            

            

            <!-- 右侧专栏分类：欧阳思海 -->
            
            <div class="widget-wrap widget-panel">
                <ul class="media-list">
                    
                    <li class="media">
                        <a href="/categories/MySQL的艺术世界/" target="_blank">
                            <div class="media-left">
                                <img class="media-object" src="http://image.ouyangsihai.cn/Fn3kQurieQ_0QUeqPmx5RW5i6R9n" style="width: 55px;">
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading" style="margin-bottom: 10px; font-size: 100%;
                                                                    margin: 0;
                                                                    padding: 0;
                                                                    border: 0;
                                                                    outline: 0;
                                                                    font-weight: inherit;
                                                                    font-style: inherit;
                                                                    font-family: inherit;
                                                                    vertical-align: baseline;">
                                    MySQL 的系列文章，解决全部面试问题！
                                </h4>
                                <p>
                                    总共10篇文章，面试热门的锁、事务，通通解决了！
                                </p>
                            </div>
                        </a>
                    </li>
                    <hr>
                    
                    <li class="media">
                        <a href="/categories/深入理解Java虚拟机/" target="_blank">
                            <div class="media-left">
                                <img class="media-object" src="http://image.ouyangsihai.cn/FpcS21VWJOHSgGzKcpW3_xVTSEeN" style="width: 55px;">
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading" style="margin-bottom: 10px; font-size: 100%;
                                                                    margin: 0;
                                                                    padding: 0;
                                                                    border: 0;
                                                                    outline: 0;
                                                                    font-weight: inherit;
                                                                    font-style: inherit;
                                                                    font-family: inherit;
                                                                    vertical-align: baseline;">
                                    深入理解 Java 虚拟机，面试必问
                                </h4>
                                <p>
                                    总共10篇文章，包括内存模型、GC算法、GC收集器等。
                                </p>
                            </div>
                        </a>
                    </li>
                    <hr>
                    
                </ul>
            </div>
            

            <!-- 右侧分类 -->
            <div class="widget-wrap widget-panel">
                <h3 class="widget-title">文章分类</h3>
                <div class="widget">
                    <ul class="category-list">
                        
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/趣聊数据结构与算法/">>
                                趣聊数据结构与算法</a><span class="category-list-count">6</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/职业生涯浅谈/">>
                                职业生涯浅谈</a><span class="category-list-count">33</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java项目分享/">>
                                Java项目分享</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java面试经验/">>
                                Java面试经验</a><span class="category-list-count">4</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/我要进大厂/">>
                                我要进大厂</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/好好学java/">>
                                好好学java</a><span class="category-list-count">1116</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/剑指offer/">>
                                剑指offer</a><span class="category-list-count">112</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/css/">>
                                css</a><span class="category-list-count">12</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/其他框架/">>
                                其他框架</a><span class="category-list-count">142</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/python其他/">>
                                python其他</a><span class="category-list-count">45</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/数据库相关/">>
                                数据库相关</a><span class="category-list-count">293</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java核心知识/">>
                                Java核心知识</a><span class="category-list-count">196</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java面试题/">>
                                Java面试题</a><span class="category-list-count">308</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/mybatis源码/">>
                                mybatis源码</a><span class="category-list-count">56</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/spring教程/">>
                                spring教程</a><span class="category-list-count">173</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/springboot教程/">>
                                springboot教程</a><span class="category-list-count">156</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/实战Activiti工作流/">>
                                实战Activiti工作流</a><span class="category-list-count">4</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/springcloud教程/">>
                                springcloud教程</a><span class="category-list-count">39</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/linux/">>
                                linux</a><span class="category-list-count">91</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/python框架/">>
                                python框架</a><span class="category-list-count">43</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/python基础/">>
                                python基础</a><span class="category-list-count">78</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/dubbo/">>
                                dubbo</a><span class="category-list-count">37</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java源码/">>
                                Java源码</a><span class="category-list-count">76</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/叽叽喳喳杂七杂八/">>
                                叽叽喳喳杂七杂八</a><span class="category-list-count">10</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/MySQL的艺术世界/">>
                                MySQL的艺术世界</a><span class="category-list-count">8</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/jquery/">>
                                jquery</a><span class="category-list-count">14</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java并发/">>
                                Java并发</a><span class="category-list-count">43</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java文章合辑/">>
                                Java文章合辑</a><span class="category-list-count">11</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java基础修炼/">>
                                Java基础修炼</a><span class="category-list-count">7</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/不一样的Java8/">>
                                不一样的Java8</a><span class="category-list-count">3</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/小程序开发的世界/">>
                                小程序开发的世界</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java学习资源分享/">>
                                Java学习资源分享</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java小学生漫游/">>
                                Java小学生漫游</a><span class="category-list-count">2</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/rocketmq源码解析/">>
                                rocketmq源码解析</a><span class="category-list-count">33</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/springmvc最新教程/">>
                                springmvc最新教程</a><span class="category-list-count">9</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java的Exception/">>
                                Java的Exception</a><span class="category-list-count">6</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/vue-js/">>
                                vue.js</a><span class="category-list-count">10</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/实战设计模式/">>
                                实战设计模式</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/python数据处理/">>
                                python数据处理</a><span class="category-list-count">7</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java-Web闯关/">>
                                Java Web闯关</a><span class="category-list-count">7</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/springboot2-0最新教程/">>
                                springboot2.0最新教程</a><span class="category-list-count">11</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/netty/">>
                                netty</a><span class="category-list-count">16</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/rpc/">>
                                rpc</a><span class="category-list-count">13</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/拥抱大厂系列/">>
                                拥抱大厂系列</a><span class="category-list-count">6</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/eureka/">>
                                eureka</a><span class="category-list-count">19</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/分布式/">>
                                分布式</a><span class="category-list-count">6</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/中间件/">>
                                中间件</a><span class="category-list-count">23</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java基础/">>
                                Java基础</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/带你学Python/">>
                                带你学Python</a><span class="category-list-count">10</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/使用技术工具/">>
                                使用技术工具</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/mycat源码/">>
                                mycat源码</a><span class="category-list-count">5</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/深入理解Java虚拟机/">>
                                深入理解Java虚拟机</a><span class="category-list-count">8</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/spring源码/">>
                                spring源码</a><span class="category-list-count">2</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java集合源码分析/">>
                                Java集合源码分析</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/github的repo/">>
                                github的repo</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/Java框架深究/">>
                                Java框架深究</a><span class="category-list-count">1</span>
                        </li>
                        
                        <li class="category-list-item"><a class="category-list-link" href="categories/分布式架构/">>
                                分布式架构</a><span class="category-list-count">2</span>
                        </li>
                        
                        
                    </ul>
                </div>
            </div>

        </aside>









    </div>
</div>

<!-- TOC 悬浮按钮. 修改成永远不显示：欧阳思海-->




<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4, h5'
        });

        console.log('============');

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

                        
            /* 修复文章卡片 div 的宽度. */
            let fixPostCardWidth = function (srcId, targetId) {
                let srcDiv = $('#' + srcId);
                if (srcDiv.length === 0) {
                    return;
                }

                let w = srcDiv.width();
                if (w >= 450) {
                    w = w + 21;
                } else if (w >= 350 && w < 450) {
                    w = w + 18;
                } else if (w >= 300 && w < 350) {
                    w = w + 16;
                } else {
                    w = w + 14;
                }
                $('#' + targetId).width(w);
            };

            // 切换TOC目录展开收缩的相关操作.
            // 修改右侧边栏功能：欧阳思海
            const expandedClass = 'expanded';
            let $tocAside = $('#toc-aside');
            let $mainContent = $('#main-content');

            $('#floating-toc-btn .btn-floating').click(function () {
                if ($tocAside.hasClass(expandedClass)) {
                    $tocAside.removeClass(expandedClass).slideUp(500);
                    $mainContent.removeClass('l9');
                } else {
                    $tocAside.addClass(expandedClass).slideDown(500);
                    $mainContent.addClass('l9');
                }
                fixPostCardWidth('artDetail', 'prenext-posts');
            });
                        
                    });
</script>
    

</main>


        <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            
	    Copyright&copy; 2019 <a href="https://www.java1000.com/" target="_blank"> 好好学java </a>维护. 网站备案/许可证号：赣ICP备17007984号-3
            <br>
            <span id="sitetime"></span>
            <br>

            

            
                    <!-- 
                        <span id="busuanzi_container_site_pv" style='display:none'></span>
                        总访问量: <span id="busuanzi_value_site_pv" class="white-color"></span>
                    
        
                    
                        <span id="busuanzi_container_site_uv" style='display:none'></span>
                        人次&nbsp; | &nbsp;访客人数: <span id="busuanzi_value_site_uv" class="white-color"></span> 人
                     -->
                        <!-- 修改计数：欧阳思海 -->
                    
                        <span id="busuanzi_container_site_pv" style='display:inline'>
                            <i class="fa fa-heart-o"></i>
                            本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                        </span>
                    
                    
                        <span id="busuanzi_container_site_uv" style='display:none'>
                            人次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                        </span>
                    
    
            

            
                &nbsp; | &nbsp;字数统计:&nbsp;
                <span class="white-color">8290.3k</span> 字
            

            
            <br>

        </div>

        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/OUYANGSIHAI/JavaInterview" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-code-branch"></i>
    </a>


 
    <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=1446037005@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>




    <a href="https://zhihu.com/people/hai-hai-ren-sheng-50/activities" class="tooltipped" target="_blank" data-tooltip="访问我的知乎" data-position="top" data-delay="50">
        <i class="fa fa-inverse">知</i>
    </a>









    <a href="https://blog.ouyangsihai.cn/sitemap.xml" class="tooltipped" target="_blank" data-tooltip="站点地图" data-position="top" data-delay="50">
        <i class="fa fa-sitemap"></i>
    </a>



    <a href="https://blog.ouyangsihai.cn/friends" class="tooltipped" target="_blank" data-tooltip="友情链接" data-position="top" data-delay="50">
        <i class="fa fa-address-book"></i>
    </a>
</div>

    </div>
</footer>

<div class="progress-bar"></div>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();

        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */

        var t1 = Date.UTC(2019, 08, 10, 00, 00, 00); //北京时间2019-8-1 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes *
            minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours +
            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒" ;
    } /*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

<!-- 修改计数：欧阳思海 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);  // 50ms周期检测函数
        var pvcountOffset = 1005469;  // 初始化首次数据
        var uvcountOffset = 250804;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int); // 停止检测
            }
        }
    });
</script>




        <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    console.log("lets go！");
    console.log("/");
    searchFunc("/" + "search.json", 'searchInput', 'searchResult');
});
</script>
        <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


        <script src="/libs/materialize/materialize.min.js"></script>
        <script src="/libs/masonry/masonry.pkgd.min.js"></script>
        <script src="/libs/aos/aos.js"></script>
        <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
        <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
        <script src="/js/matery.js"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149362573-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-149362573-1');
</script>



        
            <script src="/libs/others/clicklove.js"></script>
        

        
            <script async src="/libs/others/busuanzi.pure.mini.js"></script>
        

        <!-- 洪卫 shw2018 add 2019.08.28 -->
        <script type="text/javascript">
            var OriginTitile = document.title,
                st;
            document.addEventListener("visibilitychange", function () {
                document.hidden ? (document.title = "看不见我🙈~看不见我🙈~", clearTimeout(st)) : (document.title =
                    "(๑•̀ㅂ•́) ✧被发现了～", st = setTimeout(function () {
                        document.title = OriginTitile
                    }, 3e3))
            })
        </script>

        <!-- 鼠标点击烟花爆炸效果  洪卫 shw2018 add 2019.09.09 -->
        

        <!-- 背景雪花飘落特效洪卫 shw2018 add 2019.09.10 -->
        

        <!-- 鼠标点击文字特效 洪卫 shw2018 add 2019.09.10-->
        

        <!-- 背景雪花飘落特效 洪卫 shw2018 add 2019.09.10 -->
        

        <!-- 在线聊天工具  洪卫 shw2018 add 2019.09.11 -->
        

        <!-- 背景 canvas-nest  洪卫 shw 2018  add 2019.09.15-->
        

        <!-- 背景静止彩带  洪卫 shw 2018  add 2019.09.15-->
        

        <!-- 背景动态彩带 洪卫 shw 2018  add 2019.09.15-->
        

    </body>
</html>